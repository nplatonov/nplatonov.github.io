<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Платонов</title>
    <meta charset="utf-8" />
    <script src="https://nplatonov.github.io/site_libs/header-attrs-2.26/header-attrs.js"></script>
    <link href="https://nplatonov.github.io/site_libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="https://nplatonov.github.io/site_libs/remark-css-0.0.1/hygge.css" rel="stylesheet" />
    <link href="https://nplatonov.github.io/site_libs/tile-view-0.2.6/tile-view.css" rel="stylesheet" />
    <script src="https://nplatonov.github.io/site_libs/tile-view-0.2.6/tile-view.js"></script>
    <link href="https://nplatonov.github.io/site_libs/animate.css-3.7.2/animate.xaringan.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://nplatonov.github.io/site_libs/common.css" type="text/css" />
    <link rel="stylesheet" href="https://nplatonov.github.io/site_libs/moon_reader.css" type="text/css" />
    <link rel="stylesheet" href="https://nplatonov.github.io/site_libs/moon_reader-fonts.css" type="text/css" />
    <link rel="stylesheet" href="assets/universe.css" type="text/css" />
  </head>
  <body>
<style>
.remark-backdrop:after{
   content: 'Никита Платонов \A \A Платонов';
}
:root {--pointsize: 22pt;}
</style>

    <textarea id="source">

layout: true







.banner[


.sevinlogo[
]

.shorttitle[

]

]

---
class: metadata customtitle middle left
name: H32169
<iframe width='220' height='220' class='timenow' src='https://www.timeanddate.com/worldclock/fullscreen.html?n=1440' frameborder='0' allow='encrypted-media' allowfullscreen></iframe>

.sidebar.left-column[
# [Среда обитания](#H09c93)
# [Причина перемещений](#H896bd)
# [Инструментарий](#H500de)
]
.mainbar.right-column[





.author[Никита&nbsp;Платонов]


.institute[ИПЭЭ РАН]




.title[Экология перемещений белого медведя]


.subtitle[]


.what[]


.where[]


.when[ .updated[Обновлено: 2024-03-18 13:26]]















]
---

name: H09c93

.sidebar.left-column[
# [Среда обитания](#H09c93).fg[]
## [Лёд](#H09c93).fg[]
### [Ходит](#H09c93).fg[].bg[]
### [Охотится](#H2d9dd)
### [Отдыхает](#H3de19)
### [Тяготеет к кромке](#H6ca39)
## [Вода](#H00469)
## [Снег](#H39f2f)
## [Суша](#Hfa3ee)
# [Причина перемещений](#H896bd)
# [Инструментарий](#H500de)
]
.mainbar.right-column[


<img src="assets/walking.png" width="500" height="390" bound style="display: block; margin: auto;" />

В очень коротком промежутке времени скорость может составлять 40 км/ч.

В долгосрочном периоде скорость 1-2 км/ч, причем самцы передвигаются медленнее одиночных самок и самок с детенышами <a name=cite-Amstrup2001_comparing></a>([Amstrup et al., 2001](#bib)).


]
---

name: H2d9dd

.sidebar.left-column[
# [Среда обитания](#H09c93).fg[]
## [Лёд](#H09c93).fg[]
### [Ходит](#H09c93)
### [Охотится](#H2d9dd).fg[].bg[]
### [Отдыхает](#H3de19)
### [Тяготеет к кромке](#H6ca39)
## [Вода](#H00469)
## [Снег](#H39f2f)
## [Суша](#Hfa3ee)
# [Причина перемещений](#H896bd)
# [Инструментарий](#H500de)
]
.mainbar.right-column[




<img src="assets/hunting2.jpg" width="500" height="535" bound style="display: block; margin: auto;" />

Основный вид жертвы – тюлени.


]
---

name: H3de19

.sidebar.left-column[
# [Среда обитания](#H09c93).fg[]
## [Лёд](#H09c93).fg[]
### [Ходит](#H09c93)
### [Охотится](#H2d9dd)
### [Отдыхает](#H3de19).fg[].bg[]
### [Тяготеет к кромке](#H6ca39)
## [Вода](#H00469)
## [Снег](#H39f2f)
## [Суша](#Hfa3ee)
# [Причина перемещений](#H896bd)
# [Инструментарий](#H500de)
]
.mainbar.right-column[




<img src="https://0da7576c6af8dc90a8d9-cca51b9f97dde420bbbf39cd61d520a5.ssl.cf1.rackcdn.com/polar-bear-resting-sea-edge.jpg" width="500" height="568" bound style="display: block; margin: auto;" />


]
---

name: H6ca39

.sidebar.left-column[
# [Среда обитания](#H09c93).fg[]
## [Лёд](#H09c93).fg[]
### [Ходит](#H09c93)
### [Охотится](#H2d9dd)
### [Отдыхает](#H3de19)
### [Тяготеет к кромке](#H6ca39).fg[].bg[]
## [Вода](#H00469)
## [Снег](#H39f2f)
## [Суша](#Hfa3ee)
# [Причина перемещений](#H896bd)
# [Инструментарий](#H500de)
]
.mainbar.right-column[




<img src="assets/ecosystemOverview.jpg" width="500" height="460" bound style="display: block; margin: auto;" />

Доступность солнечного света

Распространение причинно-следственной связи по пищевой цепочке





]
---

name: H00469

.sidebar.left-column[
# [Среда обитания](#H09c93).fg[]
## [Лёд](#H09c93)
## [Вода](#H00469).fg[]
### [Плавает](#H00469).fg[].bg[]
## [Снег](#H39f2f)
## [Суша](#Hfa3ee)
# [Причина перемещений](#H896bd)
# [Инструментарий](#H500de)
]
.mainbar.right-column[


<img src="assets/swimming1.jpg" width="500" height="300" class='bound' style="display: block; margin: auto;" />

Скорость порядка 10 км/ч.

Сеголетки умеют плавать.

«Заплывы» на 100 км обычны <a name=cite-Rozhnov2017_hutuda_ru></a>([Рожнов и др., 2017](#bib)), <a name=cite-Platonov2019_Vaigach2016></a>([Платонов и др., 2019](#bib)).

В Книге рекордов Гиннеса [зафиксирован](https://www.guinnessworldrecords.com/world-records/511347-longest-polar-bear-swim-%E2%80%93-distance) заплыв на 687 км <a name=cite-Swimming687km></a>([Durner et al., 2011](#bib)) c потерей 22 % массы тела за 9 суток плавания и 54 суток ходьбы.




]
---

name: H39f2f

.sidebar.left-column[
# [Среда обитания](#H09c93).fg[]
## [Лёд](#H09c93)
## [Вода](#H00469)
## [Снег](#H39f2f).fg[]
### [Ходит](#H39f2f).fg[].bg[]
### [Залегает в берлоги](#H66690)
## [Суша](#Hfa3ee)
# [Причина перемещений](#H896bd)
# [Инструментарий](#H500de)
]
.mainbar.right-column[


<img src="assets/steps.jpg" width="500" height="320" class='bound' style="display: block; margin: auto;" />

Оставляет следы

+ оценка полового состава ввиду сильного полового диморфизма

+ размер выводка

+ тропление при отловах

+ выявление превалирующего направления перемещений


]
---

name: H66690

.sidebar.left-column[
# [Среда обитания](#H09c93).fg[]
## [Лёд](#H09c93)
## [Вода](#H00469)
## [Снег](#H39f2f).fg[]
### [Ходит](#H39f2f)
### [Залегает в берлоги](#H66690).fg[].bg[]
## [Суша](#Hfa3ee)
# [Причина перемещений](#H896bd)
# [Инструментарий](#H500de)
]
.mainbar.right-column[




<img src="assets/maternal4.jpg" width="500" height="490" class='bound' style="display: block; margin: auto;" />

+ Родовые берлоги с октября-ноября по март-апрель

+ Как на суше, так и во льдах <a name=cite-Rode2018-denPhenology></a>([Rode et al., 2018](#bib))


]
---

name: Hfa3ee

.sidebar.left-column[
# [Среда обитания](#H09c93).fg[]
## [Лёд](#H09c93)
## [Вода](#H00469)
## [Снег](#H39f2f)
## [Суша](#Hfa3ee).fg[].bg[]
# [Причина перемещений](#H896bd)
# [Инструментарий](#H500de)
]
.mainbar.right-column[


.pulling[
.pull-left-70[
<img src="assets/terrestrial.png" width="500" height="340" class='bound' style="display: block; margin: auto;" />
]
.pull-right-30[
.caption.bottom[
Рисунок из работы <a name=cite-Rozhnov2014_FJL2011></a>([Рожнов и др., 2014](#bib))
]
]
]

Родовые берлоги на суше: крутизна и экспозиция склонов, снегонакопление

Альтернатива проведения безледового сезона: меньшие энергозатраты 

Антропогенные источники пищи ([Рожнов и др., 2014](#bib)), ([Платонов и др., 2019](#bib))





]
---

name: H896bd

.sidebar.left-column[
# [Среда обитания](#H09c93)
# [Причина перемещений](#H896bd).fg[]
## [Транспортная платформа](#H896bd).fg[].bg[]
## [Смещение местообитаний](#H83682)
## [Дрейф льда](#H93c88)
# [Инструментарий](#H500de)
]
.mainbar.right-column[


+ Поиск объектов питания

+ Поиск пары

+ Защита потомства




]
---

name: H83682

.sidebar.left-column[
# [Среда обитания](#H09c93)
# [Причина перемещений](#H896bd).fg[]
## [Транспортная платформа](#H896bd)
## [Смещение местообитаний](#H83682).fg[]
### [Климатические изменения ледовитости](#H83682).fg[].bg[]
### [Сезонные изменения ледовитости](#Ha5735)
## [Дрейф льда](#H93c88)
# [Инструментарий](#H500de)
]
.mainbar.right-column[


.pulling[
.pull-left-70[
<img src="assets/summerMinimum.png" width="500" height="400" bound style="display: block; margin: auto;" />
]
.pull-right-30[
.caption[
Летний минимум без Гренландского моря <a name=cite-Durner2009></a>([Durner et al., 2009](#bib)).
]
]
]

Линейный тренд (1979-2023) -72±6×10<sup>3</sup> км<sup>2</sup>/год

Сегментация <a name=cite-segmented-article2003></a>([Muggeo, 2003](#bib)).

Точки разрыва ~2004 и 2007 гг.

Линейный тренд (2007-2023) -11±6×10<sup>3</sup> км<sup>2</sup>/год


]
---

name: Ha5735

.sidebar.left-column[
# [Среда обитания](#H09c93)
# [Причина перемещений](#H896bd).fg[]
## [Транспортная платформа](#H896bd)
## [Смещение местообитаний](#H83682).fg[]
### [Климатические изменения ледовитости](#H83682)
### [Сезонные изменения ледовитости](#Ha5735) <span class="bullet bullet-active">[&#8226;](#Ha5735)</span><span class="bullet mslide26m">[&#8226;](#H0bcd8)</span>.fg[].bg[]
## [Дрейф льда](#H93c88)
# [Инструментарий](#H500de)
]
.mainbar.right-column[




.columns[
.pull-left-65[

<img src="https://nsidc.org/data/seaice_index/images/daily_images/N_iqr_timeseries.png" width="500" height="400" bound style="display: block; margin: auto;" />

]
.pull-right-35[
.caption[
Протяженность ледяного покрова Арктики
]

<br><br>
<br>
<br>

«Вертикальная» и «горизонтальная» проекция изменений

]
]

+ Вертикальная: на фиксированную дату больше или меньше льда?

+ Горизонтальная: для фиксированной площади более ранее/позднее таяние/образование льда?


]
---

name: H0bcd8

.sidebar.left-column[
# [Среда обитания](#H09c93)
# [Причина перемещений](#H896bd).fg[]
## [Транспортная платформа](#H896bd)
## [Смещение местообитаний](#H83682).fg[]
### [Климатические изменения ледовитости](#H83682)
### [Сезонные изменения ледовитости](#Ha5735) <span class="bullet bullet">[&#8226;](#Ha5735)</span><span class="bullet bullet-active">[&#8226;](#H0bcd8)</span>.fg[].bg[]
## [Дрейф льда](#H93c88)
# [Инструментарий](#H500de)
]
.mainbar.right-column[


<img src="assets/hutuda1.png" width="500" height="490" class='bound' style="display: block; margin: auto;" />

.caption[
Перемещение самки белого медведя ([Рожнов и др., 2017](#bib)), наложенное на фенологическую карту вскрытия ледяного покрова. Цветовая легенда единая для участков траектории и для фенокарты.
]


]
---

name: H93c88

.sidebar.left-column[
# [Среда обитания](#H09c93)
# [Причина перемещений](#H896bd).fg[]
## [Транспортная платформа](#H896bd)
## [Смещение местообитаний](#H83682)
## [Дрейф льда](#H93c88) <span class="bullet bullet-active">[&#8226;](#H93c88)</span><span class="bullet mslide28m">[&#8226;](#Hec75a)</span><span class="bullet mslide29m">[&#8226;](#H9b729)</span>.fg[].bg[]
# [Инструментарий](#H500de)
]
.mainbar.right-column[


<img src="assets/drift2013absolute.png" width="500" height="535" class='bound' style="display: block; margin: auto;" />

.caption[
Рисунок из работы <a name=cite-Platonov2014_drift_ru></a>([Платонов и др., 2014](#bib)).
]


]
---

name: Hec75a

.sidebar.left-column[
# [Среда обитания](#H09c93)
# [Причина перемещений](#H896bd).fg[]
## [Транспортная платформа](#H896bd)
## [Смещение местообитаний](#H83682)
## [Дрейф льда](#H93c88) <span class="bullet bullet">[&#8226;](#H93c88)</span><span class="bullet bullet-active">[&#8226;](#Hec75a)</span><span class="bullet mslide29m">[&#8226;](#H9b729)</span>.fg[].bg[]
# [Инструментарий](#H500de)
]
.mainbar.right-column[


<img src="assets/drift.gif" width="500" height="580" bound style="display: block; margin: auto;" />

]
---

name: H9b729

.sidebar.left-column[
# [Среда обитания](#H09c93)
# [Причина перемещений](#H896bd).fg[]
## [Транспортная платформа](#H896bd)
## [Смещение местообитаний](#H83682)
## [Дрейф льда](#H93c88) <span class="bullet bullet">[&#8226;](#H93c88)</span><span class="bullet bullet">[&#8226;](#Hec75a)</span><span class="bullet bullet-active">[&#8226;](#H9b729)</span>.fg[].bg[]
# [Инструментарий](#H500de)
]
.mainbar.right-column[


<img src="assets/drift2013relative.png" width="500" height="535" class='bound' style="display: block; margin: auto;" />

.caption[
Рисунок из работы ([Платонов и др., 2014](#bib)).
]






]
---

name: H500de

.sidebar.left-column[
# [Среда обитания](#H09c93)
# [Причина перемещений](#H896bd)
# [Инструментарий](#H500de).fg[]
## [Данные и методы](#H500de).fg[].bg[]
## [Характеристики](#H19e94)
## [Применение](#Hfc6c2)
]
.mainbar.right-column[


.notdouble[

 ### Спутниковая телеметрия

Argos. Передатчики «Эс-Пас». Трафик CLS.

 ### Фильтрация

Построение локаций поставщиком данных:

+ наименьших квадратов

+ фильтр Калмана

Argos-фильтры <a name=cite-Argos-filter></a>([Freitas et al., 2008](#bib)), <a name=cite-Douglas2012_ArgosFilter></a>([Douglas et al., 2012](#bib)) для исключения локаций, вызываюших «шипы» траектории.

 ### Построение траектории

Метод коррелированного случайного блуждания <a name=cite-Jonsen2020-CRW></a>([Jonsen et al., 2020](#bib)).

]


]
---

name: H19e94

.sidebar.left-column[
# [Среда обитания](#H09c93)
# [Причина перемещений](#H896bd)
# [Инструментарий](#H500de).fg[]
## [Данные и методы](#H500de)
## [Характеристики](#H19e94).fg[].bg[]
## [Применение](#Hfc6c2)
]
.mainbar.right-column[


.notdouble[

 ### Периоды активности

Скорость движения (среднесуточное смещение), прямолинейность траектории

+ Целенаправленное перемещение

+ Успешная охота и отдых

   
 ### Участки обитания

Оценка площади

+ Минимальным выпуклым многоугольником

+ Методом кёрнел

]




]
---

name: Hfc6c2

.sidebar.left-column[
# [Среда обитания](#H09c93)
# [Причина перемещений](#H896bd)
# [Инструментарий](#H500de).fg[]
## [Данные и методы](#H500de)
## [Характеристики](#H19e94)
## [Применение](#Hfc6c2).fg[]
### [Функция выбора ресурсов](#Hfc6c2).fg[].bg[]
### [Функция выбора шага](#Habb1a)
### [Пелагический и прибрежный экотипы](#H4a119)
### [Выделение обособленных группировок](#H26c0d)
]
.mainbar.right-column[


.font90[
Логистическая регрессия `\(w(X)=exp(\beta_{1}x_{1}+\beta_{2}x_{2}+\beta_{3}x_{3}+...)\)`
]


.columns[
.pull-left-65[

<img src="assets/methodRSF.jpg" width="500" height="400" bound style="display: block; margin: auto;" />

]
.pull-right-35[

.caption[
Рисунок из работы ([Durner et al., 2009](#bib)).
]

]
]

Resource Selection Function (RSF)

+ Доступно

+ Использовано


]
---

name: Habb1a

.sidebar.left-column[
# [Среда обитания](#H09c93)
# [Причина перемещений](#H896bd)
# [Инструментарий](#H500de).fg[]
## [Данные и методы](#H500de)
## [Характеристики](#H19e94)
## [Применение](#Hfc6c2).fg[]
### [Функция выбора ресурсов](#Hfc6c2)
### [Функция выбора шага](#Habb1a).fg[].bg[]
### [Пелагический и прибрежный экотипы](#H4a119)
### [Выделение обособленных группировок](#H26c0d)
]
.mainbar.right-column[


.columns[
.pull-left-50[

<img src="assets/SSF.png" width="500" height="568" bound style="display: block; margin: auto;" />

]
.pull-right-50[

Step selection function (SSF) <a name=cite-Wilson2022></a>([Wilson et al., 2022](#bib)).

Условия окружающей среды при выбранном шаге в сравнении с возможными шагами.

+ Размер шага (*гамма*)

+ Направление шага (*вон Мизеса*)

<img src="assets/SSF_description.jpg" width="500" height="150" style="display: block; margin: auto;" />

]
]


]
---

name: H4a119

.sidebar.left-column[
# [Среда обитания](#H09c93)
# [Причина перемещений](#H896bd)
# [Инструментарий](#H500de).fg[]
## [Данные и методы](#H500de)
## [Характеристики](#H19e94)
## [Применение](#Hfc6c2).fg[]
### [Функция выбора ресурсов](#Hfc6c2)
### [Функция выбора шага](#Habb1a)
### [Пелагический и прибрежный экотипы](#H4a119).fg[].bg[]
### [Выделение обособленных группировок](#H26c0d)
]
.mainbar.right-column[



.columns[
.pull-left-70[

<img src="assets/Blanchet2020.jpg" width="500" height="400" bound style="display: block; margin: auto;" />

]
.pull-right-30[

<img src="assets/Blanchet2020-speed.png" width="500" height="400" bound style="display: block; margin: auto;" />

]
]

.caption[
Рисунки из работы <a name=cite-Blanchet2020></a>([Blanchet et al., 2020](#bib)).
]

Выбор различных стратегий использование ресурсов среды.


]
---

name: H26c0d

.sidebar.left-column[
# [Среда обитания](#H09c93)
# [Причина перемещений](#H896bd)
# [Инструментарий](#H500de).fg[]
## [Данные и методы](#H500de)
## [Характеристики](#H19e94)
## [Применение](#Hfc6c2).fg[]
### [Функция выбора ресурсов](#Hfc6c2)
### [Функция выбора шага](#Habb1a)
### [Пелагический и прибрежный экотипы](#H4a119)
### [Выделение обособленных группировок](#H26c0d).fg[].bg[]
]
.mainbar.right-column[


.columns[
.pull-left-45[

<img src="assets/SEG-subpopulation.jpg" width="500" height="500" style="display: block; margin: auto;" />

]
.pull-right-55[

<img src="assets/Mauritzen2002.jpg" width="500" height="345" style="display: block; margin: auto;" />









.caption[
Рисунки из работ <a name=cite-Laidre2022-subpopulation></a>([Laidre et al., 2022](#bib)), <a name=cite-Mauritzen2002></a>([Mauritzen et al., 2002](#bib)).
]

]
]




]
---
name: acknowledgements

.sidebar.left-column[
# [Среда обитания](#H09c93)
# [Причина перемещений](#H896bd)
# [Инструментарий](#H500de)
]
.mainbar.right-column[





.font70.columns[

.column[

 ## Исполнители
 
Постоянно действующая экспедиция РАН по изучению животных Красной книги Российской Федерации и других особо важных животных фауны России

Программа изучения белого медведя в Российской Арктике
 
В. Рожнов, С. Найденко, И. Мордвинцев, Е. Иванов, Н. Платонов

 ## Благодарности
 
+ Русское географическое общество

+ ПАО «НК «Роснефть»

+ Национальный парк «Русская Арктика»


]
.column[

 ## Соблюдение этических стандартов

Все манипуляции с белыми медведями выполнены в соответствии с протоколом № 37 от 25 мая 2020 г. Комитета по этике ИПЭЭ РАН.

 ## Заимствованные изображения
 
+ [Photographing Polar Bears with Amos Nachoum](https://www.divephotoguide.com/underwater-photography-special-features/article/photographing-polar-bears-amos-nachoum)

+ [National Snow and Ice Data Center](https://nsidc.org)

+ [Wallpaper Abyss](https://wall.alphacoders.com/big.php?i=914572)

+ [LEViiMAGES](https://www.leviimages.com/Destinations/Manitoba/21/thumbs)

+ [ARCTIC PORTAL.org](https://arcticportal.org/ap-library/news/402-specialists-meet-to-discuss-the-effects-of-sea-ice-loss-on-biodiversity-in-the-arctic)

+ <a name=cite-Michelot2023></a>([Michelot et al., 2023](#bib)), <a name=cite-Barber2009></a>([Barber et al., 2009](#bib))

+ Постоянно действующая экспедиция РАН


]
]

.footer.onlyremark[
Платонов Н. Г., Кабинет методов ДЗЗ и тематического дешифрирования ИПЭЭ РАН. platonov@sevin.ru
]


]
---
name: bib
layout: false
DOI: [10.14430/arctic98](https://doi.org/10.14430%2Farctic98).

.sidebar.left-column[
# [Среда обитания](#H09c93)
# [Причина перемещений](#H896bd)
# [Инструментарий](#H500de)
]
.mainbar.right-column[








.footnote.small.bibliography[
****

<a name=bib-Amstrup2001_comparing></a>[Amstrup, S. C., G. Durner, T.
McDonald, D. Mulcahy, and G. Garner](#cite-Amstrup2001_comparing)
(2001). "Comparing movement patterns of satellite-tagged male and
female polar bears". In: _Canadian Journal of Zoology_ 79.12, pp.
2147-2158. DOI:
[10.1139/cjz-79-12-2147](https://doi.org/10.1139%2Fcjz-79-12-2147).
URL:
[http://pubs.er.usgs.gov/publication/70023089](http://pubs.er.usgs.gov/publication/70023089)
(visited on Jan. 04, 2018).

<a name=bib-Barber2009></a>[Barber, D. G., J. V. Lukovich, J. Keogak,
S. Baryluk, L. Fortier, and G. Henry](#cite-Barber2009) (2009). "The
Changing Climate of the Arctic". In: _ARCTIC_ 61.5. ISSN: 0004-0843.


<a name=bib-Blanchet2020></a>[Blanchet, M., J. Aars, M. Andersen, and
H. Routti](#cite-Blanchet2020) (2020). "Space-use strategy affects
energy requirements in Barents Sea polar bears". In: _Marine Ecology
Progress Series_ 639, pp. 1-19. DOI:
[10.3354/meps13290](https://doi.org/10.3354%2Fmeps13290).

<a name=bib-Douglas2012_ArgosFilter></a>[Douglas, D. C., R. Weinzierl,
S. C. Davidson, R. Kays, M. Wikelski, and G.
Bohrer](#cite-Douglas2012_ArgosFilter) (2012). "Moderating Argos
location errors in animal tracking data". In: _Methods in Ecology and
Evolution_ 3.6. Ed. by L. Giuggioli, pp. 999-1007. DOI:
[10.1111/j.2041-210x.2012.00245.x](https://doi.org/10.1111%2Fj.2041-210x.2012.00245.x).

<a name=bib-Durner2009></a>[Durner, G. M., D. C. Douglas, R. M.
Nielson, S. C. Amstrup, T. L. McDonald, I. Stirling, M. Mauritzen, E.
W. Born, Ø. Wiig, E. DeWeaver, M. C. Serreze, S. E. Belikov, M. M.
Holland, J. Maslanik, J. Aars, D. A. Bailey, and A. E.
Derocher](#cite-Durner2009) (2009). "Predicting 21st-century polar bear
habitat distribution from global climate models". In: _Ecological
Monographs_ 79.1, pp. 25-58. ISSN: 1557-7015. DOI:
[10.1890/07-2089.1](https://doi.org/10.1890%2F07-2089.1).

<a name=bib-Swimming687km></a>[Durner, G. M., J. P. Whiteman, H. J.
Harlow, S. C. Amstrup, E. V. Regehr, and M.
Ben-David](#cite-Swimming687km) (2011). "Consequences of long-distance
swimming and travel over deep-water pack ice for a female polar bear
during a year of extreme sea ice retreat". In: _Polar Biology_ 34.7, p.
975–984. ISSN: 1432-2056. DOI:
[10.1007/s00300-010-0953-2](https://doi.org/10.1007%2Fs00300-010-0953-2).

<a name=bib-Argos-filter></a>[Freitas, C., C. Lydersen, M. A. Fedak,
and K. M. Kovacs](#cite-Argos-filter) (2008). "A simple new algorithm
to filter marine mammal Argos locations". In: _Marine Mammal Science_
24.3, pp. 315-325. DOI:
[10.1111/j.1748-7692.2007.00180.x](https://doi.org/10.1111%2Fj.1748-7692.2007.00180.x).

<a name=bib-Jonsen2020-CRW></a>[Jonsen, I. D., T. A. Patterson, D. P.
Costa, P. D. Doherty, B. J. Godley, W. J. Grecian, C. Guinet, X.
Hoenner, S. S. Kienle, P. W. Robinson, S. C. Votier, S. Whiting, M. J.
Witt, M. A. Hindell, R. G. Harcourt, and C. R.
McMahon](#cite-Jonsen2020-CRW) (2020). "A continuous-time state-space
model for rapid quality control of argos locations from animal-borne
tags". In: _Movement Ecology_ 8.1. ISSN: 2051-3933. DOI:
[10.1186/s40462-020-00217-7](https://doi.org/10.1186%2Fs40462-020-00217-7).
URL:
[http://dx.doi.org/10.1186/s40462-020-00217-7](http://dx.doi.org/10.1186/s40462-020-00217-7).

<a name=bib-Laidre2022-subpopulation></a>[Laidre, K. L., M. A. Supple,
E. W. Born, E. V. Regehr, Ø. Wiig, F. Ugarte, J. Aars, R. Dietz, C.
Sonne, P. Hegelund, C. Isaksen, G. B. Akse, B. Cohen, H. L. Stern, T.
Moon, C. Vollmers, R. Corbett-Detig, D. Paetkau, and B.
Shapiro](#cite-Laidre2022-subpopulation) (2022). "Glacial ice supports
a distinct and undocumented polar bear subpopulation persisting in late
21st-century sea-ice conditions". In: _Science_ 376.6599, pp.
1333-1338. DOI:
[10.1126/science.abk2793](https://doi.org/10.1126%2Fscience.abk2793).

<a name=bib-Mauritzen2002></a>[Mauritzen, M., A. E. Derocher, Ø. Wiig,
S. E. Belikov, A. N. Boltunov, E. Hansen, and G. W.
Garner](#cite-Mauritzen2002) (2002). "Using satellite telemetry to
define spatial population structure in polar bears in the Norwegian and
western Russian Arctic". In: _Journal of Applied Ecology_ 39.1, pp.
79-90. DOI:
[10.1046/j.1365-2664.2002.00690.x](https://doi.org/10.1046%2Fj.1365-2664.2002.00690.x).

<a name=bib-Michelot2023></a>[Michelot, T., N. J. Klappstein, J. R.
Potts, and J. Fieberg](#cite-Michelot2023) (2023). "Understanding step
selection analysis through numerical integration". In: _Methods in
Ecology and Evolution_. ISSN: 2041-210X. DOI:
[10.1111/2041-210x.14248](https://doi.org/10.1111%2F2041-210x.14248).

<a name=bib-segmented-article2003></a>[Muggeo, V. M.
R.](#cite-segmented-article2003) (2003). "Estimating regression models
with unknown break‐points". In: _Statistics in Medicine_ 22.19, p.
3055–3071. ISSN: 1097-0258. DOI:
[10.1002/sim.1545](https://doi.org/10.1002%2Fsim.1545). URL:
[http://dx.doi.org/10.1002/sim.1545](http://dx.doi.org/10.1002/sim.1545).

<a name=bib-Rode2018-denPhenology></a>[Rode, K. D., J. Olson, D.
Eggett, D. C. Douglas, G. M. Durner, T. C. Atwood, E. V. Regehr, R. R.
Wilson, T. Smith, and M. S. Martin](#cite-Rode2018-denPhenology)
(2018). "Den phenology and reproductive success of polar bears in a
changing climate". In: _Journal of Mammalogy_ 99.1, pp. 16-26. DOI:
[10.1093/jmammal/gyx181](https://doi.org/10.1093%2Fjmammal%2Fgyx181).

<a name=bib-Wilson2022></a>[Wilson, R. R., M. S. Martin, E. V. Regehr,
and K. D. Rode](#cite-Wilson2022) (2022). "Intrapopulation differences
in polar bear movement and step selection patterns". In: _Movement
Ecology_ 10.1. DOI:
[10.1186/s40462-022-00326-5](https://doi.org/10.1186%2Fs40462-022-00326-5).

<a name=bib-Platonov2019_Vaigach2016></a>[Платонов, Н. Г., И. А. Мизин,
Е. А. Иванов, И. Н. Мордвинцев, С. В. Найденко, and В. В.
Рожнов](#cite-Platonov2019_Vaigach2016) (2019). "Использование белым
медведем (\textitUrsus maritimus) местообитаний вдоль береговой линии в
течение года по данным спутникового мониторинга". In: _Исследование
Земли из космоса_, pp. 80-91. DOI:
[10.31857/S0205-96142019380-91](https://doi.org/10.31857%2FS0205-96142019380-91).
URL:
[https://journals.eco-vector.com/0205-9614/article/view/14272](https://journals.eco-vector.com/0205-9614/article/view/14272).

<a name=bib-Platonov2014_drift_ru></a>[Платонов, Н., В. Рожнов, И.
Алпацкий, И. Мордвинцев, Е. Иванов, and С.
Найденко](#cite-Platonov2014_drift_ru) (2014). "Оценка перемещений
белого медведя с учетом дрейфа льда." In: _Доклады Академии наук: Общая
биология_ 456.3, pp. 366-369. DOI:
[10.7868/S0869565214150249](https://doi.org/10.7868%2FS0869565214150249).
URL:
[http://bear.sevin-expedition.ru/netcat_files/146/81/Platonov_2014_2.pdf](http://bear.sevin-expedition.ru/netcat_files/146/81/Platonov_2014_2.pdf).

<a name=bib-Rozhnov2014_FJL2011></a>[Рожнов, В., Н. Платонов, И.
Мордвинцев, С. Найденко, Е. Иванов, and Р.
Ершов](#cite-Rozhnov2014_FJL2011) (2014). "Перемещения радиомеченых
самок белого медведя (_Ursus maritimus_) на острове Земля Александры
(архипелаг Земля Франца-Иосифа) в безледный период осенью 2011 г." In:
_Зоологический журнал_ 93.11, pp. 1354-1368. ISSN: 0044-5134. DOI:
[10.7868/S0044513414080091](https://doi.org/10.7868%2FS0044513414080091).
URL:
[http://elibrary.ru/item.asp?doi=10.7868/S0044513414080091](http://elibrary.ru/item.asp?doi=10.7868/S0044513414080091).

<a name=bib-Rozhnov2017_hutuda_ru></a>[Рожнов, В., Н. Платонов, С.
Найденко, И. Мордвинцев, and Е. Иванов](#cite-Rozhnov2017_hutuda_ru)
(2017). "Перемещение самки белого медведя в Карском море в период
летнего таяния льда". In: _Доклады Академии наук_, pp. 359-363. DOI:
[10.7868/S0869565217030276](https://doi.org/10.7868%2FS0869565217030276).
]


]

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"countIncrementalSlides": false,
"ratio": "16:9",
"navigation": {
"scroll": true,
"click": false,
"touch": true
},
"highlightLines": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title> </title>
  <script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
  <style type="text/css">.countdown {background: #E5E5FF90;position: absolute;cursor: pointer;font-size: 2.25vh;line-height: 1;border-color: #dddddd20;border-width: 1px;border-style: solid;border-radius: 5px;box-shadow: 0px 4px 10px 0px rgba(50, 50, 50, 0.4);-webkit-box-shadow: 0px 4px 10px 0px rgba(50, 50, 50, 0.4);margin: 0.2em 0.2em;padding: 0.2em;text-align: center;z-index: 10;-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;}.countdown {display: flex;align-items: center;justify-content: center;}.countdown .countdown-time {background: none;font-size: 100%;padding: 0;}.countdown-digits {color: #0004;}.countdown.running {border-color: #CBCBCBFF;background-color: #E5E5E590;}.countdown.running .countdown-digits {color: #363636FF;}.countdown.finished {border-color: #DE3000FF;background-color: #F0412490;}.countdown.finished .countdown-digits {color: #4A0900FF;}.countdown.running.warning {border-color: #DCC98FFF;background-color: #F6E2A990;}.countdown.running.warning .countdown-digits {color: #403502FF;}.countdown.running.blink-colon .countdown-digits.colon {opacity: 0.1;}.countdown:not(.running) .countdown-controls {display: none;}.countdown-controls {position: absolute;top: -0.5rem;right: -0.5rem;left: -0.5rem;display: flex;justify-content: space-between;margin: 0;padding: 0;}.countdown-controls > button {font-size: 1.5rem;width: 1rem;height: 1rem;display: inline-block;display: flex;flex-direction: column;align-items: center;justify-content: center;font-family: monospace;padding: 10px;margin: 0;background: inherit;border: 2px solid;border-radius: 100%;transition: 50ms transform ease-in-out, 150ms opacity ease-in;--countdown-transition-distance: 10px;}.countdown .countdown-controls > button:last-child {transform: translate(calc(-1 * var(--countdown-transition-distance)), var(--countdown-transition-distance));opacity: 0;color: #363636FF;background-color: #E5E5E590;border-color: #CBCBCBFF;}.countdown .countdown-controls > button:first-child {transform: translate(var(--countdown-transition-distance), var(--countdown-transition-distance));opacity: 0;color: #4A0900FF;background-color: #F0412490;border-color: #DE3000FF;}.countdown.running:hover .countdown-controls > button,.countdown.running:focus-within .countdown-controls > button{transform: translate(0, 0);opacity: 1;}.countdown.running:hover .countdown-controls > button:hover,.countdown.running:focus-within .countdown-controls > button:hover{transform: translate(0, calc(var(--countdown-transition-distance) / -2));box-shadow: 0px 2px 5px 0px rgba(50, 50, 50, 0.4);-webkit-box-shadow: 0px 2px 5px 0px rgba(50, 50, 50, 0.4);}.countdown.running:hover .countdown-controls > button:active,.countdown.running:focus-within .countdown-controls > button:active{transform: translate(0, calc(var(--coutndown-transition-distance) / -5));}.countdown.countdown-fullscreen {z-index: 0;}.countdown-fullscreen.running .countdown-controls {top: 1rem;left: 0;right: 0;justify-content: center;}.countdown-fullscreen.running .countdown-controls > button + button {margin-left: 1rem;}</style>
  <script>/* globals Shiny,Audio */
class CountdownTimer {
  constructor (el, opts) {
    if (typeof el === 'string' || el instanceof String) {
      el = document.querySelector(el)
    }

    if (el.counter) {
      return el.counter
    }

    const minutes = parseInt(el.querySelector('.minutes').innerText || '0')
    const seconds = parseInt(el.querySelector('.seconds').innerText || '0')
    const duration = minutes * 60 + seconds

    function attrIsTrue (x) {
      if (x === true) return true
      return !!(x === 'true' || x === '' || x === '1')
    }

    this.element = el
    this.duration = duration
    this.end = null
    this.is_running = false
    this.warn_when = parseInt(el.dataset.warnWhen) || -1
    this.update_every = parseInt(el.dataset.updateEvery) || 1
    this.play_sound = attrIsTrue(el.dataset.playSound)
    this.blink_colon = attrIsTrue(el.dataset.blinkColon)
    this.startImmediately = attrIsTrue(el.dataset.startImmediately)
    this.timeout = null
    this.display = { minutes, seconds }

    if (opts.src_location) {
      this.src_location = opts.src_location
    }

    this.addEventListeners()
  }

  addEventListeners () {
    const self = this

    if (this.startImmediately) {
      if (window.remark && window.slideshow) {
        // Remark (xaringan) support
        const isOnVisibleSlide = () => {
          return document.querySelector('.remark-visible').contains(self.element)
        }
        if (isOnVisibleSlide()) {
          self.start()
        } else {
          let started_once = 0
          window.slideshow.on('afterShowSlide', function () {
            if (started_once > 0) return
            if (isOnVisibleSlide()) {
              self.start()
              started_once = 1
            }
          })
        }
      } else if (window.Reveal) {
        // Revealjs (quarto) support
        const isOnVisibleSlide = () => {
          const currentSlide = document.querySelector('.reveal .slide.present')
          return currentSlide ? currentSlide.contains(self.element) : false
        }
        if (isOnVisibleSlide()) {
          self.start()
        } else {
          const revealStartTimer = () => {
            if (isOnVisibleSlide()) {
              self.start()
              window.Reveal.off('slidechanged', revealStartTimer)
            }
          }
          window.Reveal.on('slidechanged', revealStartTimer)
        }
      } else if (window.IntersectionObserver) {
        // All other situtations use IntersectionObserver
        const onVisible = (element, callback) => {
          new window.IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
              if (entry.intersectionRatio > 0) {
                callback(element)
                observer.disconnect()
              }
            })
          }).observe(element)
        }
        onVisible(this.element, el => el.countdown.start())
      } else {
        // or just start the timer as soon as it's initialized
        this.start()
      }
    }

    function haltEvent (ev) {
      ev.preventDefault()
      ev.stopPropagation()
    }
    function isSpaceOrEnter (ev) {
      return ev.code === 'Space' || ev.code === 'Enter'
    }
    function isArrowUpOrDown (ev) {
      return ev.code === 'ArrowUp' || ev.code === 'ArrowDown'
    }

    ;['click', 'touchend'].forEach(function (eventType) {
      self.element.addEventListener(eventType, function (ev) {
        haltEvent(ev)
        self.is_running ? self.stop() : self.start()
      })
    })
    this.element.addEventListener('keydown', function (ev) {
      if (ev.code === "Escape") {
        self.reset()
        haltEvent(ev)
      }
      if (!isSpaceOrEnter(ev) && !isArrowUpOrDown(ev)) return
      haltEvent(ev)
      if (isSpaceOrEnter(ev)) {
        self.is_running ? self.stop() : self.start()
        return
      }

      if (!self.is_running) return

      if (ev.code === 'ArrowUp') {
        self.bumpUp()
      } else if (ev.code === 'ArrowDown') {
        self.bumpDown()
      }
    })
    this.element.addEventListener('dblclick', function (ev) {
      haltEvent(ev)
      if (self.is_running) self.reset()
    })
    this.element.addEventListener('touchmove', haltEvent)

    const btnBumpDown = this.element.querySelector('.countdown-bump-down')
    ;['click', 'touchend'].forEach(function (eventType) {
      btnBumpDown.addEventListener(eventType, function (ev) {
        haltEvent(ev)
        if (self.is_running) self.bumpDown()
      })
    })
    btnBumpDown.addEventListener('keydown', function (ev) {
      if (!isSpaceOrEnter(ev) || !self.is_running) return
      haltEvent(ev)
      self.bumpDown()
    })

    const btnBumpUp = this.element.querySelector('.countdown-bump-up')
    ;['click', 'touchend'].forEach(function (eventType) {
      btnBumpUp.addEventListener(eventType, function (ev) {
        haltEvent(ev)
        if (self.is_running) self.bumpUp()
      })
    })
    btnBumpUp.addEventListener('keydown', function (ev) {
      if (!isSpaceOrEnter(ev) || !self.is_running) return
      haltEvent(ev)
      self.bumpUp()
    })
    this.element.querySelector('.countdown-controls').addEventListener('dblclick', function (ev) {
      haltEvent(ev)
    })
  }

  remainingTime () {
    const remaining = this.is_running
      ? (this.end - Date.now()) / 1000
      : this.remaining || this.duration

    let minutes = Math.floor(remaining / 60)
    let seconds = Math.ceil(remaining - minutes * 60)

    if (seconds > 59) {
      minutes = minutes + 1
      seconds = seconds - 60
    }

    return { remaining, minutes, seconds }
  }

  start () {
    if (this.is_running) return

    this.is_running = true

    if (this.remaining) {
      // Having a static remaining time indicates timer was paused
      this.end = Date.now() + this.remaining * 1000
      this.remaining = null
    } else {
      this.end = Date.now() + this.duration * 1000
    }

    this.reportStateToShiny('start')

    this.element.classList.remove('finished')
    this.element.classList.add('running')
    this.update(true)
    this.tick()
  }

  tick (run_again) {
    if (typeof run_again === 'undefined') {
      run_again = true
    }

    if (!this.is_running) return

    const { seconds: secondsWas } = this.display
    this.update()

    if (run_again) {
      const delay = (this.end - Date.now() > 10000) ? 1000 : 250
      this.blinkColon(secondsWas)
      this.timeout = setTimeout(this.tick.bind(this), delay)
    }
  }

  blinkColon (secondsWas) {
    // don't blink unless option is set
    if (!this.blink_colon) return
    // warn_when always updates the seconds
    if (this.warn_when > 0 && Date.now() + this.warn_when > this.end) {
      this.element.classList.remove('blink-colon')
      return
    }
    const { seconds: secondsIs } = this.display
    if (secondsIs > 10 || secondsWas !== secondsIs) {
      this.element.classList.toggle('blink-colon')
    }
  }

  update (force) {
    if (typeof force === 'undefined') {
      force = false
    }

    const { remaining, minutes, seconds } = this.remainingTime()

    const setRemainingTime = (selector, time) => {
      const timeContainer = this.element.querySelector(selector)
      if (!timeContainer) return
      time = Math.max(time, 0)
      timeContainer.innerText = String(time).padStart(2, 0)
    }

    if (this.is_running && remaining < 0.25) {
      this.stop()
      setRemainingTime('.minutes', 0)
      setRemainingTime('.seconds', 0)
      this.playSound()
      return
    }

    const should_update = force ||
      Math.round(remaining) < this.warn_when ||
      Math.round(remaining) % this.update_every === 0

    if (should_update) {
      this.element.classList.toggle('warning', remaining <= this.warn_when)
      this.display = { minutes, seconds }
      setRemainingTime('.minutes', minutes)
      setRemainingTime('.seconds', seconds)
    }
  }

  stop () {
    const { remaining } = this.remainingTime()
    if (remaining > 1) {
      this.remaining = remaining
    }
    this.element.classList.remove('running')
    this.element.classList.remove('warning')
    this.element.classList.remove('blink-colon')
    this.element.classList.add('finished')
    this.is_running = false
    this.end = null
    this.reportStateToShiny('stop')
    this.timeout = clearTimeout(this.timeout)
  }

  reset () {
    this.stop()
    this.remaining = null
    this.update(true)
    this.reportStateToShiny('reset')
    this.element.classList.remove('finished')
    this.element.classList.remove('warning')
  }

  setValues (opts) {
    if (typeof opts.warn_when !== 'undefined') {
      this.warn_when = opts.warn_when
    }
    if (typeof opts.update_every !== 'undefined') {
      this.update_every = opts.update_every
    }
    if (typeof opts.blink_colon !== 'undefined') {
      this.blink_colon = opts.blink_colon
      if (!opts.blink_colon) {
        this.element.classList.remove('blink-colon')
      }
    }
    if (typeof opts.play_sound !== 'undefined') {
      this.play_sound = opts.play_sound
    }
    if (typeof opts.duration !== 'undefined') {
      this.duration = opts.duration
      if (this.is_running) {
        this.reset()
        this.start()
      }
    }
    this.reportStateToShiny('update')
    this.update(true)
  }

  bumpTimer (val, round) {
    round = typeof round === 'boolean' ? round : true
    const { remaining } = this.remainingTime()
    let newRemaining = remaining + val
    if (newRemaining <= 0) {
      this.setRemaining(0)
      this.stop()
      return
    }
    if (round && newRemaining > 10) {
      newRemaining = Math.round(newRemaining / 5) * 5
    }
    this.setRemaining(newRemaining)
    this.reportStateToShiny(val > 0 ? 'bumpUp' : 'bumpDown')
    this.update(true)
  }

  bumpUp (val) {
    if (!this.is_running) {
      console.error('timer is not running')
      return
    }
    this.bumpTimer(
      val || this.bumpIncrementValue(),
      typeof val === 'undefined'
    )
  }

  bumpDown (val) {
    if (!this.is_running) {
      console.error('timer is not running')
      return
    }
    this.bumpTimer(
      val || -1 * this.bumpIncrementValue(),
      typeof val === 'undefined'
    )
  }

  setRemaining (val) {
    if (!this.is_running) {
      console.error('timer is not running')
      return
    }
    this.end = Date.now() + val * 1000
    this.update(true)
  }

  playSound () {
    let url = this.play_sound
    if (!url) return
    if (typeof url === 'boolean') {
      const src = this.src_location
        ? this.src_location.replace('/countdown.js', '')
        : 'libs/countdown'
      url = src + '/smb_stage_clear.mp3'
    }
    const sound = new Audio(url)
    sound.play()
  }

  bumpIncrementValue (val) {
    val = val || this.remainingTime().remaining
    if (val <= 30) {
      return 5
    } else if (val <= 300) {
      return 15
    } else if (val <= 3000) {
      return 30
    } else {
      return 60
    }
  }

  reportStateToShiny (action) {
    if (!window.Shiny) return

    const inputId = this.element.id
    const data = {
      event: {
        action,
        time: new Date().toISOString()
      },
      timer: {
        is_running: this.is_running,
        end: this.end ? new Date(this.end).toISOString() : null,
        remaining: this.remainingTime()
      }
    }

    function shinySetInputValue () {
      if (!window.Shiny.setInputValue) {
        setTimeout(shinySetInputValue, 100)
        return
      }
      window.Shiny.setInputValue(inputId, data)
    }

    shinySetInputValue()
  }
}

(function () {
  const CURRENT_SCRIPT = document.currentScript.getAttribute('src')

  document.addEventListener('DOMContentLoaded', function () {
    const els = document.querySelectorAll('.countdown')
    if (!els || !els.length) {
      return
    }
    els.forEach(function (el) {
      el.countdown = new CountdownTimer(el, { src_location: CURRENT_SCRIPT })
    })

    if (window.Shiny) {
      Shiny.addCustomMessageHandler('countdown:update', function (x) {
        if (!x.id) {
          console.error('No `id` provided, cannot update countdown')
          return
        }
        const el = document.getElementById(x.id)
        el.countdown.setValues(x)
      })

      Shiny.addCustomMessageHandler('countdown:start', function (id) {
        const el = document.getElementById(id)
        if (!el) return
        el.countdown.start()
      })

      Shiny.addCustomMessageHandler('countdown:stop', function (id) {
        const el = document.getElementById(id)
        if (!el) return
        el.countdown.stop()
      })

      Shiny.addCustomMessageHandler('countdown:reset', function (id) {
        const el = document.getElementById(id)
        if (!el) return
        el.countdown.reset()
      })

      Shiny.addCustomMessageHandler('countdown:bumpUp', function (id) {
        const el = document.getElementById(id)
        if (!el) return
        el.countdown.bumpUp()
      })

      Shiny.addCustomMessageHandler('countdown:bumpDown', function (id) {
        const el = document.getElementById(id)
        if (!el) return
        el.countdown.bumpDown()
      })
    }
  })
})()
</script>
</head>
<body>
<div id="header">
<h1 class="title"> </h1>
</div>
<div class="countdown" id="timer_8d9457cf" data-warn-when="120" data-update-every="15" data-blink-colon="true" tabindex="0" style="right:0;bottom:0;margin:0.2em 0.2em;padding:0.2em;font-size:2.25vh;z-index:100">
<div class="countdown-controls"><button class="countdown-bump-down">−</button><button class="countdown-bump-up">+</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">06</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>
</body>
</html>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
