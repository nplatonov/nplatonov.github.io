<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Balaena</title>

<script src="https://nplatonov.github.io/site_libs/header-attrs-2.25/header-attrs.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
      .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="https://nplatonov.github.io/site_libs/common.css" type="text/css" />
<link rel="stylesheet" href="https://nplatonov.github.io/site_libs/html_vignette.css" type="text/css" />




</head>

<body>






<div id="TOC">
<ul>
<li><a href="#подготовка" id="toc-подготовка">Подготовка</a>
<ul>
<li><a href="#prerequisites" id="toc-prerequisites">Prerequisites</a></li>
<li><a href="#функции" id="toc-функции">Функции</a></li>
</ul></li>
<li><a href="#обработка" id="toc-обработка">Обработка</a>
<ul>
<li><a href="#прореживание" id="toc-прореживание">Прореживание</a></li>
<li><a href="#добавление-точек-псевдоотсутствия" id="toc-добавление-точек-псевдоотсутствия">Добавление точек псевдоотсутствия</a></li>
<li><a href="#добавление-предикторов" id="toc-добавление-предикторов">Добавление предикторов</a>
<ul>
<li><a href="#gebco" id="toc-gebco">GEBCO</a></li>
<li><a href="#расстояние-до-берега" id="toc-расстояние-до-берега">Расстояние до берега</a></li>
<li><a href="#концентрация-льда" id="toc-концентрация-льда">Концентрация льда</a></li>
<li><a href="#расстояние-до-кромки-льда." id="toc-расстояние-до-кромки-льда.">Расстояние до кромки льда.</a></li>
<li><a href="#характеристики-поверхности-океана" id="toc-характеристики-поверхности-океана">Характеристики поверхности океана</a></li>
</ul></li>
</ul></li>
<li><a href="#построение-модели" id="toc-построение-модели">Построение модели</a>
<ul>
<li><a href="#glm" id="toc-glm">GLM</a></li>
<li><a href="#lm" id="toc-lm">LM</a></li>
<li><a href="#логистическая-линейная" id="toc-логистическая-линейная">Логистическая линейная</a></li>
</ul></li>
<li><a href="#предсказание" id="toc-предсказание">Предсказание</a></li>
</ul>
</div>

<div id="подготовка" class="section level2">
<h2>Подготовка</h2>
<div id="prerequisites" class="section level3">
<h3>Prerequisites</h3>
<p>Задать директорию, в которой хранятся исходные данные, включая таблицу с находками и директорию <code>исходники</code> c растрами.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>root <span class="ot">&lt;-</span> <span class="st">&quot;D:/ongoing/byk&quot;</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>bandfmt <span class="ot">&lt;-</span> <span class="st">&quot;%Y-%m-%d&quot;</span></span></code></pre></div>
<p>Будем создавать многослойные (multiband) растры, в которых названия слоёв будут датами будут в формате <code>"2024-02-29"</code>; это определяется значение переменной <code>bandfmt</code>.</p>
<p>По расстоянию будем считать, что если у нас 10 или 15 км, то это важное отличие, а когда 150 или 200, то уже и не такое важное, потому что и так достаточно большое, поэтому зададим возведение в степень (типа, логарифм, не совсем, конечно, но достаточно близко).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>distpower <span class="ot">&lt;-</span> <span class="fl">0.5</span></span></code></pre></div>
<p>Уровень береговой линии по значениям GEBCO. То, что меньше <code>coast</code> – это море; то, что вышел <code>coast</code> – это суша.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>coast <span class="ot">&lt;-</span> <span class="dv">2</span></span></code></pre></div>
<p>Используется версия пакета <strong><code>ursa</code></strong>, которой нет в CRAN.
Как вариант (Windows), можно создать в <code>root</code> директорию <code>libs</code> и распаковать туда <code>ursa_3.11.0-1078.zip</code>. Должно быть что-то наподобие <code>D:/ongoing/byk/libs/ursa</code> и внутри распакованный пакет.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">exists</span>(<span class="st">&quot;ursa&quot;</span>)) {</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>   opW <span class="ot">&lt;-</span> <span class="fu">options</span>(<span class="at">warn=</span><span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>   <span class="fu">require</span>(ursa,<span class="at">lib.loc=</span><span class="fu">file.path</span>(root,<span class="st">&quot;libs&quot;</span>))</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>   <span class="fu">options</span>(opW)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>Loading required package: ursa</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">exists</span>(<span class="st">&quot;ursa&quot;</span>))</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>   <span class="fu">require</span>(ursa)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">packageVersion</span>(<span class="st">&quot;ursa&quot;</span>)<span class="sc">&gt;</span><span class="st">&quot;3.11&quot;</span>)</span></code></pre></div>
</div>
<div id="функции" class="section level3">
<h3>Функции</h3>
<p>Далее определим несколько функций, так как эти действия выполняются более одного раза</p>
<p><code>изИсходников()</code> читает растры и преобразует в координатную сетку сессии</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="st">&#39;изИсходников&#39;</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">pattern=</span><span class="st">&quot;</span><span class="sc">\\</span><span class="st">.tif&quot;</span>,<span class="at">dates=</span><span class="cn">NA</span>,<span class="at">nodata=</span><span class="cn">NA</span>,<span class="at">resample=</span><span class="st">&quot;near&quot;</span>) {</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>   <span class="cf">if</span> (hasSeries <span class="ot">&lt;-</span> <span class="sc">!</span><span class="fu">is.na</span>(dates)) { </span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>      fmtdate <span class="ot">&lt;-</span> dates</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>      fmtdate <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;%Y&quot;</span>,<span class="st">&quot;</span><span class="sc">\\\\</span><span class="st">d{4}&quot;</span>,fmtdate)</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>      fmtdate <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;%y&quot;</span>,<span class="st">&quot;</span><span class="sc">\\\\</span><span class="st">d{2}&quot;</span>,fmtdate)</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>      fmtdate <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;%m&quot;</span>,<span class="st">&quot;</span><span class="sc">\\\\</span><span class="st">d{2}&quot;</span>,fmtdate)</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>      fmtdate <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;%d&quot;</span>,<span class="st">&quot;</span><span class="sc">\\\\</span><span class="st">d{2}&quot;</span>,fmtdate)</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>   }</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>   list1 <span class="ot">&lt;-</span> <span class="fu">dir</span>(<span class="at">path=</span><span class="fu">file.path</span>(root,<span class="st">&quot;исходники&quot;</span>),<span class="at">pattern=</span>pattern,<span class="at">full.names=</span><span class="cn">TRUE</span>)</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>   <span class="cf">if</span> (hasSeries) {</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>      bname <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">gsub</span>(<span class="fu">paste0</span>(<span class="st">&quot;.*(&quot;</span>,fmtdate,<span class="st">&quot;).*&quot;</span>),<span class="st">&quot;</span><span class="sc">\\</span><span class="st">1&quot;</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>                           ,<span class="fu">basename</span>(list1)),<span class="at">format=</span>dates)</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>      res <span class="ot">&lt;-</span> <span class="fu">ursa</span>(<span class="at">bandname=</span><span class="fu">format</span>(bname,bandfmt))</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>   }</span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>   <span class="cf">else</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>      res <span class="ot">&lt;-</span> <span class="fu">ursa</span>(<span class="at">bandfname=</span><span class="fu">basename</span>(list1))</span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a>   opW <span class="ot">&lt;-</span> <span class="fu">options</span>(<span class="at">warn=</span><span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(res) <span class="sc">|&gt;</span> <span class="fu">sample</span>()) {</span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a>      a <span class="ot">&lt;-</span> ursa<span class="sc">:::</span><span class="fu">.gdalwarp</span>(list1[i],<span class="at">resample=</span>resample)</span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">isTRUE</span>(nodata<span class="sc">&gt;</span><span class="dv">0</span>))</span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a>         a[a<span class="sc">&gt;</span>nodata] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a>      <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">isTRUE</span>(nodata<span class="sc">&lt;=</span><span class="dv">0</span>))</span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a>         a[a<span class="sc">&lt;=</span>nodata] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a>      res[i] <span class="ot">&lt;-</span> a</span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a>   }</span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a>   <span class="fu">options</span>(opW)</span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a>   res</span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a>}</span></code></pre></div>
<p><code>environ()</code> соотносит коррдинатам находок и псевдонаходок значения параметров окружающей среды</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="st">&#39;environ&#39;</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(loc,env,<span class="at">maxD=</span><span class="dv">9999</span>) {</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>   res <span class="ot">&lt;-</span> resD <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="fu">spatial_count</span>(loc))</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>   env <span class="ot">&lt;-</span> env[<span class="sc">!</span><span class="fu">band_blank</span>(env)]</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>   d4 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">names</span>(env),bandfmt)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>   <span class="cf">if</span> (hasDate <span class="ot">&lt;-</span> <span class="sc">!</span><span class="fu">anyNA</span>(d4))</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>      ind <span class="ot">&lt;-</span> <span class="fu">sapply</span>(loc<span class="sc">$</span>date,\(d3) <span class="fu">which.min</span>(<span class="fu">abs</span>(d3<span class="sc">-</span>d4)))</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>   <span class="cf">else</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>      ind <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="dt">L</span>,<span class="fu">spatial_count</span>(loc))</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>   p <span class="ot">&lt;-</span> <span class="fu">polygonize</span>(env) <span class="sc">|&gt;</span> <span class="fu">spatial_centroid</span>()</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">unique</span>(ind) <span class="sc">|&gt;</span> <span class="fu">sample</span>()) {</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>      j <span class="ot">&lt;-</span> <span class="fu">which</span>(ind<span class="sc">==</span>i)</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>      p2 <span class="ot">&lt;-</span> p[<span class="sc">!</span><span class="fu">is.na</span>(p[[i]]),i]</span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>      d <span class="ot">&lt;-</span> ursa<span class="sc">:::</span><span class="fu">.dist2</span>(loc[j,],p2,<span class="at">summarize=</span><span class="cn">FALSE</span>,<span class="at">verbose=</span><span class="cn">FALSE</span>)</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>      res[j] <span class="ot">&lt;-</span> p2[[<span class="dv">1</span>]][d<span class="sc">$</span>ind]</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>      resD[j] <span class="ot">&lt;-</span> d<span class="sc">$</span>dist<span class="sc">*</span><span class="fl">1e-3</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>   }</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>   <span class="cf">if</span> (<span class="fu">isTRUE</span>(maxD<span class="sc">&gt;</span><span class="dv">0</span>)) {</span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>      res[resD<span class="sc">&gt;</span>maxD] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a>      <span class="fu">return</span>(res)</span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a>   }</span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a>   val <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">as.list</span>(<span class="fu">match.call</span>())[[<span class="st">&quot;env&quot;</span>]])</span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a>   valD <span class="ot">&lt;-</span> <span class="fu">paste0</span>(env,<span class="st">&quot;D&quot;</span>)</span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a>   loc[[val]] <span class="ot">&lt;-</span> res</span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a>   loc[[valD]] <span class="ot">&lt;-</span> resD</span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a>   loc</span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a>}</span></code></pre></div>
<p>‘dist2border()’ – вспомогательная функция оценки расстояния до разделителя. Например, если разделитель – береговая линия, то расстояние с акватории и расстояние с суши будет иметь различные знаки. Если неважен субстрат, то можно применить впоследствии <code>abs()</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="st">&#39;dist2border&#39;</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(obj,border) {</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>   d1 <span class="ot">&lt;-</span> obj<span class="sc">&gt;=</span>border</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>   d2 <span class="ot">&lt;-</span> obj<span class="sc">&lt;</span>border</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>   <span class="fu">local_sum</span>(<span class="fu">c</span>(ursa<span class="sc">:::</span><span class="fu">.dist2</span>(d1,d2)[<span class="st">&quot;dist&quot;</span>],<span class="sc">-</span>ursa<span class="sc">:::</span><span class="fu">.dist2</span>(d2,d1)[<span class="st">&quot;dist&quot;</span>]),<span class="at">cover=</span><span class="dv">0</span>)</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>}</span></code></pre></div>
<p><code>dist2edge()</code> – в случае с концентацией льда определяет минимальную дистанцию до значения корнцентрации льда, заданного величиной <code>th</code>, и в зависимости от начального субстрата у результата будет различный знак.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="st">&#39;dist2edge&#39;</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(obj,th) {</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>   edge <span class="ot">&lt;-</span> <span class="fu">ursa</span>(<span class="at">bandname=</span><span class="fu">names</span>(conc))</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(conc) <span class="sc">|&gt;</span> <span class="fu">sample</span>())</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>      edge[i] <span class="ot">&lt;-</span> <span class="fu">dist2border</span>(conc[i],th)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>   edge <span class="ot">&lt;-</span> <span class="fu">sign</span>(edge)<span class="sc">*</span><span class="fu">abs</span>(edge<span class="sc">*</span><span class="fl">1e-3</span>)<span class="sc">^</span>distpower</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>   edge</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>}</span></code></pre></div>
<p><code>matchDate()</code> - вспомогательая функция, чтобы к дате концентрации льда подобрать дату хлорофилла (температуры, солености – любых нерегулярных). Здесь просто - ближайший день. Но можно усложнить через временную интерполяцию и кригинг.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="st">&#39;matchDate&#39;</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(obj,date) {</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>   <span class="cf">if</span> (<span class="fu">is_ursa</span>(obj))</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>      obj <span class="ot">&lt;-</span> <span class="fu">names</span>(obj)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>   <span class="cf">if</span> (<span class="fu">is.character</span>(obj))</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>      obj <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(obj,bandfmt)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>   <span class="cf">if</span> (<span class="fu">is_ursa</span>(date))</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>      date <span class="ot">&lt;-</span> <span class="fu">names</span>(date)</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>   <span class="cf">if</span> (<span class="fu">is.character</span>(date))</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>      date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(date,bandfmt)</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>   ursa<span class="sc">:::</span><span class="fu">.sample</span>(<span class="fu">which.min</span>(<span class="fu">abs</span>(obj<span class="sc">-</span>date)),<span class="dv">1</span>)</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="обработка" class="section level2">
<h2>Обработка</h2>
<p>Зададим случайное число от 100 до 999 для псеводгенератора случайных чисел. Если зафиксировать это число, например, <code>seed &lt;- 933</code>, то результат будет (должен быть) одним и тем же при разных прогонах.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>seed <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq</span>(<span class="dv">100</span>,<span class="dv">999</span>),<span class="dv">1</span>) <span class="do">## 933</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">c</span>(<span class="at">seed=</span>seed)</span></code></pre></div>
<pre><code>seed 
 221 </code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">set.seed</span>(seed)</span></code></pre></div>
<p>Чтение исходной таблицы и ее преобразование в пространственные данные.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># getOption(&quot;error&quot;)</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>loc <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">file.path</span>(root,<span class="st">&quot;Bowhead_whale.csv&quot;</span>),<span class="at">sep=</span><span class="st">&quot;;&quot;</span>,<span class="at">dec=</span><span class="st">&quot;.&quot;</span>)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>loc <span class="ot">&lt;-</span> ursa<span class="sc">:::</span><span class="fu">spatialize</span>(loc,<span class="at">style=</span><span class="st">&quot;laea&quot;</span>,<span class="at">lon0=</span><span class="dv">70</span>,<span class="at">lat0=</span><span class="dv">80</span>)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>loc<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(loc<span class="sc">$</span>date,<span class="at">format=</span><span class="st">&quot;%d.%m.%Y&quot;</span>)</span></code></pre></div>
<p>Уберем лишние столбцы</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>loc<span class="sc">$</span>year <span class="ot">&lt;-</span> loc<span class="sc">$</span>month <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">table</span>(loc<span class="sc">$</span>Species))<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>   loc<span class="sc">$</span>Species <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<p>В поле <code>pa</code> присутствие - 1, псевдоотсутствие - 0</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>loc<span class="sc">$</span>pa <span class="ot">&lt;-</span> <span class="dv">1</span><span class="dt">L</span></span></code></pre></div>
<p>Сформируем координатную сетку и сделаем ее сессионной. В дальнейшем преобразование координатных сеток будет осуществляться к сессионной координатной сетке. Размер ячейки 10 км, а пространственный охват расширен в полтора раза.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">regrid</span>(<span class="fu">spatial_grid</span>(loc),<span class="at">expand=</span><span class="fl">1.5</span>,<span class="at">res=</span><span class="dv">10000</span>)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="fu">session_grid</span>(g1)</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>g1</span></code></pre></div>
<pre><code>List of 9
 $ columns: int 189
 $ rows   : int 104
 $ resx   : num 10000
 $ resy   : num 10000
 $ minx   : num -840000
 $ maxx   : num 1050000
 $ miny   : num -610000
 $ maxy   : num 430000
 $ crs    : chr &quot;laea lon_0=70 lat_0=80 &#39;WGS 84&#39;&quot;
 - attr(*, &quot;class&quot;)= chr &quot;.ursaGrid&quot;</code></pre>
<div id="прореживание" class="section level3">
<h3>Прореживание</h3>
<p>Сделаем прореживание точек, расположенных близко друг к другу. Тут несколько упрощено, так как прореживать нужно точки за близкие даты, когда условия окружающей среды, даже распределение льда, схожие.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="cf">if</span> (T) {</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>   loc <span class="ot">&lt;-</span> ursa<span class="sc">:::</span><span class="fu">spatialize</span>(loc,<span class="at">engine=</span><span class="st">&quot;sp&quot;</span>)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>   gr <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(g1)</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>   sp<span class="sc">::</span><span class="fu">coordinates</span>(gr) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>)</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>   sp<span class="sc">::</span><span class="fu">proj4string</span>(gr) <span class="ot">&lt;-</span> sp<span class="sc">::</span><span class="fu">proj4string</span>(loc) <span class="co"># sf::st_crs(spatial_crs(loc))$proj4string</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>   sp<span class="sc">::</span><span class="fu">gridded</span>(gr) <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>   opW <span class="ot">&lt;-</span> <span class="fu">options</span>(<span class="at">warn=</span><span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>   hr <span class="ot">&lt;-</span> adehabitatHR<span class="sc">::</span><span class="fu">kernelUD</span>(loc</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>                               ,<span class="at">grid=</span>gr</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>                               ,<span class="at">h=</span><span class="fu">list</span>(<span class="st">&quot;href&quot;</span>,<span class="st">&quot;LSCV&quot;</span>,<span class="dv">10000</span>)[[<span class="dv">1</span>]]</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>                               ,<span class="at">kern=</span><span class="fu">c</span>(<span class="st">&quot;bivnorm&quot;</span>,<span class="st">&quot;epa&quot;</span>)[<span class="dv">1</span>] <span class="do">## 1$1 2$1 1$2</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>                               ,<span class="at">hlim=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">1.5</span>) <span class="do">## for h=LSCV, default</span></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a>                              <span class="co"># ,hlim=c(0.4,1.2) ## for h=LSCV</span></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>                              <span class="co"># ,extent=2 ## ignored if !missing(grid)</span></span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>                               )</span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a>   <span class="fu">options</span>(opW)</span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a>   h <span class="ot">&lt;-</span> hr<span class="sc">@</span>data[[<span class="dv">1</span>]]</span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a>   <span class="fu">dim</span>(h) <span class="ot">&lt;-</span> <span class="fu">dim</span>(g1)</span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a>   h <span class="ot">&lt;-</span> <span class="fu">ursa_new</span>(<span class="fu">t</span>(h)<span class="sc">*</span><span class="fl">1e12</span>,<span class="at">flip=</span><span class="cn">TRUE</span>)<span class="sc">^</span><span class="fl">0.5</span></span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a>   kd <span class="ot">&lt;-</span> <span class="fu">value_xy</span>(h,<span class="fu">spatial_coordinates</span>(loc))[<span class="dv">1</span>,] <span class="sc">|&gt;</span> <span class="fu">ceiling</span>()</span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a>   omit <span class="ot">&lt;-</span> <span class="fu">sapply</span>(kd,\(x) <span class="fu">sample</span>(<span class="fu">seq</span>(x))[<span class="dv">1</span>]<span class="sc">!=</span><span class="dv">1</span>)</span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a>   <span class="fu">print</span>(<span class="fu">table</span>(omit))</span>
<span id="cb21-23"><a href="#cb21-23" tabindex="-1"></a>   loc <span class="ot">&lt;-</span> ursa<span class="sc">:::</span><span class="fu">spatialize</span>(loc[<span class="sc">!</span>omit,],<span class="at">engine=</span><span class="st">&quot;sf&quot;</span>)</span>
<span id="cb21-24"><a href="#cb21-24" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>Registered S3 methods overwritten by &#39;adehabitatMA&#39;:
  method                       from
  print.SpatialPixelsDataFrame sp  
  print.SpatialPixels          sp  </code></pre>
<pre><code>omit
FALSE  TRUE 
   68   123 </code></pre>
</div>
<div id="добавление-точек-псевдоотсутствия" class="section level3">
<h3>Добавление точек псевдоотсутствия</h3>
<p>Преобразуем данные GEBCO в нашу сетку. Точки будет формировать лишь для тех ячеек, для которых GEBCO менее двух метров</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>gebco <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">gebco=</span><span class="st">&#39;изИсходников&#39;</span>(<span class="st">&quot;gebco_depth.tif&quot;</span>,<span class="at">resample=</span><span class="st">&quot;bilinear&quot;</span>))</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="fu">print</span>(gebco)</span></code></pre></div>
<pre><code>     name     mean      sd      sum   min max     n nNA
[1] gebco -450.709 901.917 -8859133 -3688 869 19656   0</code></pre>
<p class="centered-image"><img src="assets/ursa02_unnamed-chunk-20.png" width="628" /></p>
<p>На каждую дату добавим семь точек псевдоотсутствия</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>sea <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(gebco<span class="sc">&lt;</span>coast)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">nrow</span>(sea))</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>absence <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">unique</span>(loc<span class="sc">$</span>date),\(d) {</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>   <span class="fu">data.frame</span>(<span class="at">date=</span>d,<span class="at">pa=</span><span class="dv">0</span><span class="dt">L</span>,sea[<span class="fu">sample</span>(ind,<span class="dv">7</span>),])</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>}) <span class="sc">|&gt;</span> <span class="fu">do.call</span>(rbind,<span class="at">args=</span>_) <span class="sc">|&gt;</span> ursa<span class="sc">:::</span><span class="fu">spatialize</span>(<span class="at">crs=</span><span class="fu">spatial_crs</span>(loc))</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a><span class="fu">session_grid</span>(g1) <span class="do">## восстановление сессионной сетки</span></span></code></pre></div>
<p>Объединим присутствие и псевдоотсутствие</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>loc <span class="ot">&lt;-</span> <span class="fu">spatial_bind</span>(loc,absence)</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a><span class="fu">table</span>(loc<span class="sc">$</span>pa)</span></code></pre></div>
<pre><code>
  0   1 
105  68 </code></pre>
</div>
<div id="добавление-предикторов" class="section level3">
<h3>Добавление предикторов</h3>
<div id="gebco" class="section level4">
<h4>GEBCO</h4>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>loc<span class="sc">$</span>gebco <span class="ot">&lt;-</span> <span class="fu">environ</span>(loc,gebco)</span></code></pre></div>
</div>
<div id="расстояние-до-берега" class="section level4">
<h4>Расстояние до берега</h4>
<p>Расстояние до берега по значениям GEBCO, превышающих +2 метра.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>land <span class="ot">&lt;-</span> gebco<span class="sc">&gt;=</span>coast</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>sea <span class="ot">&lt;-</span> gebco<span class="sc">&lt;</span>coast</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a><span class="cf">if</span> (F) <span class="co"># если только для модели, то можно так</span></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>   loc<span class="sc">$</span>dist2land <span class="ot">&lt;-</span> (ursa<span class="sc">:::</span><span class="fu">.dist2</span>(loc,land,<span class="at">summarize=</span><span class="cn">FALSE</span>,<span class="at">verbose=</span><span class="cn">FALSE</span>)<span class="sc">$</span>dist<span class="sc">*</span><span class="fl">1e-3</span>)<span class="sc">^</span>distpower</span></code></pre></div>
<p>Растр необходим, если по модели будем строить предсказание</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>dist2land <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">dist2land=</span><span class="sc">-</span><span class="fu">dist2border</span>(gebco,coast))</span></code></pre></div>
<p>Расстояние до берега as is</p>
<p class="centered-image"><img src="assets/ursa03_unnamed-chunk-26.png" width="634" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>dist2land <span class="ot">&lt;-</span> <span class="fu">sign</span>(dist2land)<span class="sc">*</span><span class="fu">abs</span>(dist2land<span class="sc">*</span><span class="fl">1e-3</span>)<span class="sc">^</span>distpower</span></code></pre></div>
<p>Преобразованное расстояние до берега, используемое в модели</p>
<p class="centered-image"><img src="assets/ursa04_unnamed-chunk-28.png" width="616" /></p>
</div>
<div id="концентрация-льда" class="section level4">
<h4>Концентрация льда</h4>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>conc <span class="ot">&lt;-</span> <span class="st">&#39;изИсходников&#39;</span>(<span class="st">&quot;AMSR2.+</span><span class="sc">\\</span><span class="st">.tif$&quot;</span>,<span class="st">&quot;%Y%m%d&quot;</span>,<span class="at">nodata=</span><span class="dv">100</span>,<span class="at">resample=</span><span class="st">&quot;bilinear&quot;</span>)</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>loc<span class="sc">$</span>conc <span class="ot">&lt;-</span> <span class="fu">environ</span>(loc,conc)</span></code></pre></div>
</div>
<div id="расстояние-до-кромки-льда." class="section level4">
<h4>Расстояние до кромки льда.</h4>
<p>Кромку льда определим по различным уровням концентрации – 15, 30, 50 и 75%.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>edge15 <span class="ot">&lt;-</span> <span class="fu">dist2edge</span>(conc,<span class="dv">15</span>)</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>loc<span class="sc">$</span>edge15 <span class="ot">&lt;-</span> <span class="fu">environ</span>(loc,edge15)</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a><span class="cf">if</span> (F) {</span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>   edge30 <span class="ot">&lt;-</span> <span class="fu">dist2edge</span>(conc,<span class="dv">30</span>)</span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>   edge50 <span class="ot">&lt;-</span> <span class="fu">dist2edge</span>(conc,<span class="dv">50</span>)</span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>   edge75 <span class="ot">&lt;-</span> <span class="fu">dist2edge</span>(conc,<span class="dv">75</span>)</span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>   loc<span class="sc">$</span>edge30 <span class="ot">&lt;-</span> <span class="fu">dist2edge</span>(loc,edge30)</span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a>   loc<span class="sc">$</span>edge50 <span class="ot">&lt;-</span> <span class="fu">dist2edge</span>(loc,edge50)</span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a>   loc<span class="sc">$</span>edge75 <span class="ot">&lt;-</span> <span class="fu">dist2edge</span>(loc,edge75)</span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="характеристики-поверхности-океана" class="section level4">
<h4>Характеристики поверхности океана</h4>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="cf">if</span> (T) {</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>   chlo <span class="ot">&lt;-</span> <span class="st">&#39;изИсходников&#39;</span>(<span class="st">&quot;CHLORA.+</span><span class="sc">\\</span><span class="st">.TIFF$&quot;</span>,<span class="st">&quot;%Y-%m-%d&quot;</span>,<span class="at">nodata=</span><span class="dv">90000</span>,<span class="at">resample=</span><span class="st">&quot;near&quot;</span>)</span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>   loc<span class="sc">$</span>chlo <span class="ot">&lt;-</span> <span class="fu">environ</span>(loc,chlo,<span class="dv">300</span>)</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>   salt <span class="ot">&lt;-</span> <span class="st">&#39;изИсходников&#39;</span>(<span class="st">&quot;salt.+</span><span class="sc">\\</span><span class="st">.tif$&quot;</span>,<span class="st">&quot;%y%m%d&quot;</span>,<span class="at">nodata=</span><span class="dv">0</span>,<span class="at">resample=</span><span class="st">&quot;near&quot;</span>)</span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>   loc<span class="sc">$</span>salt <span class="ot">&lt;-</span> <span class="fu">environ</span>(loc,salt,<span class="dv">200</span>)</span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a>   temp <span class="ot">&lt;-</span> <span class="st">&#39;изИсходников&#39;</span>(<span class="st">&quot;temp.+</span><span class="sc">\\</span><span class="st">.tif$&quot;</span>,<span class="st">&quot;%y%m%d&quot;</span>,<span class="at">nodata=</span><span class="cn">NA</span>,<span class="at">resample=</span><span class="st">&quot;near&quot;</span>)</span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>   loc<span class="sc">$</span>temp <span class="ot">&lt;-</span> <span class="fu">environ</span>(loc,temp,<span class="dv">100</span>)</span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
</div>
<div id="построение-модели" class="section level2">
<h2>Построение модели</h2>
<p>В модели не используются пространственный координаты, поэтому их отсекаем.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>da <span class="ot">&lt;-</span> <span class="fu">spatial_data</span>(loc)</span></code></pre></div>
<p>Если захочется сохранить таблицу с находками, псевдонаходками и предикторами, то установить <code>needToSaveThisData</code> в <code>TRUE</code>. Суффиксом указано значение <code>seed</code>, на основе которого задан генератор псевдослучайных чисел. Чтобы сохранить предикторы, использовать функцию <code>ursa_write()</code>, которая есть в пакете <strong><code>ursa</code></strong>. В имени файла указать расширение <code>*.tif</code> (один многослойный растр) или <code>*.zip</code> (архив однослойных растров).</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="cf">if</span> (needToSaveThisData <span class="ot">&lt;-</span> <span class="cn">FALSE</span>) {</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>   <span class="fu">write.table</span>(da,<span class="fu">paste0</span>(<span class="st">&quot;balaena&quot;</span>,seed,<span class="st">&quot;.csv&quot;</span>),<span class="at">row.names=</span><span class="cn">FALSE</span>,<span class="at">quote=</span><span class="cn">FALSE</span>,<span class="at">sep=</span><span class="st">&quot;;&quot;</span>,<span class="at">dec=</span><span class="st">&quot;.&quot;</span>)</span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>  <span class="co"># ursa_write(conc,&quot;conc.tif&quot;)</span></span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>  <span class="co"># ursa_write(conc,&quot;conc.zip&quot;)</span></span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>}</span></code></pre></div>
<p>И даты тоже не нужны.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a>da<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<p>Уберем стоки, в которых есть <code>NA</code>. Это, по-моему, из-за хлорофилла. Если не подгружать хлорофилл, то строчки останутся, но в модели будет на один предиктор меньше.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="co"># da &lt;- da[!apply(da,1,anyNA),]</span></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a><span class="fu">summary</span>(da)</span></code></pre></div>
<pre><code>       pa             gebco           dist2land           conc           edge15             chlo        
 Min.   :0.0000   Min.   :-3467.0   Min.   : 3.162   Min.   :  0.0   Min.   :-20.506   Min.   : 0.0297  
 1st Qu.:0.0000   1st Qu.: -349.0   1st Qu.: 6.687   1st Qu.:  0.0   1st Qu.: -7.746   1st Qu.: 0.2524  
 Median :0.0000   Median : -218.0   Median : 9.516   Median :  0.0   Median : -4.472   Median : 0.5657  
 Mean   :0.3931   Mean   : -380.5   Mean   : 9.895   Mean   : 25.2   Mean   : -1.992   Mean   : 1.3176  
 3rd Qu.:1.0000   3rd Qu.: -105.0   3rd Qu.:13.038   3rd Qu.: 40.0   3rd Qu.:  4.472   3rd Qu.: 1.5517  
 Max.   :1.0000   Max.   :   -7.0   Max.   :21.996   Max.   :100.0   Max.   : 32.374   Max.   :13.3107  
                                                                                       NA&#39;s   :15       
      salt            temp        
 Min.   :24.92   Min.   :-2.0266  
 1st Qu.:32.59   1st Qu.:-1.6984  
 Median :34.00   Median : 0.1612  
 Mean   :33.27   Mean   : 0.5542  
 3rd Qu.:34.50   3rd Qu.: 1.5873  
 Max.   :34.95   Max.   : 8.7696  
                                  </code></pre>
<div id="glm" class="section level3">
<h3>GLM</h3>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(pa<span class="sc">~</span>.,<span class="at">data=</span>da)</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code></pre></div>
<pre><code>
Call:
glm(formula = pa ~ ., data = da)

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept) -1.389e+00  8.501e-01  -1.634  0.10429   
gebco       -6.256e-05  6.668e-05  -0.938  0.34964   
dist2land   -2.979e-02  1.017e-02  -2.929  0.00393 **
conc        -6.508e-03  2.130e-03  -3.055  0.00266 **
edge15       3.807e-03  1.026e-02   0.371  0.71110   
chlo         3.322e-02  2.327e-02   1.428  0.15539   
salt         6.665e-02  2.407e-02   2.769  0.00633 **
temp        -3.982e-02  1.943e-02  -2.050  0.04215 * 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for gaussian family taken to be 0.1766972)

    Null deviance: 38.076  on 157  degrees of freedom
Residual deviance: 26.505  on 150  degrees of freedom
  (15 observations deleted due to missingness)
AIC: 184.31

Number of Fisher Scoring iterations: 2</code></pre>
</div>
<div id="lm" class="section level3">
<h3>LM</h3>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pa<span class="sc">~</span>.,<span class="at">data=</span>da)</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code></pre></div>
<pre><code>
Call:
lm(formula = pa ~ ., data = da)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.80597 -0.34251 -0.02026  0.28475  0.96942 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept) -1.389e+00  8.501e-01  -1.634  0.10429   
gebco       -6.256e-05  6.668e-05  -0.938  0.34964   
dist2land   -2.979e-02  1.017e-02  -2.929  0.00393 **
conc        -6.508e-03  2.130e-03  -3.055  0.00266 **
edge15       3.807e-03  1.026e-02   0.371  0.71110   
chlo         3.322e-02  2.327e-02   1.428  0.15539   
salt         6.665e-02  2.407e-02   2.769  0.00633 **
temp        -3.982e-02  1.943e-02  -2.050  0.04215 * 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.4204 on 150 degrees of freedom
  (15 observations deleted due to missingness)
Multiple R-squared:  0.3039,    Adjusted R-squared:  0.2714 
F-statistic: 9.355 on 7 and 150 DF,  p-value: 1.352e-09</code></pre>
</div>
<div id="логистическая-линейная" class="section level3">
<h3>Логистическая линейная</h3>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">try</span>(<span class="fu">nls</span>(pa<span class="sc">~</span><span class="fu">exp</span>(a0<span class="sc">+</span></span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a>                  a_conc<span class="sc">*</span>conc<span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a>                  a_gebco<span class="sc">*</span>gebco<span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>                  a_dist2land<span class="sc">*</span>dist2land<span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a>                  a_edge15<span class="sc">*</span>edge15<span class="sc">+</span></span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a>                  a_salt<span class="sc">*</span>salt<span class="sc">+</span></span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a>                  a_temp<span class="sc">*</span>temp<span class="sc">+</span></span>
<span id="cb45-8"><a href="#cb45-8" tabindex="-1"></a>                 <span class="co"># a_chlo*chlo+</span></span>
<span id="cb45-9"><a href="#cb45-9" tabindex="-1"></a>                  <span class="dv">0</span>)</span>
<span id="cb45-10"><a href="#cb45-10" tabindex="-1"></a>          ,<span class="at">data=</span>da</span>
<span id="cb45-11"><a href="#cb45-11" tabindex="-1"></a>          ,<span class="at">start=</span><span class="fu">list</span>(<span class="at">a0=</span><span class="fl">1e-4</span></span>
<span id="cb45-12"><a href="#cb45-12" tabindex="-1"></a>                     ,<span class="at">a_conc=</span><span class="fl">1e-4</span></span>
<span id="cb45-13"><a href="#cb45-13" tabindex="-1"></a>                     ,<span class="at">a_gebco=</span><span class="fl">1e-4</span></span>
<span id="cb45-14"><a href="#cb45-14" tabindex="-1"></a>                     ,<span class="at">a_dist2land=</span><span class="fl">1e-4</span></span>
<span id="cb45-15"><a href="#cb45-15" tabindex="-1"></a>                     ,<span class="at">a_edge15=</span><span class="fl">1e-4</span></span>
<span id="cb45-16"><a href="#cb45-16" tabindex="-1"></a>                     ,<span class="at">a_salt=</span><span class="fl">1e-4</span></span>
<span id="cb45-17"><a href="#cb45-17" tabindex="-1"></a>                     ,<span class="at">a_temp=</span><span class="fl">1e-4</span></span>
<span id="cb45-18"><a href="#cb45-18" tabindex="-1"></a>                    <span class="co"># ,a_chlo=1e-4</span></span>
<span id="cb45-19"><a href="#cb45-19" tabindex="-1"></a>                     )</span>
<span id="cb45-20"><a href="#cb45-20" tabindex="-1"></a>          ,<span class="at">control=</span><span class="fu">nls.control</span>(<span class="at">maxiter=</span><span class="dv">150</span>)</span>
<span id="cb45-21"><a href="#cb45-21" tabindex="-1"></a>          ))</span>
<span id="cb45-22"><a href="#cb45-22" tabindex="-1"></a><span class="fu">summary</span>(m3)</span></code></pre></div>
<pre><code>
Formula: pa ~ exp(a0 + a_conc * conc + a_gebco * gebco + a_dist2land * 
    dist2land + a_edge15 * edge15 + a_salt * salt + a_temp * 
    temp + 0)

Parameters:
              Estimate Std. Error t value Pr(&gt;|t|)   
a0          -8.8916879  2.8859585  -3.081  0.00242 **
a_conc      -0.0160572  0.0071708  -2.239  0.02647 * 
a_gebco     -0.0001256  0.0003571  -0.352  0.72543   
a_dist2land -0.0763516  0.0314697  -2.426  0.01633 * 
a_edge15     0.0051006  0.0353632   0.144  0.88549   
a_salt       0.2673671  0.0847189   3.156  0.00190 **
a_temp      -0.1591768  0.0595640  -2.672  0.00828 **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.4154 on 166 degrees of freedom

Number of iterations to convergence: 82 
Achieved convergence tolerance: 9.487e-06</code></pre>
</div>
</div>
<div id="предсказание" class="section level2">
<h2>Предсказание</h2>
<p>Выберем одну из моделей, например, <code>m3</code></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a>opW <span class="ot">&lt;-</span> <span class="fu">options</span>(<span class="at">warn=</span><span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a>cname <span class="ot">&lt;-</span> <span class="fu">names</span>(conc)</span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a>preferred <span class="ot">&lt;-</span> <span class="fu">ursa</span>(<span class="at">bandname=</span>cname,<span class="at">nodata=</span><span class="sc">-</span><span class="dv">99</span>)</span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(conc) <span class="sc">|&gt;</span> <span class="fu">sample</span>()) {</span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a>   j <span class="ot">&lt;-</span> <span class="fu">matchDate</span>(salt,cname[i])</span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a>   b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">result=</span><span class="fu">ursa</span>()</span>
<span id="cb47-7"><a href="#cb47-7" tabindex="-1"></a>         ,<span class="at">gebco=</span>gebco</span>
<span id="cb47-8"><a href="#cb47-8" tabindex="-1"></a>         ,<span class="at">dist2land=</span>dist2land</span>
<span id="cb47-9"><a href="#cb47-9" tabindex="-1"></a>         ,<span class="at">conc=</span>conc[cname[i]]</span>
<span id="cb47-10"><a href="#cb47-10" tabindex="-1"></a>         ,<span class="at">edge15=</span>edge15[cname[i]]</span>
<span id="cb47-11"><a href="#cb47-11" tabindex="-1"></a>         ,<span class="at">salt=</span>salt[<span class="fu">matchDate</span>(salt,cname[i])]</span>
<span id="cb47-12"><a href="#cb47-12" tabindex="-1"></a>         ,<span class="at">temp=</span>temp[<span class="fu">matchDate</span>(temp,cname[i])]</span>
<span id="cb47-13"><a href="#cb47-13" tabindex="-1"></a>         ,<span class="at">chlo=</span>chlo[<span class="fu">matchDate</span>(chlo,cname[i])]</span>
<span id="cb47-14"><a href="#cb47-14" tabindex="-1"></a>         )</span>
<span id="cb47-15"><a href="#cb47-15" tabindex="-1"></a>   p <span class="ot">&lt;-</span> <span class="fu">try</span>(<span class="fu">predict</span>(m3,<span class="at">newdata=</span><span class="fu">as.data.frame</span>(b)))</span>
<span id="cb47-16"><a href="#cb47-16" tabindex="-1"></a>   <span class="cf">if</span> (<span class="fu">inherits</span>(p,<span class="st">&quot;try-error&quot;</span>))</span>
<span id="cb47-17"><a href="#cb47-17" tabindex="-1"></a>      <span class="cf">next</span></span>
<span id="cb47-18"><a href="#cb47-18" tabindex="-1"></a>   preferred[i] <span class="ot">&lt;-</span> p</span>
<span id="cb47-19"><a href="#cb47-19" tabindex="-1"></a>}</span>
<span id="cb47-20"><a href="#cb47-20" tabindex="-1"></a><span class="fu">options</span>(opW)</span>
<span id="cb47-21"><a href="#cb47-21" tabindex="-1"></a>preferred <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code></pre></div>
<pre><code>           name     mean        sd     sum         min      max     n  nNA
[01] 2015-05-14 0.267924 0.1984181 4074.05 0.013750920 1.379196 15206 4450
[02] 2015-08-27 0.239543 0.1362627 3842.99 0.001596471 1.010491 16043 3613
[03] 2015-10-18 0.334859 0.2065778 5324.59 0.002788165 1.289254 15901 3755
[04] 2016-09-18 0.262815 0.1452488 4220.28 0.000210802 1.063287 16058 3598
[05] 2016-09-26 0.278994 0.1721685 4482.32 0.000271837 1.100844 16066 3590
[06] 2017-08-26 0.253834 0.1351478 4064.89 0.000696563 0.768951 16014 3642
[07] 2017-09-29 0.318835 0.1914427 5089.24 0.001742193 1.219975 15962 3694
[08] 2019-05-25 0.279898 0.1951928 4270.96 0.013156507 1.629628 15259 4397
[09] 2019-05-29 0.265185 0.1891428 4040.89 0.006834633 1.283023 15238 4418
[10] 2019-05-31 0.275340 0.1882625 4190.12 0.009196532 1.322038 15218 4438
[11] 2019-06-01 0.271068 0.1865865 4115.08 0.007779874 1.174125 15181 4475
[12] 2019-06-05 0.264593 0.1731290 4037.42 0.008742157 1.079309 15259 4397
[13] 2023-07-22 0.173835 0.1076962 2731.47 0.000259737 0.672277 15713 3943
[14] 2023-07-27 0.158052 0.0974415 2492.47 0.000182422 0.642313 15770 3886
[15] 2023-08-09 0.163011 0.0979155 2609.31 0.000162895 0.628242 16007 3649</code></pre>
<p class="centered-image"><img src="assets/ursa60_unnamed-chunk-40.png" width="1229" /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>R version 4.3.3 Patched (2024-02-29 r86034 ucrt)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19045)

Matrix products: default


locale:
[1] LC_COLLATE=English_United Kingdom.utf8  LC_CTYPE=English_United Kingdom.utf8   
[3] LC_MONETARY=English_United Kingdom.utf8 LC_NUMERIC=C                           
[5] LC_TIME=English_United Kingdom.utf8    

time zone: Europe/Moscow
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] ursa_3.11.0-1078

loaded via a namespace (and not attached):
 [1] sass_0.4.8              utf8_1.2.4              generics_0.1.3          tcltk_4.3.3            
 [5] class_7.3-22            KernSmooth_2.23-22      lattice_0.22-5          digest_0.6.34          
 [9] magrittr_2.0.3          evaluate_0.23           grid_4.3.3              plutil_0.9-7312        
[13] fastmap_1.1.1           jsonlite_1.8.8          e1071_1.7-14            DBI_1.2.2              
[17] fansi_1.0.6             crosstalk_1.2.1         CircStats_0.2-6         jquerylib_0.1.4        
[21] ade4_1.7-22             cli_3.6.2               rlang_1.1.3             units_0.8-5            
[25] cachem_1.0.8            yaml_2.3.8              tools_4.3.3             dplyr_1.1.4            
[29] locfit_1.5-9.9          boot_1.3-30             png_0.1-8               adehabitatHR_0.4.21    
[33] vctrs_0.6.5             R6_2.5.1                proxy_0.4-27            lifecycle_1.0.4        
[37] classInt_0.4-10         leaflet_2.2.1           adehabitatMA_0.3.16     leaflet.providers_2.0.0
[41] htmlwidgets_1.6.4       MASS_7.3-60.0.1         adehabitatLT_0.3.27     pkgconfig_2.0.3        
[45] xaringanExtra_0.7.0     pillar_1.9.0            bslib_0.6.1             glue_1.7.0             
[49] Rcpp_1.0.12             sf_1.0-15               systemfonts_1.0.5       highr_0.10             
[53] xfun_0.42               tibble_3.2.1            tidyselect_1.2.0        knitr_1.45             
[57] htmltools_0.5.7         rmarkdown_2.25          svglite_2.1.3           compiler_4.3.3         
[61] sp_2.1-3               </code></pre>
</div>



<!-- code folding -->



</body>
</html>
