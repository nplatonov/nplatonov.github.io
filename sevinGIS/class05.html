<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>ГИС 05</title>
    <meta charset="utf-8" />
    <script src="https://nplatonov.github.io/site_libs/header-attrs-2.20/header-attrs.js"></script>
    <link href="https://nplatonov.github.io/site_libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="https://nplatonov.github.io/site_libs/remark-css-0.0.1/hygge.css" rel="stylesheet" />
    <link href="https://nplatonov.github.io/site_libs/tile-view-0.2.6/tile-view.css" rel="stylesheet" />
    <script src="https://nplatonov.github.io/site_libs/tile-view-0.2.6/tile-view.js"></script>
    <link href="https://nplatonov.github.io/site_libs/animate.css-3.7.2/animate.xaringan.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://nplatonov.github.io/site_libs/common.css" type="text/css" />
    <link rel="stylesheet" href="https://nplatonov.github.io/site_libs/moon_reader.css" type="text/css" />
    <link rel="stylesheet" href="https://nplatonov.github.io/site_libs/moon_reader-fonts.css" type="text/css" />
  </head>
  <body>
<style>
.remark-backdrop:after{
   content: 'Никита Платонов \A \A [Online Code Editor](https://rdrr.io/snippets/)

[ГИС аспирантура](class.html#home)';
}
:root {--pointsize: 22pt;}
</style>

    <textarea id="source">

layout: true







.banner[

.shorttitle[
[Online Code Editor](https://rdrr.io/snippets/)

[ГИС аспирантура](class.html#home)
]

]

---
class: metadata customtitle middle left
name: H3216
<iframe width='220' height='220' class='timenow' src='https://www.timeanddate.com/worldclock/fullscreen.html?n=1440' frameborder='0' allow='encrypted-media' allowfullscreen></iframe>

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[





.author[Никита&nbsp;Платонов]


.institute[с.н.с. ИПЭЭ РАН]




.title[Возможности R для работы с пространственными данными]


.subtitle[ГИС технологии в биологических исследованиях]


.what[Занятие 05]


.where[]


.when[30 марта 2023 г. .updated[Обновлено: 2023-03-22 17:40]]












]
---

name: H83cb

.sidebar.left-column[
## [Основы R](#H83cb).fg[]
### [Установка R](#H83cb).fg[]
#### [Oперационные системы](#H83cb).fg[].bg[]
#### [Базовый R](#Hc1dc)
#### [Библиотеки](#Hecc3)
#### [Дополнительное ПО](#H1d16)
#### [Как использовать материал](#Hb635)
### [Начало работы](#H8c3e)
### [Представление данных](#H000b)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[


Не для всех операционных систем есть скомпилированные модули (ядро R, библиотеки). В таком случае модули компилируются, и на это уходит какое-то время. Поэтому если ОС не OS Windows, то этот этап нужно пройти заранее.


]
---

name: Hc1dc

.sidebar.left-column[
## [Основы R](#H83cb).fg[]
### [Установка R](#H83cb).fg[]
#### [Oперационные системы](#H83cb)
#### [Базовый R](#Hc1dc).fg[].bg[]
#### [Библиотеки](#Hecc3)
#### [Дополнительное ПО](#H1d16)
#### [Как использовать материал](#Hb635)
### [Начало работы](#H8c3e)
### [Представление данных](#H000b)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[


Установить или обновить R, например, [отсюда](https://cran.rstudio.org/). Актуальная версия 4.2.3. Не ниже версии 4.0.


]
---

name: Hecc3

.sidebar.left-column[
## [Основы R](#H83cb).fg[]
### [Установка R](#H83cb).fg[]
#### [Oперационные системы](#H83cb)
#### [Базовый R](#Hc1dc)
#### [Библиотеки](#Hecc3) <span class="bullet bullet-active">[&#8226;](#Hecc3)</span><span class="bullet mslide9m">[&#8226;](#Ha5c4)</span>.fg[].bg[]
#### [Дополнительное ПО](#H1d16)
#### [Как использовать материал](#Hb635)
### [Начало работы](#H8c3e)
### [Представление данных](#H000b)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[




```r
pkgList <- c("rgdal","sf","raster","ggplot2","leaflet","mapview"
            ,"mapedit","knitr","rmarkdown","jpeg","png","ursa","tmap")
whoisready <- sapply(pkgList,function(pkg) {
   if (requireNamespace(pkg))
      return(TRUE)
   install.packages(pkg,repos="https://cran.rstudio.com")
   requireNamespace(pkg)
})
```

```
## Loading required namespace: rgdal
```

```
## Loading required namespace: sf
```

```
## Loading required namespace: raster
```

```
## Loading required namespace: ggplot2
```

```
## Loading required namespace: leaflet
```

```
## Loading required namespace: mapview
```

```
## Loading required namespace: mapedit
```

```
## Loading required namespace: jpeg
```

```
## Loading required namespace: tmap
```



]
---

name: Ha5c4

.sidebar.left-column[
## [Основы R](#H83cb).fg[]
### [Установка R](#H83cb).fg[]
#### [Oперационные системы](#H83cb)
#### [Базовый R](#Hc1dc)
#### [Библиотеки](#Hecc3) <span class="bullet bullet">[&#8226;](#Hecc3)</span><span class="bullet bullet-active">[&#8226;](#Ha5c4)</span>.fg[].bg[]
#### [Дополнительное ПО](#H1d16)
#### [Как использовать материал](#Hb635)
### [Начало работы](#H8c3e)
### [Представление данных](#H000b)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
whoisready
```

```
##     rgdal        sf    raster   ggplot2   leaflet   mapview   mapedit     knitr 
##      TRUE      TRUE      TRUE      TRUE      TRUE      TRUE      TRUE      TRUE 
## rmarkdown      jpeg       png      ursa      tmap 
##      TRUE      TRUE      TRUE      TRUE      TRUE
```


Если отображается `TRUE` для всех библиотек, то подготовка к занятию осуществлена успешно.


```r
c('Everything is ready?'=all(whoisready))
```

```
## Everything is ready? 
##                 TRUE
```


Если где-то выскочило `FALSE` (например, для библиотеки "foo"), то можно попробовать его установить заново функцией `install.packages("foo")`.




]
---
class: middle center
name: H1d16

.sidebar.left-column[
## [Основы R](#H83cb).fg[]
### [Установка R](#H83cb).fg[]
#### [Oперационные системы](#H83cb)
#### [Базовый R](#Hc1dc)
#### [Библиотеки](#Hecc3)
#### [Дополнительное ПО](#H1d16).fg[]
##### [RStudio IDE](#H1d16).fg[].bg[]
##### [Pandoc](#Hb506)
##### [Jupyter](#H27af)
#### [Как использовать материал](#Hb635)
### [Начало работы](#H8c3e)
### [Представление данных](#H000b)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[




<sup>факультативно</sup>





]
---

name: Hb506

.sidebar.left-column[
## [Основы R](#H83cb).fg[]
### [Установка R](#H83cb).fg[]
#### [Oперационные системы](#H83cb)
#### [Базовый R](#Hc1dc)
#### [Библиотеки](#Hecc3)
#### [Дополнительное ПО](#H1d16).fg[]
##### [RStudio IDE](#H1d16)
##### [Pandoc](#Hb506).fg[].bg[]
##### [Jupyter](#H27af)
#### [Как использовать материал](#Hb635)
### [Начало работы](#H8c3e)
### [Представление данных](#H000b)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[

.font90[
Pandoc необходим для создания воспроизводимого результата. Этот шаг опциональный, и может быть пропущен, но в этом случае на занятии будет пропущен раздел по [публикации результатов](#report1).

[Ссылка](https://pandoc.org/installing.html) на страницу для скачивания. Для пользователей Windows достаточно перейти к [скачиванию актуального релиза](https://github.com/jgm/pandoc/releases/latest), и выбрать либо установщик (`*.msi`), либо архив (`*.zip`). Запомнить путь, куда произведена установка и где находится файл `pandoc.exe` и добавить этот путь в переменную окружения `%PATH%`, например: WindowsKey+Q, ввести "Переменные среды/Environment Variables", попасть в окошко "Свойства Системы/System Properties", нажать на кнопку "Переменные среды/Environment Variables" и отредактировать пользовательскую или системную переменную PATH, добавив путь к `pandoc.exe`.

Чтобы проверить правильно ли установлен Pandoc, в новой R-сессии:



```r
rmarkdown::pandoc_available()
```

```
## [1] TRUE
```

]

]
---

name: H27af

.sidebar.left-column[
## [Основы R](#H83cb).fg[]
### [Установка R](#H83cb).fg[]
#### [Oперационные системы](#H83cb)
#### [Базовый R](#Hc1dc)
#### [Библиотеки](#Hecc3)
#### [Дополнительное ПО](#H1d16).fg[]
##### [RStudio IDE](#H1d16)
##### [Pandoc](#Hb506)
##### [Jupyter](#H27af).fg[].bg[]
#### [Как использовать материал](#Hb635)
### [Начало работы](#H8c3e)
### [Представление данных](#H000b)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[


Jupyter Notebook для работы с R кодом в браузере.

1. [Загрузить](https://docs.conda.io/en/latest/miniconda.html) и установить менеджер Miniconda (проверено на Windows 64bit Python 3.7).

2. Запустить `conda` (На Windows попробовать WinKey+Q и начать вводить "Anaconda")

3. Последовательно выполнить команды (в среде Conda, не в среде R):

Команда | Описание
---|---
`conda install jupyter` | установка Jupyter Notebook
`conda install -c r r-recommended r-irkernel` | Установка R, базовых библиотек и библиотеки для использования R в Jupyter Notebook
`conda install -c conda-forge jupytext` | Установка преобразователя кода R в формат Jupyter Notebook








]
---

name: Hb635

.sidebar.left-column[
## [Основы R](#H83cb).fg[]
### [Установка R](#H83cb).fg[]
#### [Oперационные системы](#H83cb)
#### [Базовый R](#Hc1dc)
#### [Библиотеки](#Hecc3)
#### [Дополнительное ПО](#H1d16)
#### [Как использовать материал](#Hb635).fg[].bg[]
### [Начало работы](#H8c3e)
### [Представление данных](#H000b)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[


Предполагается, что во время занятий будет использоваться интерактивный режим: либо простая среда R (R, запущенный без команд), либо графическая среда R GUI, либо RStudio.

Блок исходного кода выделен моноширинным шрифтом с подсветкой синтаксиса, после которого либо приведен текстовый вывод (более бледный цвет шрифта), либо графический вывод (рисунок, таблица). В среде R нужно вводить код из верхнего блока и сравнивать полученный вывод с содержимым нижнего блока.

К примеру, ниже приведен пример вывода числа `\(\pi\)`: сверху – команда, снизу – выход. 



```r
pi
```

```
## [1] 3.141593
```



]
---

name: H8c3e

.sidebar.left-column[
## [Основы R](#H83cb).fg[]
### [Установка R](#H83cb)
### [Начало работы](#H8c3e) <span class="bullet bullet-active">[&#8226;](#H8c3e)</span><span class="bullet mslide17m">[&#8226;](#H57e7)</span>.fg[].bg[]
### [Представление данных](#H000b)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[


Текущий путь, где мы находимся. Здесь появятся файлы, созданные в процессе занятия.


```r
getwd()
```

```
## [1] "C:/platt/education/202204-GIS"
```

Его можно поменять через меню RGui/RStudio или с помощью `setwd()`.

Зафиксируем генератор псевдослучайных чисел на определенную последовательность



```r
set.seed(353)
sample(10)
```

```
##  [1]  2  7 10  6  4  1  3  9  5  8
```



]
---

name: H57e7

.sidebar.left-column[
## [Основы R](#H83cb).fg[]
### [Установка R](#H83cb)
### [Начало работы](#H8c3e) <span class="bullet bullet">[&#8226;](#H8c3e)</span><span class="bullet bullet-active">[&#8226;](#H57e7)</span>.fg[].bg[]
### [Представление данных](#H000b)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[

.font90[
Команда для проверки кириллицы:


```r
print(c('Здесь кириллица?'="Да!"),quote=FALSE)
```

```
## Здесь кириллица? 
##              Да!
```


Если вывод не читаемый, то возможные пути решения:

1\. Задать кириллицу для символьной локали:



```r
if (.Platform$OS.type=="windows")
   Sys.setlocale("LC_CTYPE","Russian")
```

```
## Warning in Sys.setlocale("LC_CTYPE", "Russian"): using locale code page other
## than 65001 ("UTF-8") may cause problems
```


2\. Если скрипты подключаются через `source()`, то можно настроить запуск R через конфигурационные файлы. Например, скачать [.Rprofile](./.Rprofile), разместить в рабочей директории, перегрузить R. Файл имеет следующую структуру:

     local({
        options(encoding="UTF-8")
        Sys.setlocale("LC_CTYPE","Russian")
     })

3\. Если скрипт `bar.R` с кириллицей в кодировке UTF-8 запускается из командной строки, то использовать следующие параметры запуска.
   
     R --encoding UTF-8 -f bar.R
]






]
---

name: H000b

.sidebar.left-column[
## [Основы R](#H83cb).fg[]
### [Установка R](#H83cb)
### [Начало работы](#H8c3e)
### [Представление данных](#H000b).fg[]
#### [Простые типы](#H000b).fg[]
##### [Числа и имена значений](#H000b).fg[].bg[]
##### [Целые числа, числа с плавающей точкой](#H929d)
##### [Логические значения, строки](#H8278)
#### [Составные типы](#Hf45b)
#### [Матрицы](#H08d5)
#### [Массивы](#H6b97)
#### [Факторы](#H9e7e)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
(a1 <- seq(7))
```

```
## [1] 1 2 3 4 5 6 7
```

```r
str(a1)
```

```
##  int [1:7] 1 2 3 4 5 6 7
```

```r
a2 <- a1
names(a2) <- format(Sys.Date()+a1-1,"%A")
a2
```

```
## Wednesday  Thursday    Friday  Saturday    Sunday    Monday   Tuesday 
##         1         2         3         4         5         6         7
```

```r
str(a2)
```

```
##  Named int [1:7] 1 2 3 4 5 6 7
##  - attr(*, "names")= chr [1:7] "Wednesday" "Thursday" "Friday" "Saturday" ...
```



]
---

name: H929d

.sidebar.left-column[
## [Основы R](#H83cb).fg[]
### [Установка R](#H83cb)
### [Начало работы](#H8c3e)
### [Представление данных](#H000b).fg[]
#### [Простые типы](#H000b).fg[]
##### [Числа и имена значений](#H000b)
##### [Целые числа, числа с плавающей точкой](#H929d).fg[].bg[]
##### [Логические значения, строки](#H8278)
#### [Составные типы](#Hf45b)
#### [Матрицы](#H08d5)
#### [Массивы](#H6b97)
#### [Факторы](#H9e7e)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
str(a2+0L)
```

```
##  Named int [1:7] 1 2 3 4 5 6 7
##  - attr(*, "names")= chr [1:7] "Wednesday" "Thursday" "Friday" "Saturday" ...
```

```r
str(a2+0)
```

```
##  Named num [1:7] 1 2 3 4 5 6 7
##  - attr(*, "names")= chr [1:7] "Wednesday" "Thursday" "Friday" "Saturday" ...
```

```r
typeof(a2+0L)
```

```
## [1] "integer"
```

```r
typeof(a2+0)
```

```
## [1] "double"
```



]
---

name: H8278

.sidebar.left-column[
## [Основы R](#H83cb).fg[]
### [Установка R](#H83cb)
### [Начало работы](#H8c3e)
### [Представление данных](#H000b).fg[]
#### [Простые типы](#H000b).fg[]
##### [Числа и имена значений](#H000b)
##### [Целые числа, числа с плавающей точкой](#H929d)
##### [Логические значения, строки](#H8278).fg[].bg[]
#### [Составные типы](#Hf45b)
#### [Матрицы](#H08d5)
#### [Массивы](#H6b97)
#### [Факторы](#H9e7e)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[

 ##### Логические значения


```r
(a3 <- sample(c(TRUE,FALSE),length(a2),replace=TRUE))
```

```
## [1] FALSE FALSE  TRUE FALSE FALSE  TRUE  TRUE
```

```r
class(a3)
```

```
## [1] "logical"
```

```r
str(a3)
```

```
##  logi [1:7] FALSE FALSE TRUE FALSE FALSE TRUE ...
```

 ##### Строки


```r
(a4 <- names(a2))
```

```
## [1] "Wednesday" "Thursday"  "Friday"    "Saturday"  "Sunday"    "Monday"   
## [7] "Tuesday"
```

```r
class(a4)
```

```
## [1] "character"
```

```r
str(a4)
```

```
##  chr [1:7] "Wednesday" "Thursday" "Friday" "Saturday" "Sunday" "Monday" ...
```





]
---

name: Hf45b

.sidebar.left-column[
## [Основы R](#H83cb).fg[]
### [Установка R](#H83cb)
### [Начало работы](#H8c3e)
### [Представление данных](#H000b).fg[]
#### [Простые типы](#H000b)
#### [Составные типы](#Hf45b).fg[]
##### [Списки одинаковой длины](#Hf45b).fg[].bg[]
##### [Таблицы](#H0a21)
##### [Списки различной длины](#Haff2)
#### [Матрицы](#H08d5)
#### [Массивы](#H6b97)
#### [Факторы](#H9e7e)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
(a5 <- list(num=a1[c(1,3:7)],char=a4[-2]))
```

```
## $num
## [1] 1 3 4 5 6 7
## 
## $char
## [1] "Wednesday" "Friday"    "Saturday"  "Sunday"    "Monday"    "Tuesday"
```

```r
str(a5)
```

```
## List of 2
##  $ num : int [1:6] 1 3 4 5 6 7
##  $ char: chr [1:6] "Wednesday" "Friday" "Saturday" "Sunday" ...
```

```r
class(a5)
```

```
## [1] "list"
```

```r
length(a5)
```

```
## [1] 2
```

```r
sapply(a5,length)
```

```
##  num char 
##    6    6
```



]
---

name: H0a21

.sidebar.left-column[
## [Основы R](#H83cb).fg[]
### [Установка R](#H83cb)
### [Начало работы](#H8c3e)
### [Представление данных](#H000b).fg[]
#### [Простые типы](#H000b)
#### [Составные типы](#Hf45b).fg[]
##### [Списки одинаковой длины](#Hf45b)
##### [Таблицы](#H0a21).fg[].bg[]
##### [Списки различной длины](#Haff2)
#### [Матрицы](#H08d5)
#### [Массивы](#H6b97)
#### [Факторы](#H9e7e)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[





```r
(a6 <- data.frame(num=a1[c(1,3:7)],char=a4[-2]))
```

```
##   num      char
## 1   1 Wednesday
## 2   3    Friday
## 3   4  Saturday
## 4   5    Sunday
## 5   6    Monday
## 6   7   Tuesday
```

```r
str(a6)
```

```
## 'data.frame':	6 obs. of  2 variables:
##  $ num : int  1 3 4 5 6 7
##  $ char: chr  "Wednesday" "Friday" "Saturday" "Sunday" ...
```

```r
class(a6)
```

```
## [1] "data.frame"
```

```r
dim(a6)
```

```
## [1] 6 2
```



]
---

name: Haff2

.sidebar.left-column[
## [Основы R](#H83cb).fg[]
### [Установка R](#H83cb)
### [Начало работы](#H8c3e)
### [Представление данных](#H000b).fg[]
#### [Простые типы](#H000b)
#### [Составные типы](#Hf45b).fg[]
##### [Списки одинаковой длины](#Hf45b)
##### [Таблицы](#H0a21)
##### [Списки различной длины](#Haff2).fg[].bg[]
#### [Матрицы](#H08d5)
#### [Массивы](#H6b97)
#### [Факторы](#H9e7e)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[





```r
(a7 <- list(x=sample(a1,3),y=sample(a1,5)))
```

```
## $x
## [1] 7 2 3
## 
## $y
## [1] 7 3 2 4 6
```

```r
str(a7)
```

```
## List of 2
##  $ x: int [1:3] 7 2 3
##  $ y: int [1:5] 7 3 2 4 6
```

```r
class(a7)
```

```
## [1] "list"
```

```r
length(a7)
```

```
## [1] 2
```

```r
sapply(a7,length)
```

```
## x y 
## 3 5
```



]
---

name: H08d5

.sidebar.left-column[
## [Основы R](#H83cb).fg[]
### [Установка R](#H83cb)
### [Начало работы](#H8c3e)
### [Представление данных](#H000b).fg[]
#### [Простые типы](#H000b)
#### [Составные типы](#Hf45b)
#### [Матрицы](#H08d5).fg[].bg[]
#### [Массивы](#H6b97)
#### [Факторы](#H9e7e)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[




```r
(a11 <- matrix(sample(seq(24)),ncol=4,nrow=3))
```

```
## Warning in matrix(sample(seq(24)), ncol = 4, nrow = 3): data length differs
## from size of matrix: [24 != 3 x 4]
```

```
##      [,1] [,2] [,3] [,4]
## [1,]   20   24    6   17
## [2,]    8   23    2   13
## [3,]   22    1   21   10
```

Размерность массива


```r
dim(a11)
```

```
## [1] 3 4
```


Структура данных массива


```r
str(a11)
```

```
##  int [1:3, 1:4] 20 8 22 24 23 1 6 2 21 17 ...
```



]
---

name: H6b97

.sidebar.left-column[
## [Основы R](#H83cb).fg[]
### [Установка R](#H83cb)
### [Начало работы](#H8c3e)
### [Представление данных](#H000b).fg[]
#### [Простые типы](#H000b)
#### [Составные типы](#Hf45b)
#### [Матрицы](#H08d5)
#### [Массивы](#H6b97).fg[].bg[]
#### [Факторы](#H9e7e)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[





```r
(a8 <- array(sample(24),dim=c(3,4,2)))
```

```
## , , 1
## 
##      [,1] [,2] [,3] [,4]
## [1,]   10    4    2   17
## [2,]    9    5   16   19
## [3,]   14   15   18   22
## 
## , , 2
## 
##      [,1] [,2] [,3] [,4]
## [1,]   20   23    7   21
## [2,]   11    6   13   12
## [3,]    3    8   24    1
```

```r
str(a8)
```

```
##  int [1:3, 1:4, 1:2] 10 9 14 4 5 15 2 16 18 17 ...
```

```r
class(a8)
```

```
## [1] "array"
```



]
---

name: H9e7e

.sidebar.left-column[
## [Основы R](#H83cb).fg[]
### [Установка R](#H83cb)
### [Начало работы](#H8c3e)
### [Представление данных](#H000b).fg[]
#### [Простые типы](#H000b)
#### [Составные типы](#Hf45b)
#### [Матрицы](#H08d5)
#### [Массивы](#H6b97)
#### [Факторы](#H9e7e).fg[].bg[]
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
(a9 <- factor(sample(a4),levels=a4))
```

```
## [1] Thursday  Wednesday Friday    Sunday    Saturday  Tuesday   Monday   
## Levels: Wednesday Thursday Friday Saturday Sunday Monday Tuesday
```

```r
str(a9)
```

```
##  Factor w/ 7 levels "Wednesday","Thursday",..: 2 1 3 5 4 7 6
```

```r
class(a9)
```

```
## [1] "factor"
```

```r
(a10 <- factor(sample(a4),levels=a4,ordered=TRUE))
```

```
## [1] Saturday  Sunday    Tuesday   Wednesday Friday    Monday    Thursday 
## 7 Levels: Wednesday < Thursday < Friday < Saturday < Sunday < ... < Tuesday
```

```r
str(a10)
```

```
##  Ord.factor w/ 7 levels "Wednesday"<"Thursday"<..: 4 5 7 1 3 6 2
```

```r
class(a10)
```

```
## [1] "ordered" "factor"
```



]
---

name: Hd6ba

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba).fg[].bg[]
### [Средства визуализации](#Hb85a)
### [Пространст&shy;вен&shy;ные данные](#H2152)
### [По форматам](#H0cf1)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[


+ R устроен так, что можно реализовать сложные структуры данных, со средствами их инспектирования, что вполне применимо для пространственных данных и их метаданных

+ В R есть инструменты для анализа данных

+ В R есть инструменты для визуализации

+ *Как особенность развития до текущего момента*: воспроизводимость реализована лучше интерактивности

+ В R уже многое сделано по манипуляции с пространственными данными: пользователю не обязательно быть разработчиком


]
---

name: Hb85a

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba).fg[]
### [Средства визуализации](#Hb85a).fg[].bg[]
#### [Пример путешествия мимо/через Спб](#H1c3d)
#### [`data(volcano)`](#H51d5)
### [Пространст&shy;вен&shy;ные данные](#H2152)
### [По форматам](#H0cf1)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[


Базовые средства R для визуализации (библиотека `graphics`) пространственных данных:

+ `points()` – отображение точек (геометрия POINT)

+ `lines()`, `segments()`, `contour()` – отображение линий (геометрия LINESTRING)

+ `polygon()`, `polypath()` – отображение полигонов (геометрия POLYGON)

+ `image()`, `rasterImage()` – растровые изображения

+ `text()`, `legend()` – аннотациии

+ `axis()`, `mtext()` – рамочное оформление


]
---

name: H1c3d

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba).fg[]
### [Средства визуализации](#Hb85a).fg[]
#### [Пример путешествия мимо/через Спб](#H1c3d) <span class="bullet bullet-active">[&#8226;](#H1c3d)</span><span class="bullet mslide36m">[&#8226;](#H12d6)</span><span class="bullet mslide37m">[&#8226;](#H65d1)</span>.fg[].bg[]
#### [`data(volcano)`](#H51d5)
### [Пространст&shy;вен&shy;ные данные](#H2152)
### [По форматам](#H0cf1)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[




```r
n <- 60
seqx <- seq(20,40,by=5)
seqy <- seq(55,65,by=2)
x <- sort(runif(n,min=min(seqx),max=max(seqx)))
y <- sort(runif(n,min=min(seqy),max=max(seqy)))
```



]
---

name: H12d6

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba).fg[]
### [Средства визуализации](#Hb85a).fg[]
#### [Пример путешествия мимо/через Спб](#H1c3d) <span class="bullet bullet">[&#8226;](#H1c3d)</span><span class="bullet bullet-active">[&#8226;](#H12d6)</span><span class="bullet mslide37m">[&#8226;](#H65d1)</span>.fg[].bg[]
#### [`data(volcano)`](#H51d5)
### [Пространст&shy;вен&shy;ные данные](#H2152)
### [По форматам](#H0cf1)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[




```r
plot(x,y,type="n",asp=NA,axes=FALSE,xlab="",ylab="")
lines(x,y,lwd=4,col="black")
lines(x,y,lwd=3,col="orange")
box()
axis(1,at=seqx,lab=paste0(seqx,"°E"),lwd=0,lwd.ticks=1,las=1)
axis(2,at=seqy,lab=paste0(seqy,"°N"),lwd=0,lwd.ticks=1,las=1)
```

<img src="assets/lesson05/spb1-1.svg" width="600px" height="450px" style="display: block; margin: auto;" />


]
---

name: H65d1

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba).fg[]
### [Средства визуализации](#Hb85a).fg[]
#### [Пример путешествия мимо/через Спб](#H1c3d) <span class="bullet bullet">[&#8226;](#H1c3d)</span><span class="bullet bullet">[&#8226;](#H12d6)</span><span class="bullet bullet-active">[&#8226;](#H65d1)</span>.fg[].bg[]
#### [`data(volcano)`](#H51d5)
### [Пространст&shy;вен&shy;ные данные](#H2152)
### [По форматам](#H0cf1)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[




```r
e <- sf::st_sfc(sf::st_linestring(cbind(x,y)),crs=4326)
ursa::session_grid(NULL)
ursa::glance(e,blank="white",coast.fill="#00000010",pointsize=12
            ,col="black",plot.lwd=5)
```

<img src="assets/lesson05//ursa01_spb2.png" width="1330" height="500" style="display: block; margin: auto;" />



]
---

name: H51d5

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba).fg[]
### [Средства визуализации](#Hb85a).fg[]
#### [Пример путешествия мимо/через Спб](#H1c3d)
#### [`data(volcano)`](#H51d5) <span class="bullet bullet-active">[&#8226;](#H51d5)</span><span class="bullet mslide40m">[&#8226;](#Hb4f4)</span>.fg[].bg[]
### [Пространст&shy;вен&shy;ные данные](#H2152)
### [По форматам](#H0cf1)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[






```r
image(volcano)
```

<img src="assets/lesson05/imgvolcano-1.svg" width="1330" height="568" style="display: block; margin: auto;" />



]
---

name: Hb4f4

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba).fg[]
### [Средства визуализации](#Hb85a).fg[]
#### [Пример путешествия мимо/через Спб](#H1c3d)
#### [`data(volcano)`](#H51d5) <span class="bullet bullet">[&#8226;](#H51d5)</span><span class="bullet bullet-active">[&#8226;](#Hb4f4)</span>.fg[].bg[]
### [Пространст&shy;вен&shy;ные данные](#H2152)
### [По форматам](#H0cf1)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[


Это вулкан Maunga Whau (Mt Eden).




```r
ursa:::spatialize("Mount Eden",place="park",style="web") |>
   ursa::glance(basemap.alpha=1,style="mapnik")
```

<img src="assets/lesson05//ursa03_glancevolcano.png" width="1330" height="550" style="display: block; margin: auto;" />






]
---

name: H2152

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba).fg[]
### [Средства визуализации](#Hb85a)
### [Пространст&shy;вен&shy;ные данные](#H2152).fg[]
#### [Векторы](#H2152).fg[].bg[]
#### [Растры](#He80b)
#### [Визуализация](#H3430)
### [По форматам](#H0cf1)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[


Библиотека | Формат | Импорт | Экспорт 
-----|------|-----|---
`sp` | [GDAL vector drivers](https://gdal.org/drivers/vector/index.html) | **`rgdal`**`::readOGR()` | **`rgdal`**`::writeOGR()`
[`sf`](https://r-spatial.github.io/sf/) | [GDAL vector drivers](https://gdal.org/drivers/vector/index.html) | `st_read()` | `st_write()`
[`gdalUtuls`](https://cran.rstudio.com/web/packages/gdalUtils/)<sup>*факультативно*<sup> | [GDAL vector drivers](https://gdal.org/drivers/vector/index.html) | | оболочка системного GDAL



]
---

name: He80b

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba).fg[]
### [Средства визуализации](#Hb85a)
### [Пространст&shy;вен&shy;ные данные](#H2152).fg[]
#### [Векторы](#H2152)
#### [Растры](#He80b).fg[].bg[]
#### [Визуализация](#H3430)
### [По форматам](#H0cf1)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[


Библиотека | Формат | Импорт | Экспорт
---|----|--------|----
`sp` | [GDAL raster drivers](https://gdal.org/drivers/raster/index.html) | **`rgdal`**`::readGDAL()` | **`rgdal`**`::writeGDAL()`
`raster` | [RRASTER – R Raster](https://gdal.org/drivers/raster/rraster.html) | `raster()`, `brick()`, `stack()` | `writeRaster()`
`terra` | [GDAL raster drivers](https://gdal.org/drivers/raster/index.html) | `rast()` | `writeRaster()`
`stars` | [GDAL raster drivers](https://gdal.org/drivers/raster/index.html) | `read_stars()` | `write_stars()`
[`ncdf4`](https://cran.rstudio.com/web/packages/ncdf4/) | [NetCDF](https://gdal.org/drivers/raster/netcdf.html) | `nc_open()` | `nc_create()`
`ursa`| [ENVI - ENVI .hdr Labelled Raster](https://gdal.org/drivers/raster/envi.html) | `read_envi()` | `write_envi()`


]
---

name: H3430

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba).fg[]
### [Средства визуализации](#Hb85a)
### [Пространст&shy;вен&shy;ные данные](#H2152).fg[]
#### [Векторы](#H2152)
#### [Растры](#He80b)
#### [Визуализация](#H3430).fg[].bg[]
### [По форматам](#H0cf1)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[


 Статическая, экспортируемая в обычные форматы изображений. PNG, JPG поддерживают DPI.

+ `ggplot2` и надстройки (префикс `gg*`)

+ `ursa` 

Интерактивная, отображаемая в браузере

+ `leaflet`

+ `mapview`

+ `tmap`




]
---

name: H0cf1

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba).fg[]
### [Средства визуализации](#Hb85a)
### [Пространст&shy;вен&shy;ные данные](#H2152)
### [По форматам](#H0cf1).fg[]
#### [Растры](#H0cf1).fg[].bg[]
#### [Векторы](#H0ad8)
#### [<code>sf</code> или <code>sp</code>?](#Hdf7d)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[


+ Для хранения многослойные растров используется BSQ/BIL/BIP чередование слоев/строк/пикелей. Самый неэффективный - это BIP. При пространственно-временном анализе можно выбрать BIL, для большинства случаев - BSQ.
+ Целочисленный GeoTIFF быстро пишется и читается при использовании функций из библиотеки `rgdal`


]
---

name: H0ad8

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba).fg[]
### [Средства визуализации](#Hb85a)
### [Пространст&shy;вен&shy;ные данные](#H2152)
### [По форматам](#H0cf1).fg[]
#### [Растры](#H0cf1)
#### [Векторы](#H0ad8).fg[].bg[]
#### [<code>sf</code> или <code>sp</code>?](#Hdf7d)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[


+ Хорошую скорость чтения и записи демонстрирует формат "SpatiaLite" при использовании библиотеки `sf`.

+ "GeoJSON" не очень быстрый, но можно использовать библиотеку [`geojsonf`](https://cran.rstudio.com/web/packages/geojsonsf/).

+ При записи использовать опции, предусмотренные для выбранного формата данных

+ При записи "ESRI Shapefile" обращать внимания на *.prj, так как у QGIS и ESRI-продуктов разные восприятия файлов проекций.


]
---

name: Hdf7d

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba).fg[]
### [Средства визуализации](#Hb85a)
### [Пространст&shy;вен&shy;ные данные](#H2152)
### [По форматам](#H0cf1).fg[]
#### [Растры](#H0cf1)
#### [Векторы](#H0ad8)
#### [<code>sf</code> или <code>sp</code>?](#Hdf7d).fg[].bg[]
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[




+ В пользу .large[`sf`] больше аргументов:

   + удобнее, активно развивается, поддерживается

   + в `sf` объекты класса S3, в `sp` объекты класса S4 (строже, но медленнее)

   + есть `sf::as_Spatial()` для преобразования в объекты `sp`. Обратное преобразование: `sf::st_as_sf()`.

+ Эффективность с геометрией POINT выше у `sp` из-за представления атрибутивной таблицы и геометрии в одной таблице.

+ Ряд библиотек завязаны на формат данных `sp`, например
[`adehabitatHR`](https://cran.rstudio.com/web/packages/adehabitatHR/),
[`dismo`](https://cran.rstudio.com/web/packages/dismo/),
[`sdm`](https://cran.rstudio.com/web/packages/sdm/).



]
---
class: middle
name: Hbbf1

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1).fg[].bg[]
#### [Источники для примера](#H26b3)
#### [Векторные данные](#H27f2)
#### [Растровые данные](#H8837)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



Загрузить пространственные данные из файла


]
---

name: H26b3

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1).fg[]
#### [Источники для примера](#H26b3) <span class="bullet bullet-active">[&#8226;](#H26b3)</span><span class="bullet mslide54m">[&#8226;](#Haa82)</span><span class="bullet mslide55m">[&#8226;](#Hdd85)</span>.fg[].bg[]
#### [Векторные данные](#H27f2)
#### [Растровые данные](#H8837)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
(shpname <- system.file("vectors","scot_BNG.shp",package="rgdal"))
```

```
## [1] "C:/Software/Rlibs/rgdal/vectors/scot_BNG.shp"
```

```r
file.exists(shpname)
```

```
## [1] TRUE
```




```r
(tifname <- system.file("pictures/cea.tif",package="rgdal"))
```

```
## [1] "C:/Software/Rlibs/rgdal/pictures/cea.tif"
```

```r
file.exists(tifname)
```

```
## [1] TRUE
```



]
---

name: Haa82

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1).fg[]
#### [Источники для примера](#H26b3) <span class="bullet bullet">[&#8226;](#H26b3)</span><span class="bullet bullet-active">[&#8226;](#Haa82)</span><span class="bullet mslide55m">[&#8226;](#Hdd85)</span>.fg[].bg[]
#### [Векторные данные](#H27f2)
#### [Растровые данные](#H8837)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[




```r
ursa::session_grid(NULL)
ursa::glance(shpname,coast=FALSE,field="(NAME|AFF)",blank="white"
            ,legend=list("left","right"),dpi=88)
```

<img src="assets/lesson05//ursa05_scotBNG.png" width="1330" height="500" bound style="display: block; margin: auto;" />



]
---

name: Hdd85

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1).fg[]
#### [Источники для примера](#H26b3) <span class="bullet bullet">[&#8226;](#H26b3)</span><span class="bullet bullet">[&#8226;](#Haa82)</span><span class="bullet bullet-active">[&#8226;](#Hdd85)</span>.fg[].bg[]
#### [Векторные данные](#H27f2)
#### [Растровые данные](#H8837)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[




```r
ursa::session_grid(NULL)
ursa::glance(tifname,coast=FALSE,pal.from=0,pal=c("black","white"),dpi=96)
```

<img src="assets/lesson05//ursa07_cea.png" width="1330" height="550" bound style="display: block; margin: auto;" />






]
---

name: H27f2

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1).fg[]
#### [Источники для примера](#H26b3)
#### [Векторные данные](#H27f2).fg[]
##### [<code>rgdal/sp</code>](#H27f2) <span class="bullet bullet-active">[&#8226;](#H27f2)</span><span class="bullet mslide59m">[&#8226;](#Hd433)</span><span class="bullet mslide60m">[&#8226;](#H86c2)</span>.fg[].bg[]
##### [<code>sf</code>](#importExample)
#### [Растровые данные](#H8837)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[

.oversize.h650[


```r
rgdal::ogrInfo(shpname)
```

```
## Warning: OGR support is provided by the sf and terra packages among others
```

```
## Warning: OGR support is provided by the sf and terra packages among others
```

```
## Warning: OGR support is provided by the sf and terra packages among others
```

```
## Warning: OGR support is provided by the sf and terra packages among others
```

```
## Warning: OGR support is provided by the sf and terra packages among others
```

```
## Warning: OGR support is provided by the sf and terra packages among others
```

```
## Source: "C:\Software\Rlibs\rgdal\vectors\scot_BNG.shp", layer: "scot_BNG"
## Driver: ESRI Shapefile; number of rows: 56 
## Feature type: wkbPolygon with 2 dimensions
## Extent: (7094.552 529495) - (468285.5 1218342)
## CRS: +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy +units=m +no_defs 
## LDID: 0 
## Number of fields: 13 
##      name type length typeName
## 1   SP_ID    4      5   String
## 2    NAME    4     13   String
## 3    ID_x    2     19     Real
## 4   COUNT    2     19     Real
## 5     SMR    2     19     Real
## 6    LONG    2     19     Real
## 7     LAT    2     19     Real
## 8      PY    2     19     Real
## 9    EXP_    2     19     Real
## 10    AFF    2     19     Real
## 11 X_COOR    2     19     Real
## 12 Y_COOR    2     19     Real
## 13   ID_y    2     19     Real
```

]

]
---

name: Hd433

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1).fg[]
#### [Источники для примера](#H26b3)
#### [Векторные данные](#H27f2).fg[]
##### [<code>rgdal/sp</code>](#H27f2) <span class="bullet bullet">[&#8226;](#H27f2)</span><span class="bullet bullet-active">[&#8226;](#Hd433)</span><span class="bullet mslide60m">[&#8226;](#H86c2)</span>.fg[].bg[]
##### [<code>sf</code>](#importExample)
#### [Растровые данные](#H8837)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
b.sp <- rgdal::readOGR(shpname)
```

```
## Warning: OGR support is provided by the sf and terra packages among others
```

```
## Warning: OGR support is provided by the sf and terra packages among others
```

```
## Warning: OGR support is provided by the sf and terra packages among others
```

```
## Warning: OGR support is provided by the sf and terra packages among others
```

```
## Warning: OGR support is provided by the sf and terra packages among others
```

```
## Warning: OGR support is provided by the sf and terra packages among others
```

```
## Warning: OGR support is provided by the sf and terra packages among others
```

```
## OGR data source with driver: ESRI Shapefile 
## Source: "C:\Software\Rlibs\rgdal\vectors\scot_BNG.shp", layer: "scot_BNG"
## with 56 features
## It has 13 fields
```




```r
isS4(b.sp)
```

```
## [1] TRUE
```

```r
slotNames(b.sp)
```

```
## [1] "data"        "polygons"    "plotOrder"   "bbox"        "proj4string"
```


]
---

name: H86c2

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1).fg[]
#### [Источники для примера](#H26b3)
#### [Векторные данные](#H27f2).fg[]
##### [<code>rgdal/sp</code>](#H27f2) <span class="bullet bullet">[&#8226;](#H27f2)</span><span class="bullet bullet">[&#8226;](#Hd433)</span><span class="bullet bullet-active">[&#8226;](#H86c2)</span>.fg[].bg[]
##### [<code>sf</code>](#importExample)
#### [Растровые данные](#H8837)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[

.oversize[




```r
str(head(b.sp,2))
```

```
## Formal class 'SpatialPolygonsDataFrame' [package "sp"] with 5 slots
##   ..@ data       :'data.frame':	2 obs. of  13 variables:
##   .. ..$ SP_ID : chr [1:2] "0" "1"
##   .. ..$ NAME  : chr [1:2] "Sutherland" "Nairn"
##   .. ..$ ID_x  : num [1:2] 12 13
##   .. ..$ COUNT : num [1:2] 5 3
##   .. ..$ SMR   : num [1:2] 279 278
##   .. ..$ LONG  : num [1:2] 58.1 57.5
##   .. ..$ LAT   : num [1:2] 4.64 3.98
##   .. ..$ PY    : num [1:2] 37521 29374
##   .. ..$ EXP_  : num [1:2] 1.8 1.1
##   .. ..$ AFF   : num [1:2] 16 10
##   .. ..$ X_COOR: num [1:2] 247757 289592
##   .. ..$ Y_COOR: num [1:2] 924954 842305
##   .. ..$ ID_y  : num [1:2] 12 13
##   ..@ polygons   :List of 2
##   .. ..$ :Formal class 'Polygons' [package "sp"] with 5 slots
##   .. .. .. ..@ Polygons :List of 1
##   .. .. .. .. ..$ :Formal class 'Polygon' [package "sp"] with 5 slots
##   .. .. .. .. .. .. ..@ labpt  : num [1:2] 247754 924885
##   .. .. .. .. .. .. ..@ area   : num 3.92e+09
##   .. .. .. .. .. .. ..@ hole   : logi FALSE
##   .. .. .. .. .. .. ..@ ringDir: int 1
##   .. .. .. .. .. .. ..@ coords : num [1:73, 1:2] 254218 254359 252991 244974 259133 ...
##   .. .. .. ..@ plotOrder: int 1
##   .. .. .. ..@ labpt    : num [1:2] 247754 924885
##   .. .. .. ..@ ID       : chr "0"
##   .. .. .. ..@ area     : num 3.92e+09
##   .. .. .. ..$ comment: chr "0"
##   .. ..$ :Formal class 'Polygons' [package "sp"] with 5 slots
##   .. .. .. ..@ Polygons :List of 1
##   .. .. .. .. ..$ :Formal class 'Polygon' [package "sp"] with 5 slots
##   .. .. .. .. .. .. ..@ labpt  : num [1:2] 289590 842235
##   .. .. .. .. .. .. ..@ area   : num 4.7e+08
##   .. .. .. .. .. .. ..@ hole   : logi FALSE
##   .. .. .. .. .. .. ..@ ringDir: int 1
##   .. .. .. .. .. .. ..@ coords : num [1:9, 1:2] 292542 301399 301520 289304 288882 ...
##   .. .. .. ..@ plotOrder: int 1
##   .. .. .. ..@ labpt    : num [1:2] 289590 842235
##   .. .. .. ..@ ID       : chr "1"
##   .. .. .. ..@ area     : num 4.7e+08
##   .. .. .. ..$ comment: chr "0"
##   ..@ plotOrder  : int [1:2] 1 2
##   ..@ bbox       : num [1:2, 1:2] 204670 825310 306671 974566
##   .. ..- attr(*, "dimnames")=List of 2
##   .. .. ..$ : chr [1:2] "x" "y"
##   .. .. ..$ : chr [1:2] "min" "max"
##   ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slot
##   .. .. ..@ projargs: chr "+proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy +units=m +no_defs"
##   .. .. ..$ comment: chr "| __truncated__"
##   ..$ comment: chr "TRUE"
```

]


]
---
name: importExample

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1).fg[]
#### [Источники для примера](#H26b3)
#### [Векторные данные](#H27f2).fg[]
##### [<code>rgdal/sp</code>](#H27f2)
##### [<code>sf</code>](#importExample) <span class="bullet bullet-active">[&#8226;](#importExample)</span><span class="bullet mslide63m">[&#8226;](#H1fcb)</span>.fg[].bg[]
#### [Растровые данные](#H8837)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[






```r
b.sf <- sf::st_read(shpname)
```

```
## Reading layer `scot_BNG' from data source 
##   `C:\Software\Rlibs\rgdal\vectors\scot_BNG.shp' using driver `ESRI Shapefile'
## Simple feature collection with 56 features and 13 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: 7094.552 ymin: 529495 xmax: 468285.5 ymax: 1218342
## Projected CRS: OSGB36 / British National Grid
```



]
---

name: H1fcb

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1).fg[]
#### [Источники для примера](#H26b3)
#### [Векторные данные](#H27f2).fg[]
##### [<code>rgdal/sp</code>](#H27f2)
##### [<code>sf</code>](#importExample) <span class="bullet bullet">[&#8226;](#importExample)</span><span class="bullet bullet-active">[&#8226;](#H1fcb)</span>.fg[].bg[]
#### [Растровые данные](#H8837)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
str(b.sf)
```

```
## Classes 'sf' and 'data.frame':	56 obs. of  14 variables:
##  $ SP_ID   : chr  "0" "1" "2" "3" ...
##  $ NAME    : chr  "Sutherland" "Nairn" "Inverness" "Banff-Buchan" ...
##  $ ID_x    : num  12 13 19 2 17 16 21 50 15 25 ...
##  $ COUNT   : num  5 3 9 39 2 9 16 6 17 19 ...
##  $ SMR     : num  279 278 163 450 187 ...
##  $ LONG    : num  58.1 57.5 57.2 57.6 57.1 ...
##  $ LAT     : num  4.64 3.98 4.73 2.36 4.09 3 2.98 3.2 3.1 3.3 ...
##  $ PY      : num  37521 29374 162867 231337 27075 ...
##  $ EXP_    : num  1.8 1.1 5.5 8.7 1.1 4.6 10.5 19.6 7.8 15.5 ...
##  $ AFF     : num  16 10 7 16 10 16 7 1 7 1 ...
##  $ X_COOR  : num  247757 289592 249685 385776 280492 ...
##  $ Y_COOR  : num  924954 842305 825855 852378 801036 ...
##  $ ID_y    : num  12 13 19 2 17 16 21 50 15 25 ...
##  $ geometry:sfc_MULTIPOLYGON of length 56; first list element: List of 1
##   ..$ :List of 1
##   .. ..$ : num [1:73, 1:2] 254218 254359 252991 244974 259133 ...
##   ..- attr(*, "class")= chr [1:3] "XY" "MULTIPOLYGON" "sfg"
##  - attr(*, "sf_column")= chr "geometry"
##  - attr(*, "agr")= Factor w/ 3 levels "constant","aggregate",..: NA NA NA NA NA NA NA NA NA NA ...
##   ..- attr(*, "names")= chr [1:13] "SP_ID" "NAME" "ID_x" "COUNT" ...
```





]
---

name: H8837

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1).fg[]
#### [Источники для примера](#H26b3)
#### [Векторные данные](#H27f2)
#### [Растровые данные](#H8837).fg[]
##### [<code>rgdal/sp</code>](#H8837) <span class="bullet bullet-active">[&#8226;](#H8837)</span><span class="bullet mslide66m">[&#8226;](#H6fa1)</span>.fg[].bg[]
##### [<code>raster</code>](#H9477)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[

.font92[
Получение данных напрямую



```r
d1 <- rgdal::readGDAL(tifname)
```

```
## Warning: GDAL support is provided by the sf and terra packages among others
```

```
## C:/Software/Rlibs/rgdal/pictures/cea.tif has GDAL driver GTiff 
## and has 515 rows and 514 columns
```

```
## Warning: GDAL support is provided by the sf and terra packages among others
```


```r
str(d1)
```

```
## Formal class 'SpatialGridDataFrame' [package "sp"] with 4 slots
##   ..@ data       :'data.frame':	264710 obs. of  1 variable:
##   .. ..$ band1: int [1:264710] 0 0 0 0 0 0 0 0 0 0 ...
##   ..@ grid       :Formal class 'GridTopology' [package "sp"] with 3 slots
##   .. .. ..@ cellcentre.offset: Named num [1:2] -28463 4225003
##   .. .. .. ..- attr(*, "names")= chr [1:2] "x" "y"
##   .. .. ..@ cellsize         : num [1:2] 60 60
##   .. .. ..@ cells.dim        : int [1:2] 514 515
##   ..@ bbox       : num [1:2, 1:2] -28493 4224973 2358 4255885
##   .. ..- attr(*, "dimnames")=List of 2
##   .. .. ..$ : chr [1:2] "x" "y"
##   .. .. ..$ : chr [1:2] "min" "max"
##   ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slot
##   .. .. ..@ projargs: chr "+proj=cea +lat_ts=33.75 +lon_0=-117.333333333333 +x_0=0 +y_0=0 +datum=NAD27 +units=m +no_defs"
##   .. .. ..$ comment: chr "| __truncated__"
```

```r
summary(d1@data[[1]])
```

```
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##     0.0    58.0    99.0   103.1   140.0   255.0
```

]

]
---

name: H6fa1

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1).fg[]
#### [Источники для примера](#H26b3)
#### [Векторные данные](#H27f2)
#### [Растровые данные](#H8837).fg[]
##### [<code>rgdal/sp</code>](#H8837) <span class="bullet bullet">[&#8226;](#H8837)</span><span class="bullet bullet-active">[&#8226;](#H6fa1)</span>.fg[].bg[]
##### [<code>raster</code>](#H9477)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[

Получение данных более гибким способом



```r
md <- rgdal::GDALinfo(tifname)
```

```
## Warning: GDAL support is provided by the sf and terra packages among others
```

```
## Warning: GDAL support is provided by the sf and terra packages among others
```

```
## Warning in rgdal::GDALinfo(tifname): statistics not supported by this driver
```

```r
mdname <- names(md)
attributes(md) <- NULL
names(md) <- mdname
md
```

```
##          rows       columns         bands          ll.x          ll.y 
##     515.00000     514.00000       1.00000  -28493.16678 4224973.14326 
##         res.x         res.y     oblique.x     oblique.y 
##      60.02214      60.02214       0.00000       0.00000
```

```r
dset <- methods::new("GDALReadOnlyDataset",tifname)
d2 <- rgdal::getRasterData(dset,offset=c(0,0)
                          ,region.dim=md[c("rows","columns")])
str(d2)
```

```
##  int [1:514, 1:515] 0 0 0 0 0 0 0 0 0 0 ...
```

```r
summary(c(d2))
```

```
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##     0.0    58.0    99.0   103.1   140.0   255.0
```



]
---

name: H9477

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1).fg[]
#### [Источники для примера](#H26b3)
#### [Векторные данные](#H27f2)
#### [Растровые данные](#H8837).fg[]
##### [<code>rgdal/sp</code>](#H8837)
##### [<code>raster</code>](#H9477).fg[].bg[]
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[


.font95[


```r
(d3 <- raster::brick(tifname))
```

```
## class      : RasterBrick 
## dimensions : 515, 514, 264710, 1  (nrow, ncol, ncell, nlayers)
## resolution : 60.02214, 60.02214  (x, y)
## extent     : -28493.17, 2358.212, 4224973, 4255885  (xmin, xmax, ymin, ymax)
## crs        : +proj=cea +lat_ts=33.75 +lon_0=-117.333333333333 +x_0=0 +y_0=0 +datum=NAD27 +units=m +no_defs 
## source     : cea.tif 
## names      : cea
```

```r
v3 <- d3[] ## 'd3[]' то же, что и 'raster::getValues(d3)'
c(d3=object.size(d3),v3=object.size(v3))
```

```
##      d3      v3 
##   15280 2118184
```

```r
str(v3)
```

```
##  num [1:264710, 1] 0 0 0 0 0 0 0 0 0 0 ...
##  - attr(*, "dimnames")=List of 2
##   ..$ : NULL
##   ..$ : chr "cea"
```

```r
summary(c(v3))
```

```
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##     0.0    58.0    99.0   103.1   140.0   255.0
```

]

]
---
class: middle
name: H0f29

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29).fg[].bg[]
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[




 #### Характеристики, свойства и компоненты пространственных данных


]
---

name: H05d3

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29).fg[]
##### [`sp`](#H05d3).fg[].bg[]
##### [`sf`](#H80a9)
#### [Таблица атрибутов](#H7484)
#### [Геометрия](#H7e9e)
#### [Проекция](#H6a80)
#### [Пространственный охват](#H5e7c)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
class(b.sp$NAME)
```

```
## [1] "character"
```

```r
class(b.sp[["NAME"]])
```

```
## [1] "character"
```

```r
class(b.sp["NAME"])
```

```
## [1] "SpatialPolygonsDataFrame"
## attr(,"package")
## [1] "sp"
```



]
---

name: H80a9

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29).fg[]
##### [`sp`](#H05d3)
##### [`sf`](#H80a9).fg[].bg[]
#### [Таблица атрибутов](#H7484)
#### [Геометрия](#H7e9e)
#### [Проекция](#H6a80)
#### [Пространственный охват](#H5e7c)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
class(b.sf$NAME)
```

```
## [1] "character"
```

```r
class(b.sf[["NAME"]])
```

```
## [1] "character"
```

```r
class(b.sf["NAME"])
```

```
## [1] "sf"         "data.frame"
```





]
---

name: H7484

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29).fg[]
#### [Таблица атрибутов](#H7484).fg[]
##### [`sp`](#H7484).fg[].bg[]
##### [`sf`](#Ha992)
#### [Геометрия](#H7e9e)
#### [Проекция](#H6a80)
#### [Пространственный охват](#H5e7c)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
head(slot(b.sp,"data"))
```

```
##   SP_ID         NAME ID_x COUNT   SMR  LONG  LAT     PY EXP_ AFF   X_COOR
## 0     0   Sutherland   12     5 279.3 58.06 4.64  37521  1.8  16 247756.6
## 1     1        Nairn   13     3 277.8 57.47 3.98  29374  1.1  10 289592.2
## 2     2    Inverness   19     9 162.7 57.24 4.73 162867  5.5   7 249685.5
## 3     3 Banff-Buchan    2    39 450.3 57.56 2.36 231337  8.7  16 385776.1
## 4     4     Bedenoch   17     2 186.9 57.06 4.09  27075  1.1  10 280491.6
## 5     5   Kincardine   16     9 197.8 57.00 3.00 111665  4.6  16 351350.5
##     Y_COOR ID_y
## 0 924953.6   12
## 1 842305.2   13
## 2 825854.5   19
## 3 852378.2    2
## 4 801035.6   17
## 5 792161.7   16
```



]
---

name: Ha992

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29).fg[]
#### [Таблица атрибутов](#H7484).fg[]
##### [`sp`](#H7484)
##### [`sf`](#Ha992).fg[].bg[]
#### [Геометрия](#H7e9e)
#### [Проекция](#H6a80)
#### [Пространственный охват](#H5e7c)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
head(sf::st_set_geometry(b.sf,NULL))
```

```
##   SP_ID         NAME ID_x COUNT   SMR  LONG  LAT     PY EXP_ AFF   X_COOR
## 1     0   Sutherland   12     5 279.3 58.06 4.64  37521  1.8  16 247756.6
## 2     1        Nairn   13     3 277.8 57.47 3.98  29374  1.1  10 289592.2
## 3     2    Inverness   19     9 162.7 57.24 4.73 162867  5.5   7 249685.5
## 4     3 Banff-Buchan    2    39 450.3 57.56 2.36 231337  8.7  16 385776.1
## 5     4     Bedenoch   17     2 186.9 57.06 4.09  27075  1.1  10 280491.6
## 6     5   Kincardine   16     9 197.8 57.00 3.00 111665  4.6  16 351350.5
##     Y_COOR ID_y
## 1 924953.6   12
## 2 842305.2   13
## 3 825854.5   19
## 4 852378.2    2
## 5 801035.6   17
## 6 792161.7   16
```







]
---

name: H7e9e

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29).fg[]
#### [Таблица атрибутов](#H7484)
#### [Геометрия](#H7e9e).fg[]
##### [`sp`](#H7e9e).fg[].bg[]
##### [`sf`](#Ha388)
#### [Проекция](#H6a80)
#### [Пространственный охват](#H5e7c)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[

.oversize[


```r
g.sp <- sp::geometry(b.sp)
```

```r
str(head(g.sp,2)) ## много строк; выведем первые две записи
```

```
## Formal class 'SpatialPolygons' [package "sp"] with 4 slots
##   ..@ polygons   :List of 2
##   .. ..$ :Formal class 'Polygons' [package "sp"] with 5 slots
##   .. .. .. ..@ Polygons :List of 1
##   .. .. .. .. ..$ :Formal class 'Polygon' [package "sp"] with 5 slots
##   .. .. .. .. .. .. ..@ labpt  : num [1:2] 247754 924885
##   .. .. .. .. .. .. ..@ area   : num 3.92e+09
##   .. .. .. .. .. .. ..@ hole   : logi FALSE
##   .. .. .. .. .. .. ..@ ringDir: int 1
##   .. .. .. .. .. .. ..@ coords : num [1:73, 1:2] 254218 254359 252991 244974 259133 ...
##   .. .. .. ..@ plotOrder: int 1
##   .. .. .. ..@ labpt    : num [1:2] 247754 924885
##   .. .. .. ..@ ID       : chr "0"
##   .. .. .. ..@ area     : num 3.92e+09
##   .. .. .. ..$ comment: chr "0"
##   .. ..$ :Formal class 'Polygons' [package "sp"] with 5 slots
##   .. .. .. ..@ Polygons :List of 1
##   .. .. .. .. ..$ :Formal class 'Polygon' [package "sp"] with 5 slots
##   .. .. .. .. .. .. ..@ labpt  : num [1:2] 289590 842235
##   .. .. .. .. .. .. ..@ area   : num 4.7e+08
##   .. .. .. .. .. .. ..@ hole   : logi FALSE
##   .. .. .. .. .. .. ..@ ringDir: int 1
##   .. .. .. .. .. .. ..@ coords : num [1:9, 1:2] 292542 301399 301520 289304 288882 ...
##   .. .. .. ..@ plotOrder: int 1
##   .. .. .. ..@ labpt    : num [1:2] 289590 842235
##   .. .. .. ..@ ID       : chr "1"
##   .. .. .. ..@ area     : num 4.7e+08
##   .. .. .. ..$ comment: chr "0"
##   ..@ plotOrder  : int [1:2] 1 2
##   ..@ bbox       : num [1:2, 1:2] 204670 825310 306671 974566
##   .. ..- attr(*, "dimnames")=List of 2
##   .. .. ..$ : chr [1:2] "x" "y"
##   .. .. ..$ : chr [1:2] "min" "max"
##   ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slot
##   .. .. ..@ projargs: chr "+proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy +units=m +no_defs"
##   .. .. ..$ comment: chr "| __truncated__"
##   ..$ comment: chr "TRUE"
```

]

]
---

name: Ha388

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29).fg[]
#### [Таблица атрибутов](#H7484)
#### [Геометрия](#H7e9e).fg[]
##### [`sp`](#H7e9e)
##### [`sf`](#Ha388).fg[].bg[]
#### [Проекция](#H6a80)
#### [Пространственный охват](#H5e7c)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
(head(g.sf <- sf::st_geometry(b.sf),2))
```

```
## Geometry set for 2 features 
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: 204669.7 ymin: 825310 xmax: 306671.2 ymax: 974566.2
## Projected CRS: OSGB36 / British National Grid
```

```
## MULTIPOLYGON (((254218.3 967027, 254358.6 96696...
```

```
## MULTIPOLYGON (((292542.2 859596.3, 301398.8 836...
```

```r
str(g.sf)
```

```
## sfc_MULTIPOLYGON of length 56; first list element: List of 1
##  $ :List of 1
##   ..$ : num [1:73, 1:2] 254218 254359 252991 244974 259133 ...
##  - attr(*, "class")= chr [1:3] "XY" "MULTIPOLYGON" "sfg"
```



]
---
class: middle
name: H6a80

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29).fg[]
#### [Таблица атрибутов](#H7484)
#### [Геометрия](#H7e9e)
#### [Проекция](#H6a80).fg[].bg[]
##### [`sp`](#Heea5)
##### [`sf`](#H33b3)
#### [Пространственный охват](#H5e7c)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[





В современных пакетах R данные проекции представляются в виде WKT;
по возможножности, сохраняется связь с EPSG и PROJ.


]
---

name: Heea5

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29).fg[]
#### [Таблица атрибутов](#H7484)
#### [Геометрия](#H7e9e)
#### [Проекция](#H6a80).fg[]
##### [`sp`](#Heea5).fg[].bg[]
##### [`sf`](#H33b3)
#### [Пространственный охват](#H5e7c)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[




```r
sp::proj4string(b.sp)
```

```
## [1] "+proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy +units=m +no_defs"
```


]
---

name: H33b3

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29).fg[]
#### [Таблица атрибутов](#H7484)
#### [Геометрия](#H7e9e)
#### [Проекция](#H6a80).fg[]
##### [`sp`](#Heea5)
##### [`sf`](#H33b3) <span class="bullet bullet-active">[&#8226;](#H33b3)</span><span class="bullet mslide84m">[&#8226;](#H1f2c)</span>.fg[].bg[]
#### [Пространственный охват](#H5e7c)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[

.oversize[


```r
sf::st_crs(b.sf)
```

```
## Coordinate Reference System:
##   User input: OSGB36 / British National Grid 
##   wkt:
## PROJCRS["OSGB36 / British National Grid",
##     BASEGEOGCRS["OSGB36",
##         DATUM["Ordnance Survey of Great Britain 1936",
##             ELLIPSOID["Airy 1830",6377563.396,299.3249646,
##                 LENGTHUNIT["metre",1]]],
##         PRIMEM["Greenwich",0,
##             ANGLEUNIT["degree",0.0174532925199433]],
##         ID["EPSG",4277]],
##     CONVERSION["British National Grid",
##         METHOD["Transverse Mercator",
##             ID["EPSG",9807]],
##         PARAMETER["Latitude of natural origin",49,
##             ANGLEUNIT["degree",0.0174532925199433],
##             ID["EPSG",8801]],
##         PARAMETER["Longitude of natural origin",-2,
##             ANGLEUNIT["degree",0.0174532925199433],
##             ID["EPSG",8802]],
##         PARAMETER["Scale factor at natural origin",0.9996012717,
##             SCALEUNIT["unity",1],
##             ID["EPSG",8805]],
##         PARAMETER["False easting",400000,
##             LENGTHUNIT["metre",1],
##             ID["EPSG",8806]],
##         PARAMETER["False northing",-100000,
##             LENGTHUNIT["metre",1],
##             ID["EPSG",8807]]],
##     CS[Cartesian,2],
##         AXIS["(E)",east,
##             ORDER[1],
##             LENGTHUNIT["metre",1]],
##         AXIS["(N)",north,
##             ORDER[2],
##             LENGTHUNIT["metre",1]],
##     USAGE[
##         SCOPE["Engineering survey, topographic mapping."],
##         AREA["United Kingdom (UK) - offshore to boundary of UKCS within 49В°45'N to 61В°N and 9В°W to 2В°E; onshore Great Britain (England, Wales and Scotland). Isle of Man onshore."],
##         BBOX[49.75,-9,61.01,2.01]],
##     ID["EPSG",27700]]
```

]

]
---

name: H1f2c

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29).fg[]
#### [Таблица атрибутов](#H7484)
#### [Геометрия](#H7e9e)
#### [Проекция](#H6a80).fg[]
##### [`sp`](#Heea5)
##### [`sf`](#H33b3) <span class="bullet bullet">[&#8226;](#H33b3)</span><span class="bullet bullet-active">[&#8226;](#H1f2c)</span>.fg[].bg[]
#### [Пространственный охват](#H5e7c)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
sf::st_crs(b.sf)$proj4string
```

```
## [1] "+proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy +units=m +no_defs"
```





]
---

name: H5e7c

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29).fg[]
#### [Таблица атрибутов](#H7484)
#### [Геометрия](#H7e9e)
#### [Проекция](#H6a80)
#### [Пространственный охват](#H5e7c).fg[]
##### [`sp`](#H5e7c).fg[].bg[]
##### [`sf`](#H836a)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
sp::bbox(b.sp)
```

```
##          min       max
## x   7094.552  468285.5
## y 529495.039 1218342.5
```


]
---

name: H836a

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29).fg[]
#### [Таблица атрибутов](#H7484)
#### [Геометрия](#H7e9e)
#### [Проекция](#H6a80)
#### [Пространственный охват](#H5e7c).fg[]
##### [`sp`](#H5e7c)
##### [`sf`](#H836a).fg[].bg[]
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
sf::st_bbox(b.sf)
```

```
##        xmin        ymin        xmax        ymax 
##    7094.552  529495.039  468285.495 1218342.493
```



]
---
class: middle
name: Hf293

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293) <span class="bullet bullet-active">[&#8226;](#Hf293)</span><span class="bullet mslide90m">[&#8226;](#H015a)</span><span class="bullet mslide91m">[&#8226;](#H765d)</span><span class="bullet mslide92m">[&#8226;](#Hef54)</span><span class="bullet mslide93m">[&#8226;](#H9853)</span><span class="bullet mslide94m">[&#8226;](#H0637)</span><span class="bullet mslide95m">[&#8226;](#H7130)</span><span class="bullet mslide96m">[&#8226;](#He839)</span><span class="bullet mslide97m">[&#8226;](#H9f3e)</span>.fg[].bg[]
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[




 Создание пространственных данных, например, новый слой ГИС


]
---

name: H015a

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293) <span class="bullet bullet">[&#8226;](#Hf293)</span><span class="bullet bullet-active">[&#8226;](#H015a)</span><span class="bullet mslide91m">[&#8226;](#H765d)</span><span class="bullet mslide92m">[&#8226;](#Hef54)</span><span class="bullet mslide93m">[&#8226;](#H9853)</span><span class="bullet mslide94m">[&#8226;](#H0637)</span><span class="bullet mslide95m">[&#8226;](#H7130)</span><span class="bullet mslide96m">[&#8226;](#He839)</span><span class="bullet mslide97m">[&#8226;](#H9f3e)</span>.fg[].bg[]
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[

Выйдем из здания вокзала ст. Валдай и создадим точечный `Spatial`-объект:


```r
pt0 <- data.frame(lon=33.24529,lat=57.97012)
sp::coordinates(pt0) <- ~lon+lat
sp::proj4string(pt0) <- sp::CRS("+init=epsg:4326")
```


]
---

name: H765d

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293) <span class="bullet bullet">[&#8226;](#Hf293)</span><span class="bullet bullet">[&#8226;](#H015a)</span><span class="bullet bullet-active">[&#8226;](#H765d)</span><span class="bullet mslide92m">[&#8226;](#Hef54)</span><span class="bullet mslide93m">[&#8226;](#H9853)</span><span class="bullet mslide94m">[&#8226;](#H0637)</span><span class="bullet mslide95m">[&#8226;](#H7130)</span><span class="bullet mslide96m">[&#8226;](#He839)</span><span class="bullet mslide97m">[&#8226;](#H9f3e)</span>.fg[].bg[]
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
ursa::glance(pt0,resetProj=TRUE,style="mapnik"
            ,basemap.order="before",basemap.alpha=1,dpi=91)
```

<img src="assets/lesson05//ursa08_Valdai.png" width="1330" height="568" style="display: block; margin: auto;" />



]
---

name: Hef54

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293) <span class="bullet bullet">[&#8226;](#Hf293)</span><span class="bullet bullet">[&#8226;](#H015a)</span><span class="bullet bullet">[&#8226;](#H765d)</span><span class="bullet bullet-active">[&#8226;](#Hef54)</span><span class="bullet mslide93m">[&#8226;](#H9853)</span><span class="bullet mslide94m">[&#8226;](#H0637)</span><span class="bullet mslide95m">[&#8226;](#H7130)</span><span class="bullet mslide96m">[&#8226;](#He839)</span><span class="bullet mslide97m">[&#8226;](#H9f3e)</span>.fg[].bg[]
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[


Смотрим на структуру данных:



```r
str(pt0)
```

```
## Formal class 'SpatialPoints' [package "sp"] with 3 slots
##   ..@ coords     : num [1, 1:2] 33.2 58
##   .. ..- attr(*, "dimnames")=List of 2
##   .. .. ..$ : chr "1"
##   .. .. ..$ : chr [1:2] "lon" "lat"
##   ..@ bbox       : num [1:2, 1:2] 33.2 58 33.2 58
##   .. ..- attr(*, "dimnames")=List of 2
##   .. .. ..$ : chr [1:2] "lon" "lat"
##   .. .. ..$ : chr [1:2] "min" "max"
##   ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slot
##   .. .. ..@ projargs: chr "+proj=longlat +datum=WGS84 +no_defs"
##   .. .. ..$ comment: chr "| __truncated__"
```


Изменим проекцию для расчета расстояний по координатам:


```r
pt0 <- sp::spTransform(pt0,"+proj=laea +lat_0=58 +lon_0=35 +datum=WGS84")
```

Извлечем координаты:


```r
xy <- sp::coordinates(pt0)
```



]
---

name: H9853

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293) <span class="bullet bullet">[&#8226;](#Hf293)</span><span class="bullet bullet">[&#8226;](#H015a)</span><span class="bullet bullet">[&#8226;](#H765d)</span><span class="bullet bullet">[&#8226;](#Hef54)</span><span class="bullet bullet-active">[&#8226;](#H9853)</span><span class="bullet mslide94m">[&#8226;](#H0637)</span><span class="bullet mslide95m">[&#8226;](#H7130)</span><span class="bullet mslide96m">[&#8226;](#He839)</span><span class="bullet mslide97m">[&#8226;](#H9f3e)</span>.fg[].bg[]
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[


Решаем перемещаться минутными сегментами в течение часа:


```r
n <- 60
```

На основе координат создаем таблицу перемещения. По умолчанию весь период стоим на месте и смотрим на север:


```r
loc <- data.frame(step=seq(0,n),look=pi/2,x=xy[,1],y=xy[,2])
```

Скорость перемещений (в м&nbsp;мин<sup>-1</sup>) в течение минуты случайна:


```r
segment <- runif(n,min=5,max=80)
str(segment)
```

```
##  num [1:60] 41.3 80 51.4 57.7 64.6 ...
```


]
---

name: H0637

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293) <span class="bullet bullet">[&#8226;](#Hf293)</span><span class="bullet bullet">[&#8226;](#H015a)</span><span class="bullet bullet">[&#8226;](#H765d)</span><span class="bullet bullet">[&#8226;](#Hef54)</span><span class="bullet bullet">[&#8226;](#H9853)</span><span class="bullet bullet-active">[&#8226;](#H0637)</span><span class="bullet mslide95m">[&#8226;](#H7130)</span><span class="bullet mslide96m">[&#8226;](#He839)</span><span class="bullet mslide97m">[&#8226;](#H9f3e)</span>.fg[].bg[]
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[

Задаем, что если следующий сегмент длинный, то отклонение направления от предыдущего сегмента будет меньше:


```r
angle <- sapply(1-segment/100,function(x) runif(1,min=-x*pi,max=x*pi))
str(angle)
```

```
##  num [1:60] 0.0668 0.2761 -0.4628 0.7868 0.7046 ...
```

Заполняем последующие шаги на основе предыдущих:


```r
for (i in seq(n)) {
   loc$look[i+1] <- (loc$look[i]+angle[i]) %% (2*pi)
   loc$x[i+1] <- loc$x[i]+segment[i]*cos(loc$look[i+1])
   loc$y[i+1] <- loc$y[i]+segment[i]*sin(loc$look[i+1])
}
head(loc)
```

```
##   step     look         x         y
## 1    0 1.570796 -103834.6 -1982.122
## 2    1 1.637558 -103837.4 -1940.908
## 3    2 1.913633 -103864.2 -1865.572
## 4    3 1.450857 -103858.1 -1814.530
## 5    4 2.237702 -103893.8 -1769.165
## 6    5 2.942329 -103957.2 -1756.369
```



]
---

name: H7130

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293) <span class="bullet bullet">[&#8226;](#Hf293)</span><span class="bullet bullet">[&#8226;](#H015a)</span><span class="bullet bullet">[&#8226;](#H765d)</span><span class="bullet bullet">[&#8226;](#Hef54)</span><span class="bullet bullet">[&#8226;](#H9853)</span><span class="bullet bullet">[&#8226;](#H0637)</span><span class="bullet bullet-active">[&#8226;](#H7130)</span><span class="bullet mslide96m">[&#8226;](#He839)</span><span class="bullet mslide97m">[&#8226;](#H9f3e)</span>.fg[].bg[]
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[


Создадим линейный `sf`-объект


```r
tr <- vector("list",n)
```

Матрица (с двумя столбцами) координат задается как LINESTRING:


```r
for (i in seq(n))
   tr[[i]] <- sf::st_linestring(matrix(c(loc$x[i],loc$y[i],loc$x[i+1],loc$y[i+1])
                               ,ncol=2,byrow=TRUE))
```


]
---

name: He839

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293) <span class="bullet bullet">[&#8226;](#Hf293)</span><span class="bullet bullet">[&#8226;](#H015a)</span><span class="bullet bullet">[&#8226;](#H765d)</span><span class="bullet bullet">[&#8226;](#Hef54)</span><span class="bullet bullet">[&#8226;](#H9853)</span><span class="bullet bullet">[&#8226;](#H0637)</span><span class="bullet bullet">[&#8226;](#H7130)</span><span class="bullet bullet-active">[&#8226;](#He839)</span><span class="bullet mslide97m">[&#8226;](#H9f3e)</span>.fg[].bg[]
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[

.oversize[


```r
str(tr)
```

```
## List of 60
##  $ : 'XY' num [1:2, 1:2] -103835 -103837 -1982 -1941
##  $ : 'XY' num [1:2, 1:2] -103837 -103864 -1941 -1866
##  $ : 'XY' num [1:2, 1:2] -103864 -103858 -1866 -1815
##  $ : 'XY' num [1:2, 1:2] -103858 -103894 -1815 -1769
##  $ : 'XY' num [1:2, 1:2] -103894 -103957 -1769 -1756
##  $ : 'XY' num [1:2, 1:2] -103957 -103982 -1756 -1776
##  $ : 'XY' num [1:2, 1:2] -103982 -103997 -1776 -1844
##  $ : 'XY' num [1:2, 1:2] -103997 -103984 -1844 -1851
##  $ : 'XY' num [1:2, 1:2] -103984 -103953 -1851 -1908
##  $ : 'XY' num [1:2, 1:2] -103953 -103986 -1908 -1966
##  $ : 'XY' num [1:2, 1:2] -103986 -104050 -1966 -2005
##  $ : 'XY' num [1:2, 1:2] -104050 -104072 -2005 -2050
##  $ : 'XY' num [1:2, 1:2] -104072 -104077 -2050 -2108
##  $ : 'XY' num [1:2, 1:2] -104077 -104117 -2108 -2101
##  $ : 'XY' num [1:2, 1:2] -104117 -104120 -2101 -2059
##  $ : 'XY' num [1:2, 1:2] -104120 -104145 -2059 -2000
##  $ : 'XY' num [1:2, 1:2] -104145 -104128 -2000 -1991
##  $ : 'XY' num [1:2, 1:2] -104128 -104080 -1991 -1997
##  $ : 'XY' num [1:2, 1:2] -104080 -104066 -1997 -1989
##  $ : 'XY' num [1:2, 1:2] -104066 -104072 -1989 -1980
##  $ : 'XY' num [1:2, 1:2] -104072 -104099 -1980 -1947
##  $ : 'XY' num [1:2, 1:2] -104099 -104106 -1947 -1975
##  $ : 'XY' num [1:2, 1:2] -104106 -104128 -1975 -1969
##  $ : 'XY' num [1:2, 1:2] -104128 -104126 -1969 -1981
##  $ : 'XY' num [1:2, 1:2] -104126 -104124 -1981 -1974
##  $ : 'XY' num [1:2, 1:2] -104124 -104155 -1974 -1912
##  $ : 'XY' num [1:2, 1:2] -104155 -104133 -1912 -1883
##  $ : 'XY' num [1:2, 1:2] -104133 -104143 -1883 -1851
##  $ : 'XY' num [1:2, 1:2] -104143 -104151 -1851 -1863
##  $ : 'XY' num [1:2, 1:2] -104151 -104148 -1863 -1886
##  $ : 'XY' num [1:2, 1:2] -104148 -104151 -1886 -1878
##  $ : 'XY' num [1:2, 1:2] -104151 -104160 -1878 -1898
##  $ : 'XY' num [1:2, 1:2] -104160 -104164 -1898 -1966
##  $ : 'XY' num [1:2, 1:2] -104164 -104121 -1966 -2009
##  $ : 'XY' num [1:2, 1:2] -104121 -104124 -2009 -2037
##  $ : 'XY' num [1:2, 1:2] -104124 -104171 -2037 -2039
##  $ : 'XY' num [1:2, 1:2] -104171 -104211 -2039 -2035
##  $ : 'XY' num [1:2, 1:2] -104211 -104209 -2035 -2042
##  $ : 'XY' num [1:2, 1:2] -104209 -104165 -2042 -2084
##  $ : 'XY' num [1:2, 1:2] -104165 -104139 -2084 -2109
##  $ : 'XY' num [1:2, 1:2] -104139 -104106 -2109 -2074
##  $ : 'XY' num [1:2, 1:2] -104106 -104113 -2074 -2074
##  $ : 'XY' num [1:2, 1:2] -104113 -104171 -2074 -2119
##  $ : 'XY' num [1:2, 1:2] -104171 -104173 -2119 -2101
##  $ : 'XY' num [1:2, 1:2] -104173 -104182 -2101 -2026
##  $ : 'XY' num [1:2, 1:2] -104182 -104199 -2026 -2038
##  $ : 'XY' num [1:2, 1:2] -104199 -104269 -2038 -2069
##  $ : 'XY' num [1:2, 1:2] -104269 -104262 -2069 -2089
##  $ : 'XY' num [1:2, 1:2] -104262 -104238 -2089 -2138
##  $ : 'XY' num [1:2, 1:2] -104238 -104178 -2138 -2161
##  $ : 'XY' num [1:2, 1:2] -104178 -104128 -2161 -2124
##  $ : 'XY' num [1:2, 1:2] -104128 -104074 -2124 -2121
##  $ : 'XY' num [1:2, 1:2] -104074 -104072 -2121 -2093
##  $ : 'XY' num [1:2, 1:2] -104072 -104047 -2093 -2092
##  $ : 'XY' num [1:2, 1:2] -104047 -104010 -2092 -2111
##  $ : 'XY' num [1:2, 1:2] -104010 -103946 -2111 -2081
##  $ : 'XY' num [1:2, 1:2] -103946 -103913 -2081 -2098
##  $ : 'XY' num [1:2, 1:2] -103913 -103914 -2098 -2088
##  $ : 'XY' num [1:2, 1:2] -103914 -103882 -2088 -2073
##  $ : 'XY' num [1:2, 1:2] -103882 -103838 -2073 -2046
```

]


]
---

name: H9f3e

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293) <span class="bullet bullet">[&#8226;](#Hf293)</span><span class="bullet bullet">[&#8226;](#H015a)</span><span class="bullet bullet">[&#8226;](#H765d)</span><span class="bullet bullet">[&#8226;](#Hef54)</span><span class="bullet bullet">[&#8226;](#H9853)</span><span class="bullet bullet">[&#8226;](#H0637)</span><span class="bullet bullet">[&#8226;](#H7130)</span><span class="bullet bullet">[&#8226;](#He839)</span><span class="bullet bullet-active">[&#8226;](#H9f3e)</span>.fg[].bg[]
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[


Набор сегментов объединяем в геометрию:


```r
tr <- sf::st_sfc(tr,crs=sp::proj4string(pt0))
str(tr)
```

```
## sfc_LINESTRING of length 60; first list element:  'XY' num [1:2, 1:2] -103835 -103837 -1982 -1941
```

С геометрией связываем атрибутивную таблицу.


```r
tr <- sf::st_sf(step=seq(n),segment=segment,geometry=tr)
str(tr)
```

```
## Classes 'sf' and 'data.frame':	60 obs. of  3 variables:
##  $ step    : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ segment : num  41.3 80 51.4 57.7 64.6 ...
##  $ geometry:sfc_LINESTRING of length 60; first list element:  'XY' num [1:2, 1:2] -103835 -103837 -1982 -1941
##  - attr(*, "sf_column")= chr "geometry"
##  - attr(*, "agr")= Factor w/ 3 levels "constant","aggregate",..: NA NA
##   ..- attr(*, "names")= chr [1:2] "step" "segment"
```





]
---

name: H8a09

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09).fg[]
#### [Статическая](#H8a09) <span class="bullet bullet-active">[&#8226;](#H8a09)</span><span class="bullet mslide100m">[&#8226;](#H7fad)</span><span class="bullet mslide101m">[&#8226;](#H08aa)</span><span class="bullet mslide102m">[&#8226;](#H91a3)</span><span class="bullet mslide103m">[&#8226;](#He6a4)</span><span class="bullet mslide104m">[&#8226;](#H78c0)</span><span class="bullet mslide105m">[&#8226;](#H0fc7)</span>.fg[].bg[]
##### [`ggplot2`](#Hd788)
##### [`tmap`](#H4cf5)
##### [Для публикаций](#H3096)
#### [Интерактивная](#H6e7e)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[




```r
ursa::session_grid(NULL)
ursa::glance(tr,style="mapnik",plot.lwd=5
            ,layout=c(1,2),legend=list("left",list("bottom",2)),las=1,dpi=96)
```

<img src="assets/lesson05//ursa10_route.png" width="1330" height="500" bound style="display: block; margin: auto;" />



]
---
class: middle
name: H7fad

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09).fg[]
#### [Статическая](#H8a09) <span class="bullet bullet">[&#8226;](#H8a09)</span><span class="bullet bullet-active">[&#8226;](#H7fad)</span><span class="bullet mslide101m">[&#8226;](#H08aa)</span><span class="bullet mslide102m">[&#8226;](#H91a3)</span><span class="bullet mslide103m">[&#8226;](#He6a4)</span><span class="bullet mslide104m">[&#8226;](#H78c0)</span><span class="bullet mslide105m">[&#8226;](#H0fc7)</span>.fg[].bg[]
##### [`ggplot2`](#Hd788)
##### [`tmap`](#H4cf5)
##### [Для публикаций](#H3096)
#### [Интерактивная](#H6e7e)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[


Графическое отображение переопределенной под класс объекта функцией `plot()` средствами библиотеки `sp` и `sf` развито слабо...

]
---

name: H08aa

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09).fg[]
#### [Статическая](#H8a09) <span class="bullet bullet">[&#8226;](#H8a09)</span><span class="bullet bullet">[&#8226;](#H7fad)</span><span class="bullet bullet-active">[&#8226;](#H08aa)</span><span class="bullet mslide102m">[&#8226;](#H91a3)</span><span class="bullet mslide103m">[&#8226;](#He6a4)</span><span class="bullet mslide104m">[&#8226;](#H78c0)</span><span class="bullet mslide105m">[&#8226;](#H0fc7)</span>.fg[].bg[]
##### [`ggplot2`](#Hd788)
##### [`tmap`](#H4cf5)
##### [Для публикаций](#H3096)
#### [Интерактивная](#H6e7e)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
plot(tr,lwd=5) ## 'sf'-object
```

<img src="assets/lesson05/trplot-sf-1.svg" width="1330" height="568" bound style="display: block; margin: auto;" />


]
---

name: H91a3

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09).fg[]
#### [Статическая](#H8a09) <span class="bullet bullet">[&#8226;](#H8a09)</span><span class="bullet bullet">[&#8226;](#H7fad)</span><span class="bullet bullet">[&#8226;](#H08aa)</span><span class="bullet bullet-active">[&#8226;](#H91a3)</span><span class="bullet mslide103m">[&#8226;](#He6a4)</span><span class="bullet mslide104m">[&#8226;](#H78c0)</span><span class="bullet mslide105m">[&#8226;](#H0fc7)</span>.fg[].bg[]
##### [`ggplot2`](#Hd788)
##### [`tmap`](#H4cf5)
##### [Для публикаций](#H3096)
#### [Интерактивная](#H6e7e)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
sp::plot(sf::as_Spatial(tr),lwd=5) ## 'sp'-object ('SpatialPointsDataFrame')
```

<img src="assets/lesson05/trplot-sp-1.svg" width="1330" height="568" bound style="display: block; margin: auto;" />



]
---

name: He6a4

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09).fg[]
#### [Статическая](#H8a09) <span class="bullet bullet">[&#8226;](#H8a09)</span><span class="bullet bullet">[&#8226;](#H7fad)</span><span class="bullet bullet">[&#8226;](#H08aa)</span><span class="bullet bullet">[&#8226;](#H91a3)</span><span class="bullet bullet-active">[&#8226;](#He6a4)</span><span class="bullet mslide104m">[&#8226;](#H78c0)</span><span class="bullet mslide105m">[&#8226;](#H0fc7)</span>.fg[].bg[]
##### [`ggplot2`](#Hd788)
##### [`tmap`](#H4cf5)
##### [Для публикаций](#H3096)
#### [Интерактивная](#H6e7e)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[


[Возвращаясь](#importExample) к ранее загруженным данным


```r
plot(b.sf["AFF"])
```

<img src="assets/lesson05/scotplot-1.svg" width="1330" height="550" style="display: block; margin: auto;" />



]
---

name: H78c0

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09).fg[]
#### [Статическая](#H8a09) <span class="bullet bullet">[&#8226;](#H8a09)</span><span class="bullet bullet">[&#8226;](#H7fad)</span><span class="bullet bullet">[&#8226;](#H08aa)</span><span class="bullet bullet">[&#8226;](#H91a3)</span><span class="bullet bullet">[&#8226;](#He6a4)</span><span class="bullet bullet-active">[&#8226;](#H78c0)</span><span class="bullet mslide105m">[&#8226;](#H0fc7)</span>.fg[].bg[]
##### [`ggplot2`](#Hd788)
##### [`tmap`](#H4cf5)
##### [Для публикаций](#H3096)
#### [Интерактивная](#H6e7e)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
plot(sf::st_geometry(b.sf),col=sf::sf.colors(12,categorical=TRUE)
    ,border='grey',axes=TRUE)
```

<img src="assets/lesson05/scotplotgeom-1.svg" width="1330" height="550" style="display: block; margin: auto;" />



]
---
class: middle
name: H0fc7

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09).fg[]
#### [Статическая](#H8a09) <span class="bullet bullet">[&#8226;](#H8a09)</span><span class="bullet bullet">[&#8226;](#H7fad)</span><span class="bullet bullet">[&#8226;](#H08aa)</span><span class="bullet bullet">[&#8226;](#H91a3)</span><span class="bullet bullet">[&#8226;](#He6a4)</span><span class="bullet bullet">[&#8226;](#H78c0)</span><span class="bullet bullet-active">[&#8226;](#H0fc7)</span>.fg[].bg[]
##### [`ggplot2`](#Hd788)
##### [`tmap`](#H4cf5)
##### [Для публикаций](#H3096)
#### [Интерактивная](#H6e7e)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[


Для оформления карт можно использовать функционал других библиотек.

]
---

name: Hd788

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09).fg[]
#### [Статическая](#H8a09).fg[]
##### [`ggplot2`](#Hd788).fg[].bg[]
##### [`tmap`](#H4cf5)
##### [Для публикаций](#H3096)
#### [Интерактивная](#H6e7e)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
require(ggplot2)
```

```
## Loading required package: ggplot2
```

```r
ggplot()+
   geom_sf(data=b.sf,aes(fill=AFF))+
   coord_sf(crs=sf::st_crs(3857))
```

<img src="assets/lesson05/geomsf-1.svg" width="1330" height="420" style="display: block; margin: auto;" />


]
---

name: H4cf5

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09).fg[]
#### [Статическая](#H8a09).fg[]
##### [`ggplot2`](#Hd788)
##### [`tmap`](#H4cf5).fg[].bg[]
##### [Для публикаций](#H3096)
#### [Интерактивная](#H6e7e)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
require(tmap)
```

```
## Loading required package: tmap
```

```r
tmap_mode("plot")
```

```
## tmap mode set to plotting
```

```r
(tm1 <- tm_shape(b.sf) + tm_polygons("COUNT") + tm_scale_bar() +
   tm_compass(position=c("left","bottom")) + tm_graticules())
```

<img src="assets/lesson05/tmap-plot-1.svg" width="1330" height="445" style="display: block; margin: auto;" />


]
---

name: H3096

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09).fg[]
#### [Статическая](#H8a09).fg[]
##### [`ggplot2`](#Hd788)
##### [`tmap`](#H4cf5)
##### [Для публикаций](#H3096).fg[].bg[]
#### [Интерактивная](#H6e7e)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
fileout4 <- "assets/lesson04/firstmap.png"
png(fileout4, res=300, width=1600, height=1200,
    type="cairo", pointsize=12, family="sans")
print(tm1)
dev.off()
```

```
## pdf 
##   2
```

```r
knitr::include_graphics(fileout4) ## try 'browseURL(fileout4)'
```

<img src="assets/lesson05/0c946f0e~chunk.png" width="1330" height="400" bound style="display: block; margin: auto;" />





]
---

name: H6e7e

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09).fg[]
#### [Статическая](#H8a09)
#### [Интерактивная](#H6e7e).fg[]
##### [`mapview`](#H6e7e).fg[].bg[]
##### [`leaflet`](#H4c6a)
##### [`tmap`](#H1143)
##### [Примеры](#Hb1f0)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
m <- mapview::mapview(b.sf) ## Не отобразится в Jupyter R Notebook.
ursa:::widgetize(m)
```

<div class="figure">
<div class="framed" style="height:588px; width=100%">
<iframe src="assets/lesson05/widget_mapview_67f487b6fb2216f8f1b4da9b9c891d99.html" width="100%" height="588" class="ursa-widgetize"></iframe>
</div>
</div>



]
---

name: H4c6a

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09).fg[]
#### [Статическая](#H8a09)
#### [Интерактивная](#H6e7e).fg[]
##### [`mapview`](#H6e7e)
##### [`leaflet`](#H4c6a) <span class="bullet bullet-active">[&#8226;](#H4c6a)</span><span class="bullet mslide112m">[&#8226;](#H88b8)</span>.fg[].bg[]
##### [`tmap`](#H1143)
##### [Примеры](#Hb1f0)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
require(leaflet)
```

```
## Loading required package: leaflet
```

```r
b <- sf::st_transform(b.sf,4326)
b$category <- factor(b$AFF,ordered=TRUE)
fpal <- colorFactor(topo.colors(5),b$category)
provList <- c("CartoDB.Positron","CartoDB.DarkMatter","Esri.OceanBasemap")
m <- leaflet()
for (p in c(provList)) m <- addProviderTiles(m,providers[[p]],group=p)
m <- m %>% 
   addPolygons(data=b,fillColor=~fpal(category),fillOpacity=0.5
              ,weight=1.6,color=~fpal(category),opacity=0.75
              ,label=~paste0("AFF: ",AFF," (",NAME,")")
              ,popup=~sprintf("Например, поле COUNT, равное %.1f",COUNT)
              ) %>%
   addMeasure("topright",primaryLengthUnit="meters"
             ,primaryAreaUnit="sqmeters") %>%
   addScaleBar("bottomright"
             # ,options = scaleBarOptions(imperial=FALSE,maxWidth=400)
              ) %>%
   addLayersControl(position="topleft"
                   ,baseGroups=c(provList)
                   ,options=layersControlOptions(collapsed=TRUE)
                   ) %>%
   addLegend("bottomright",pal=fpal,values=b$category,opacity=0.6
            ,title="AFF")
```



]
---

name: H88b8

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09).fg[]
#### [Статическая](#H8a09)
#### [Интерактивная](#H6e7e).fg[]
##### [`mapview`](#H6e7e)
##### [`leaflet`](#H4c6a) <span class="bullet bullet">[&#8226;](#H4c6a)</span><span class="bullet bullet-active">[&#8226;](#H88b8)</span>.fg[].bg[]
##### [`tmap`](#H1143)
##### [Примеры](#Hb1f0)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
ursa:::widgetize(m) ## Не отображается в Jupyter R Notebook.
```

<div class="figure">
<div class="framed" style="height:588px; width=100%">
<iframe src="assets/lesson05/widget_leadletwidget_97c1d21d052f8a48e9daad9a2872f288.html" width="100%" height="588" class="ursa-widgetize"></iframe>
</div>
</div>


]
---

name: H1143

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09).fg[]
#### [Статическая](#H8a09)
#### [Интерактивная](#H6e7e).fg[]
##### [`mapview`](#H6e7e)
##### [`leaflet`](#H4c6a)
##### [`tmap`](#H1143) <span class="bullet bullet-active">[&#8226;](#H1143)</span><span class="bullet mslide114m">[&#8226;](#H61db)</span>.fg[].bg[]
##### [Примеры](#Hb1f0)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
tmap_mode("view")
```

```
## tmap mode set to interactive viewing
```

```r
tm <- tm_shape(b.sf) + tm_polygons("COUNT")
ursa:::widgetize(tmap_leaflet(tm),height=510)
```

<div class="figure">
<div class="framed" style="height:510px; width=100%">
<iframe src="assets/lesson05/widget_tmap-view_21d318d9983b318c7e4719476ef26700.html" width="100%" height="510" class="ursa-widgetize"></iframe>
</div>
</div>


]
---

name: H61db

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09).fg[]
#### [Статическая](#H8a09)
#### [Интерактивная](#H6e7e).fg[]
##### [`mapview`](#H6e7e)
##### [`leaflet`](#H4c6a)
##### [`tmap`](#H1143) <span class="bullet bullet">[&#8226;](#H1143)</span><span class="bullet bullet-active">[&#8226;](#H61db)</span>.fg[].bg[]
##### [Примеры](#Hb1f0)
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[

[`tmap` "Get Started" vignette](https://cran.rstudio.com/web/packages/tmap/vignettes/tmap-getstarted.html)

<iframe src="https://cran.rstudio.com/web/packages/tmap/vignettes/tmap-getstarted.html" width="1330" height="610" data-external="1"></iframe>



]
---

name: Hb1f0

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09).fg[]
#### [Статическая](#H8a09)
#### [Интерактивная](#H6e7e).fg[]
##### [`mapview`](#H6e7e)
##### [`leaflet`](#H4c6a)
##### [`tmap`](#H1143)
##### [Примеры](#Hb1f0).fg[].bg[]
### [Экспорт](#Ha285)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[

[GeoSpatial Data Visualization in R](https://bhaskarvk.github.io/user2017.geodataviz/)

<iframe src="https://bhaskarvk.github.io/user2017.geodataviz/" width="1330" height="610" data-external="1"></iframe>



]
---
class: middle
name: Ha285

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285).fg[].bg[]
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[




Сохранить пространственные данные в файл


]
---

name: Hea44

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285).fg[]
##### [`sp/rgdal`](#Hea44) <span class="bullet bullet-active">[&#8226;](#Hea44)</span><span class="bullet mslide119m">[&#8226;](#H1f6a)</span>.fg[].bg[]
##### [`sf`](#H786a)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[




```r
pt <- loc
sp::coordinates(pt) <- ~x+y
sp::proj4string(pt) <- sp::proj4string(pt0)
pt <- sp::spTransform(pt,"EPSG:4326")
```

```
## Warning: PROJ support is provided by the sf and terra packages among others
```

```r
fileout1 <- "afterTrain.geojson"
rgdal::writeOGR(pt,fileout1,gsub("\\..+","",basename(fileout1)),driver="GeoJSON"
                 ,overwrite_layer=TRUE,morphToESRI=FALSE)
```

```
## Warning: OGR support is provided by the sf and terra packages among others
```

```
## Warning: OGR support is provided by the sf and terra packages among others
```


Проверим, появился ли файл:


```r
dir(pattern=paste0(gsub("\\..+","",basename(fileout1),".*")))
```

```
## [1] "afterTrain.geojson"
```


]
---

name: H1f6a

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285).fg[]
##### [`sp/rgdal`](#Hea44) <span class="bullet bullet">[&#8226;](#Hea44)</span><span class="bullet bullet-active">[&#8226;](#H1f6a)</span>.fg[].bg[]
##### [`sf`](#H786a)
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
try(ursa::glance(fileout1,style="mapnik",las=1,size=480,dpi=192))
```

<img src="assets/lesson05//ursa12_glancept.png" width="1330" height="568" bound style="display: block; margin: auto;" />



]
---

name: H786a

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285).fg[]
##### [`sp/rgdal`](#Hea44)
##### [`sf`](#H786a) <span class="bullet bullet-active">[&#8226;](#H786a)</span><span class="bullet mslide121m">[&#8226;](#H3a9c)</span><span class="bullet mslide122m">[&#8226;](#Ha395)</span><span class="bullet mslide123m">[&#8226;](#Hd492)</span>.fg[].bg[]
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[




```r
b.sf <- b.sf[,c("NAME","COUNT")]
b.sf$'категория' <- b$category
b.sf <- sf::st_transform(b.sf,3857)
fileout2 <- "scotland.sqlite"
sf::st_write(b.sf,dsn=fileout2,layer=gsub("\\..+","",basename(fileout2))
            ,driver="SQLite",layer_options=c("LAUNDER=NO"),quiet=TRUE
            ,delete_layer=file.exists(fileout2),delete_dsn=file.exists(fileout2))
```

```r
dir(pattern=paste0(gsub("\\..+","",basename(fileout2),".*")))
```

```
## [1] "scotland.sqlite"
```


]
---

name: H3a9c

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285).fg[]
##### [`sp/rgdal`](#Hea44)
##### [`sf`](#H786a) <span class="bullet bullet">[&#8226;](#H786a)</span><span class="bullet bullet-active">[&#8226;](#H3a9c)</span><span class="bullet mslide122m">[&#8226;](#Ha395)</span><span class="bullet mslide123m">[&#8226;](#Hd492)</span>.fg[].bg[]
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
try(ursa::glance(fileout2,style="mapnik",las=1,dpi=192,size=480))
```

<img src="assets/lesson05//ursa14_glancescot.png" width="1330" height="568" bound style="display: block; margin: auto;" />


]
---

name: Ha395

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285).fg[]
##### [`sp/rgdal`](#Hea44)
##### [`sf`](#H786a) <span class="bullet bullet">[&#8226;](#H786a)</span><span class="bullet bullet">[&#8226;](#H3a9c)</span><span class="bullet bullet-active">[&#8226;](#Ha395)</span><span class="bullet mslide123m">[&#8226;](#Hd492)</span>.fg[].bg[]
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[




```r
fileout3 <- "track.shp"
sf::st_write(tr,dsn=fileout3,layer=gsub("\\..+","",basename(fileout2))
            ,driver="ESRI Shapefile",quiet=TRUE
            ,delete_layer=file.exists(fileout3),delete_dsn=file.exists(fileout3))
```

```r
dir(pattern=paste0(gsub("\\..+","",basename(fileout3),".*")))
```

```
## [1] "track.dbf" "track.prj" "track.shp" "track.shx"
```


]
---

name: Hd492

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285).fg[]
##### [`sp/rgdal`](#Hea44)
##### [`sf`](#H786a) <span class="bullet bullet">[&#8226;](#H786a)</span><span class="bullet bullet">[&#8226;](#H3a9c)</span><span class="bullet bullet">[&#8226;](#Ha395)</span><span class="bullet bullet-active">[&#8226;](#Hd492)</span>.fg[].bg[]
### [Рисование](#H75e7)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



```r
try(ursa::glance(fileout3,style="mapnik",las=1,dpi=192,size=480))
```

<img src="assets/lesson05//ursa16_glancetrack.png" width="1330" height="568" bound style="display: block; margin: auto;" />



]
---

name: H75e7

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1).fg[]
### [Импорт](#Hbbf1)
### [Характеристики](#H0f29)
### [Создание](#Hf293)
### [Визуализация](#H8a09)
### [Экспорт](#Ha285)
### [Рисование](#H75e7).fg[].bg[]
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[


Этот раздел предлагается пройти самостоятельно



```r
track <- sf::st_linestring(cbind(loc$x,loc$y))
track <- sf::st_sf(data.frame(desc="walk"
                  ,sf::st_sfc(track,crs=sp::proj4string(pt0))))
paint <- mapview::viewExtent(track,alpha=0.01) %>% mapedit::editMap("track")
result <- NULL
if (!is.null(paint$finished)) {
   result <- paint$finished
   mapview::mapview(result)
   ursa::session_grid(NULL)
   ursa::glance(result,style="mapnik")
}
```





]
---

name: H5e0c

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c).fg[]
### [Воспроизво&shy;ди&shy;мость](#H5e0c) <span class="bullet bullet-active">[&#8226;](#H5e0c)</span><span class="bullet mslide127m">[&#8226;](#Hd3ff)</span>.fg[].bg[]
#### [Параметры сессии](#H8fd7)
### [Узнать больше об R](#Hd859)
]
.mainbar.right-column[


Ниже приведены фрагмента кода, которые не были выполнены при составлении программы занятия. Их предлагается выполнить самостоятельно. Также необходимо [установленный Pandoc](#pandoc).

Содержимое занятия сгенерировано из файла `lesson04.R`. Загрузим его, переименовав:


```r
sfile <- "lesson04.R"
rfile <- "lesson04-reproduced.R"
{
   if (file.exists(sfile))
      file.copy(sfile,rfile,overwrite=TRUE,copy.date=TRUE)
   else
      download.file(file.path("https://nplatonov.github.io/sevinGIS",sfile)
                   ,rfile)
}
```

<!-- file.copy("main.R","lesson.R",overwrite=TRUE,copy.date=TRUE) -->


]
---

name: Hd3ff

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c).fg[]
### [Воспроизво&shy;ди&shy;мость](#H5e0c) <span class="bullet bullet">[&#8226;](#H5e0c)</span><span class="bullet bullet-active">[&#8226;](#Hd3ff)</span>.fg[].bg[]
#### [Параметры сессии](#H8fd7)
### [Узнать больше об R](#Hd859)
]
.mainbar.right-column[


На основе этого файла создадим markdown-документ:


```r
mdfile <- knitr::spin(rfile,knit=FALSE)
mdfile
```

Затем из markdown-документа сформируем html-документ:


```r
if (rmarkdown::pandoc_available()) {
   htmlfile <- rmarkdown::render(mdfile,output_format="html_document"
                                ,output_options=list(toc=TRUE))
   print(basename(htmlfile))
}
```

Полученный html-документ можно открыть в браузере.


```r
if ((rmarkdown::pandoc_available())&&(file.exists(htmlfile))) 
   browseURL(basename(htmlfile))
```

И можно скопировать/переименовать/удалить


]
---

name: H8fd7

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c).fg[]
### [Воспроизво&shy;ди&shy;мость](#H5e0c).fg[]
#### [Параметры сессии](#H8fd7).fg[].bg[]
### [Узнать больше об R](#Hd859)
]
.mainbar.right-column[

.oversize[


```r
sessionInfo()
```

```
## R version 4.2.3 Patched (2023-03-15 r84006 ucrt)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 19044)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=English_United Kingdom.utf8 
## [2] LC_CTYPE=Russian_Russia.1251           
## [3] LC_MONETARY=English_United Kingdom.utf8
## [4] LC_NUMERIC=C                           
## [5] LC_TIME=English_United Kingdom.utf8    
## system code page: 65001
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] leaflet_2.1.2 tmap_3.3-3    ggplot2_3.4.1
## 
## loaded via a namespace (and not attached):
##  [1] sf_1.0-11               satellite_1.0.4         webshot_0.5.4          
##  [4] RColorBrewer_1.1-3      mapview_2.11.0          tools_4.2.3            
##  [7] bslib_0.4.2             utf8_1.2.3              rgdal_1.6-5            
## [10] R6_2.5.1                KernSmooth_2.23-20      DBI_1.1.3              
## [13] colorspace_2.1-0        raster_3.6-20           withr_2.5.0            
## [16] sp_1.6-0                tidyselect_1.2.0        compiler_4.2.3         
## [19] leafem_0.2.0            cli_3.6.0               geojsonsf_2.0.3        
## [22] labeling_0.4.2          sass_0.4.5              scales_1.2.1           
## [25] classInt_0.4-9          proxy_0.4-27            systemfonts_1.0.4      
## [28] digest_0.6.31           rmarkdown_2.20          svglite_2.1.1          
## [31] base64enc_0.1-3         dichromat_2.0-0.1       jpeg_0.1-10            
## [34] pkgconfig_2.0.3         htmltools_0.5.4         ursa_3.9.10            
## [37] fastmap_1.1.1           highr_0.10              htmlwidgets_1.6.2      
## [40] rlang_1.1.0             xaringan_0.28           shiny_1.7.4            
## [43] jquerylib_0.1.4         generics_0.1.3          farver_2.1.1           
## [46] jsonlite_1.8.4          crosstalk_1.2.0         dplyr_1.1.0            
## [49] magrittr_2.0.3          s2_1.1.2                Rcpp_1.0.10            
## [52] munsell_0.5.0           fansi_1.0.4             abind_1.4-5            
## [55] lifecycle_1.0.3         terra_1.7-18            leafsync_0.1.0         
## [58] yaml_2.3.7              tmaptools_3.1-1         grid_4.2.3             
## [61] widgetframe_0.3.1       parallel_4.2.3          promises_1.2.0.1       
## [64] lattice_0.20-45         stars_0.6-0             leafpop_0.1.0          
## [67] knitr_1.42              pillar_1.8.1            tcltk_4.2.3            
## [70] uuid_1.1-0              codetools_0.2-19        stats4_4.2.3           
## [73] wk_0.7.2                XML_3.99-0.13           glue_1.6.2             
## [76] evaluate_0.20           leaflet.providers_1.9.0 png_0.1-8              
## [79] vctrs_0.6.0             httpuv_1.6.9            gtable_0.3.2           
## [82] cachem_1.0.7            xfun_0.37               mime_0.12              
## [85] lwgeom_0.2-11           xtable_1.8-4            e1071_1.7-13           
## [88] later_1.3.0             class_7.3-21            viridisLite_0.4.1      
## [91] tibble_3.2.0            units_0.8-1             mapedit_0.6.0          
## [94] plutil_0.9-7266         ellipsis_0.3.2          brew_1.0-8             
## [97] xaringanExtra_0.7.0
```

]


]
---

name: Hd859

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c).fg[]
### [Воспроизво&shy;ди&shy;мость](#H5e0c)
### [Узнать больше об R](#Hd859) <span class="bullet bullet-active">[&#8226;](#Hd859)</span><span class="bullet mslide132m">[&#8226;](#Hba8e)</span>.fg[].bg[]
]
.mainbar.right-column[


+ [R-Bloggers](https://www.r-bloggers.com/) – современные тенденции R

+ R's [Spatial](https://cran.rstudio.com/web/views/Spatial.html) and [SpatioTemporal](https://cran.rstudio.com/web/views/SpatioTemporal.html) Task Views 

+ [R-Spatial](https://www.r-spatial.org/) – веб-сайт и блог для интересующихся использованием R для анализа пространственных и пространственно-временных данных

+ [Geocomputation with R ](https://geocompr.github.io) - book and relative

+ [Stackoverflow](https://stackoverflow.com/feeds/tag/r) с тегом #R.

+ [Stackexchange](https://gis.stackexchange.com/questions) о ГИС, в т.ч. с использованием R.

+ Package's vignettes – обобщенное знакомство с библиотекой. Обычно содержат воспроизводимый код.


]
---
class: bottom
name: H5480

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[




.small[
Данные после занятия остались на диске. Если не нужны, выполнить следующее: 


```r
file.remove(dir(pattern=paste0(gsub("\\..+","",basename(fileout1),".*"))))
```

```
## [1] TRUE
```

```r
file.remove(dir(pattern=paste0(gsub("\\..+","",basename(fileout2),".*"))))
```

```
## [1] TRUE
```

```r
file.remove(dir(pattern=paste0(gsub("\\..+","",basename(fileout3),".*"))))
```

```
## [1] TRUE TRUE TRUE TRUE
```

]

<style type="text/css">
:root {
   --pointsize: 20pt;
   --sidebar-pointsize: 78%;
   --sidebar: 25%;
}
</style>

]
---

name: Hba8e

.sidebar.left-column[
## [Основы R](#H83cb)
## [R как ГИС?](#Hd6ba)
## [Манипуляции с пространст&shy;вен&shy;ными данными](#Hbbf1)
## [Дополнительно по R](#H5e0c)
]
.mainbar.right-column[



]

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"countIncrementalSlides": false,
"ratio": "29:18",
"navigation": {
"scroll": true,
"click": false,
"touch": true
},
"highlightLines": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
