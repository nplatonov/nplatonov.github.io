<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>ГИС 10</title>
    <meta charset="utf-8" />
    <script src="https://nplatonov.github.io/site_libs/header-attrs-2.29/header-attrs.js"></script>
    <link href="https://nplatonov.github.io/site_libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="https://nplatonov.github.io/site_libs/remark-css-0.0.1/hygge.css" rel="stylesheet" />
    <link href="https://nplatonov.github.io/site_libs/tile-view-0.2.6/tile-view.css" rel="stylesheet" />
    <script src="https://nplatonov.github.io/site_libs/tile-view-0.2.6/tile-view.js"></script>
    <script src="https://nplatonov.github.io/site_libs/xaringanExtra_fit-screen-0.2.6/fit-screen.js"></script>
    <script src="https://nplatonov.github.io/site_libs/js-cookie-3.0.0/js.cookie.js"></script>
    <script src="https://nplatonov.github.io/site_libs/peerjs-1.3.1/peerjs.min.js"></script>
    <script src="https://nplatonov.github.io/site_libs/tiny.toast-1.0.0/toast.min.js"></script>
    <link href="https://nplatonov.github.io/site_libs/xaringanExtra-broadcast-0.2.6/broadcast.css" rel="stylesheet" />
    <script src="https://nplatonov.github.io/site_libs/xaringanExtra-broadcast-0.2.6/broadcast.js"></script>
    <script src="https://nplatonov.github.io/site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="https://nplatonov.github.io/site_libs/common.css" type="text/css" />
    <link rel="stylesheet" href="https://nplatonov.github.io/site_libs/moon_reader.css" type="text/css" />
    <link rel="stylesheet" href="https://nplatonov.github.io/site_libs/moon_reader-fonts.css" type="text/css" />
    <link rel="stylesheet" href="assets/general/general.css" type="text/css" />
  </head>
  <body>

<div id="loader" class="loader"></div>

<style>
.remark-backdrop:after{
   content: 'Никита Платонов \A \A ГИС аспирантура';
}
</style>

    <textarea id="source">

layout: true








.toc.banner[

.shorttitle[
[ГИС аспирантура](break.html#home)
]

]

---
name: home
class: metadata customtitle middle left giphy

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[






.authors[


.author[Никита&nbsp;Платонов]


.institute[с.н.с. ИПЭЭ РАН]



]


.title[
Моделирование ареалов
]


.subtitle[
ГИС технологии в биологических исследованиях
]


.what[
Занятие 10
]


.where[

]


.when[
 .updated[Обновлено: 2025-03-27 13:23]
]



]








---

name: H87b17

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17).fg[]
### [Некоторые определения](#H87b17).fg[].bg[]
### [Требуемые пакеты ](#H8ae6a)
### [Находки ](#H0cbc5)
### [Картооснова ](#Hbf210)
### [Среда обитания ](#H81091)
### [Подвыборки ](#H1d589)
### [В итоге ](#H7f519)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.broad[
Некоторые определения
]

.fixprecode[


https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/j.1365-2664.2006.01214.x

AUC - Area Under the Receiver Operator Curve (ROC)

TSS - True Skill Statistics

https://cran.rstudio.com/web/packages/ENMTools/



]
]
---

name: H8ae6a

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17).fg[]
### [Некоторые определения](#H87b17)
### [Требуемые пакеты ](#H8ae6a).fg[].bg[]
### [Находки ](#H0cbc5)
### [Картооснова ](#Hbf210)
### [Среда обитания ](#H81091)
### [Подвыборки ](#H1d589)
### [В итоге ](#H7f519)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h3.broad[
Требуемые пакеты .parent[.grand[Подготовка]]
]

.fixprecode[


.within[




Основной **`dismo`**. Он подгружает **`sp`**  для работы с векторными пространственными данными и **`raster`** для работы с растровыми пространственными данными.

Данные из пакета **`tmap`** используются для картоосновы.

Пакет **`MuMIn`** - для определения оптимального числа независимых переменных

Пакет **`kernlab`** - для моделирования методом опорных векторов (SVM)



``` r
‎ invisible(lapply(c("dismo","tmap","MuMIn","kernlab")
‎    ,function(pkg)
‎       if (!requireNamespace(pkg)) install.packages(pkg) else 0L
‎ ))
```

```
‎ Loading required namespace: dismo
```

```
‎ Loading required namespace: tmap
```

```
‎ Loading required namespace: MuMIn
```

```
‎ Loading required namespace: kernlab
```

``` r
‎ require(dismo)
```

```
‎ Loading required package: dismo
```

```
‎ Loading required package: raster
```

```
‎ Loading required package: sp
```

]

]
]
---

name: H0cbc5

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17).fg[]
### [Некоторые определения](#H87b17)
### [Требуемые пакеты ](#H8ae6a)
### [Находки ](#H0cbc5).fg[].bg[]
### [Картооснова ](#Hbf210)
### [Среда обитания ](#H81091)
### [Подвыборки ](#H1d589)
### [В итоге ](#H7f519)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[



.header.h3.broad[
Находки .parent[.grand[Подготовка]]
]

.fixprecode[


Данные по бурогорлому ленивцу [<svg aria-hidden="true" role="img" viewBox="0 0 640 512" style="height:1em;width:1.25em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M640 51.2l-.3 12.2c-28.1.8-45 15.8-55.8 40.3-25 57.8-103.3 240-155.3 358.6H415l-81.9-193.1c-32.5 63.6-68.3 130-99.2 193.1-.3.3-15 0-15-.3C172 352.3 122.8 243.4 75.8 133.4 64.4 106.7 26.4 63.4.2 63.7c0-3.1-.3-10-.3-14.2h161.9v13.9c-19.2 1.1-52.8 13.3-43.3 34.2 21.9 49.7 103.6 240.3 125.6 288.6 15-29.7 57.8-109.2 75.3-142.8-13.9-28.3-58.6-133.9-72.8-160-9.7-17.8-36.1-19.4-55.8-19.7V49.8l142.5.3v13.1c-19.4.6-38.1 7.8-29.4 26.1 18.9 40 30.6 68.1 48.1 104.7 5.6-10.8 34.7-69.4 48.1-100.8 8.9-20.6-3.9-28.6-38.6-29.4.3-3.6 0-10.3.3-13.6 44.4-.3 111.1-.3 123.1-.6v13.6c-22.5.8-45.8 12.8-58.1 31.7l-59.2 122.8c6.4 16.1 63.3 142.8 69.2 156.7L559.2 91.8c-8.6-23.1-36.4-28.1-47.2-28.3V49.6l127.8 1.1.2.5z"/></svg>](https://ru.wikipedia.org/wiki/Бурогорлый_ленивец)


``` r
‎ bradypus <- read.table(file.path(system.file(package="dismo"),"ex/bradypus.csv")
‎                       ,header=TRUE,sep=',')
‎ str(bradypus)
```

```
‎ 'data.frame':	116 obs. of  3 variables:
‎  $ species: chr  "Bradypus variegatus" "Bradypus variegatus" "Bradypus variegatus" "Bradypus variegatus" ...
‎  $ lon    : num  -65.4 -65.4 -65.1 -63.7 -63.9 ...
‎  $ lat    : num  -10.4 -10.4 -16.8 -17.4 -17.4 ...
```

.pull-left-60[


``` r
‎ head(bradypus)
```

```
‎               species      lon      lat
‎ 1 Bradypus variegatus -65.4000 -10.3833
‎ 2 Bradypus variegatus -65.3833 -10.3833
‎ 3 Bradypus variegatus -65.1333 -16.8000
‎ 4 Bradypus variegatus -63.6667 -17.4500
‎ 5 Bradypus variegatus -63.8500 -17.4000
‎ 6 Bradypus variegatus -64.4167 -16.0000
```

]
.pull-right-40[

<img src="assets/lesson10//ursa01_bradypus.png" width="1330" height="300" bound style="display: block; margin: auto auto auto 0;" />

]

]
]
---

name: Hbf210

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17).fg[]
### [Некоторые определения](#H87b17)
### [Требуемые пакеты ](#H8ae6a)
### [Находки ](#H0cbc5)
### [Картооснова ](#Hbf210).fg[].bg[]
### [Среда обитания ](#H81091)
### [Подвыборки ](#H1d589)
### [В итоге ](#H7f519)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[



.header.h3.broad[
Картооснова .parent[.grand[Подготовка]]
]

.fixprecode[


Использование векторной карты границ государств в качестве картографической основы


``` r
‎ # data(World,package="tmap")
‎ # World <- sf::st_geometry(World)
‎ World <- geodata::world(path=tempdir())
```


``` r
‎ op <- par(mar=rep(0,4))
‎ plot(World)
```

<img src="assets/lesson10/wrld-simpl-1.svg" width="1330" height="415" style="display: block; margin: auto auto auto 0;" />

``` r
‎ par(op)
```


]
]
---

name: H81091

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17).fg[]
### [Некоторые определения](#H87b17)
### [Требуемые пакеты ](#H8ae6a)
### [Находки ](#H0cbc5)
### [Картооснова ](#Hbf210)
### [Среда обитания ](#H81091) <span class="bullet bullet-active">[&#8226;](#H81091)</span><span class="bullet mslide13m">[&#8226;](#H508a2)</span><span class="bullet mslide14m">[&#8226;](#Hceeeb)</span><span class="bullet mslide16m">[&#8226;](#H20e0d)</span>.fg[].bg[]
### [Подвыборки ](#H1d589)
### [В итоге ](#H7f519)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[



.header.h3.broad[
Среда обитания .parent[.grand[Подготовка]]
]

.fixprecode[




``` r
‎ (predictnames <- dir(file.path(system.file(package="dismo"),'ex')
‎                        ,pattern='grd$',full.names=TRUE))
```

```
‎ [1] "C:/Software/Rlibs4/dismo/ex/bio1.grd" 
‎ [2] "C:/Software/Rlibs4/dismo/ex/bio12.grd"
‎ [3] "C:/Software/Rlibs4/dismo/ex/bio16.grd"
‎ [4] "C:/Software/Rlibs4/dismo/ex/bio17.grd"
‎ [5] "C:/Software/Rlibs4/dismo/ex/bio5.grd" 
‎ [6] "C:/Software/Rlibs4/dismo/ex/bio6.grd" 
‎ [7] "C:/Software/Rlibs4/dismo/ex/bio7.grd" 
‎ [8] "C:/Software/Rlibs4/dismo/ex/bio8.grd" 
‎ [9] "C:/Software/Rlibs4/dismo/ex/biome.grd"
```

``` r
‎ (predictors <- stack(predictnames) |> brick())
```

```
‎ class      : RasterBrick 
‎ dimensions : 192, 186, 35712, 9  (nrow, ncol, ncell, nlayers)
‎ resolution : 0.5, 0.5  (x, y)
‎ extent     : -125, -32, -56, 40  (xmin, xmax, ymin, ymax)
‎ crs        : +proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +no_defs 
‎ source     : memory
‎ names      : bio1, bio12, bio16, bio17, bio5, bio6, bio7, bio8, biome 
‎ min values :  -23,     0,     0,     0,   61, -212,   60,  -66,     1 
‎ max values :  289,  7682,  2458,  1496,  422,  242,  461,  323,    14 
```

``` r
‎ (levels <- sort(unique(na.omit(predictors[["biome"]][]))))
```

```
‎  [1]  1  2  3  4  5  7  8  9 10 11 12 13 14
```


]
]
---

name: H508a2

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17).fg[]
### [Некоторые определения](#H87b17)
### [Требуемые пакеты ](#H8ae6a)
### [Находки ](#H0cbc5)
### [Картооснова ](#Hbf210)
### [Среда обитания ](#H81091) <span class="bullet bullet">[&#8226;](#H81091)</span><span class="bullet bullet-active">[&#8226;](#H508a2)</span><span class="bullet mslide14m">[&#8226;](#Hceeeb)</span><span class="bullet mslide16m">[&#8226;](#H20e0d)</span>.fg[].bg[]
### [Подвыборки ](#H1d589)
### [В итоге ](#H7f519)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h3.broad[
Среда обитания .parent[.grand[Подготовка]]
]

.fixprecode[



``` r
‎ plot(predictors)
```

<img src="assets/lesson10/predictors-1.svg" width="1330" height="700" style="display: block; margin: auto auto auto 0;" />


]
]
---

name: Hceeeb

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17).fg[]
### [Некоторые определения](#H87b17)
### [Требуемые пакеты ](#H8ae6a)
### [Находки ](#H0cbc5)
### [Картооснова ](#Hbf210)
### [Среда обитания ](#H81091) <span class="bullet bullet">[&#8226;](#H81091)</span><span class="bullet bullet">[&#8226;](#H508a2)</span><span class="bullet bullet-active">[&#8226;](#Hceeeb)</span><span class="bullet mslide16m">[&#8226;](#H20e0d)</span>.fg[].bg[]
### [Подвыборки ](#H1d589)
### [В итоге ](#H7f519)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h3.broad[
Среда обитания .parent[.grand[Подготовка]]
]

.fixprecode[





Биоклиматические переменные WorldClim ([полный список](https://www.worldclim.org/data/bioclim.html))

||
-|-
BIO1 | Annual Mean Temperature
BIO5 | Max Temperature of Warmest Month
BIO6 | Min Temperature of Coldest Month
BIO7 | Temperature Annual Range (BIO5-BIO6)
BIO8 | Mean Temperature of Wettest Quarter
BIO12 | Annual Precipitation
BIO16 | Precipitation of Wettest Quarter
BIO17 | Precipitation of Driest Quarter

Данные можно получить с помощью функции `worldclim_global()` из пакета **`geodata`**, например:


``` r
‎ # raster::getData('worldclim',var='bio',res=10) ## до версии 3.6-26
‎ geodata::worldclim_global(var="bio",res=10,path=tempdir())
```


Наземные биомы (данные [отсюда](https://www.worldwildlife.org/pages/conservation-science-data-and-tools))

||
-|-
BIOME | Terrestrial biome


]
]
---

name: H20e0d

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17).fg[]
### [Некоторые определения](#H87b17)
### [Требуемые пакеты ](#H8ae6a)
### [Находки ](#H0cbc5)
### [Картооснова ](#Hbf210)
### [Среда обитания ](#H81091) <span class="bullet bullet">[&#8226;](#H81091)</span><span class="bullet bullet">[&#8226;](#H508a2)</span><span class="bullet bullet">[&#8226;](#Hceeeb)</span><span class="bullet bullet-active">[&#8226;](#H20e0d)</span>.fg[].bg[]
### [Подвыборки ](#H1d589)
### [В итоге ](#H7f519)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h3.broad[
Среда обитания .parent[.grand[Подготовка]]
]

.fixprecode[

В растре `biome` записаны номинальные характеристики:

||
-|-
1 | Tropical & Subtropical Moist Broadleaf Forests
2 | Tropical & Subtropical Dry Broadleaf Forests
3 | Tropical & Subtropical Coniferous Forests
4 | Temperate Broadleaf & Mixed Forests
5 | Temperate Conifer Forests
6 | Boreal Forests/Taiga
7 | Tropical & Subtropical Grasslands, Savannas & Shrublands
8 | Temperate Grasslands, Savannas & Shrublands
9 | Flooded Grasslands & Savannas
10| Montane Grasslands & Shrublands
11| Tundra
12| Mediterranean Forests, Woodlands & Scrub
13| Deserts & Xeric Shrublands
14| Mangroves


]
]
---

name: H1d589

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17).fg[]
### [Некоторые определения](#H87b17)
### [Требуемые пакеты ](#H8ae6a)
### [Находки ](#H0cbc5)
### [Картооснова ](#Hbf210)
### [Среда обитания ](#H81091)
### [Подвыборки ](#H1d589).fg[].bg[]
#### [Присутствие ](#Hba72c)
#### [Псевдоотсутствие ](#H1c7da)
#### [Обучение и тестирование ](#H3d09e)
### [В итоге ](#H7f519)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h3.broad[
Подвыборки .parent[.grand[Подготовка]]
]

.fixprecode[


Используемый параметр для генератора псевдослучайных чисел. Зафиксированное значение обеспечивает воспроизводимость вычислений.


``` r
‎ (seed <- sample(100:999,1))
```

```
‎ [1] 640
```

``` r
‎ set.seed(seed)
```

Число `1/k` характеризует долю тестовых данных. Разбиваем данные на `k` групп, одна из которых будет тестовая.


``` r
‎ k <- 5L
```

Выбор номера тестовой группы:


``` r
‎ (g <- sample(seq(k),1))
```

```
‎ [1] 5
```



]
]
---

name: Hba72c

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17).fg[]
### [Некоторые определения](#H87b17)
### [Требуемые пакеты ](#H8ae6a)
### [Находки ](#H0cbc5)
### [Картооснова ](#Hbf210)
### [Среда обитания ](#H81091)
### [Подвыборки ](#H1d589).fg[]
#### [Присутствие ](#Hba72c).fg[].bg[]
#### [Псевдоотсутствие ](#H1c7da)
#### [Обучение и тестирование ](#H3d09e)
### [В итоге ](#H7f519)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Присутствие .parent[.grand[Подвыборки .grand[Подготовка]]]
]

.fixprecode[





``` r
‎ group <- dismo::kfold(bradypus,k) ## group <- sample(seq(k),nrow(pres),replace=TRUE) ## альтернативное группирование
‎ str(group)
```

```
‎  int [1:116] 4 4 1 1 1 4 5 5 2 2 ...
```

``` r
‎ table(group)
```

```
‎ group
‎  1  2  3  4  5 
‎ 23 23 24 23 23 
```

Формирование точек присутствия и разбиение их на группы для обучения и тестирования


``` r
‎ pres <- bradypus[,-1] ## presence
‎ pres_train <- pres[group!=g,]
‎ pres_test <- pres[group==g,]
‎ nrow(pres_train)
```

```
‎ [1] 93
```

``` r
‎ nrow(pres_test)
```

```
‎ [1] 23
```


]
]
---

name: H1c7da

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17).fg[]
### [Некоторые определения](#H87b17)
### [Требуемые пакеты ](#H8ae6a)
### [Находки ](#H0cbc5)
### [Картооснова ](#Hbf210)
### [Среда обитания ](#H81091)
### [Подвыборки ](#H1d589).fg[]
#### [Присутствие ](#Hba72c)
#### [Псевдоотсутствие ](#H1c7da) <span class="bullet bullet-active">[&#8226;](#H1c7da)</span><span class="bullet mslide20m">[&#8226;](#He2ae2)</span>.fg[].bg[]
#### [Обучение и тестирование ](#H3d09e)
### [В итоге ](#H7f519)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Псевдоотсутствие .parent[.grand[Подвыборки .grand[Подготовка]]]
]

.fixprecode[



Используемый пространственный охват

.notpull-left[



``` r
‎ ## terra::ext(-90,-32,-33,23) ## not for `dismo::randomPoints()`
‎ ext <- raster::extent(-90,-32,-33,23) ## for `dismo::randomPoints()`
‎ opP <- par(mar=c(3,3,1,1))
‎ plot(ext,col="brown")
‎ plot(World,col="#FFFFA080",border="orange",add=TRUE)
```

``` r
‎ par(opP)
```


]

.notpull-right[

<img src="assets/lesson10/ext-code-1.svg" width="1330" height="450" style="display: block; margin: auto auto auto 0;" />

]

]
]
---

name: He2ae2

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17).fg[]
### [Некоторые определения](#H87b17)
### [Требуемые пакеты ](#H8ae6a)
### [Находки ](#H0cbc5)
### [Картооснова ](#Hbf210)
### [Среда обитания ](#H81091)
### [Подвыборки ](#H1d589).fg[]
#### [Присутствие ](#Hba72c)
#### [Псевдоотсутствие ](#H1c7da) <span class="bullet bullet">[&#8226;](#H1c7da)</span><span class="bullet bullet-active">[&#8226;](#He2ae2)</span>.fg[].bg[]
#### [Обучение и тестирование ](#H3d09e)
### [В итоге ](#H7f519)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Псевдоотсутствие .parent[.grand[Подвыборки .grand[Подготовка]]]
]

.fixprecode[

Формирование набора точек псевдоотсутствия


``` r
‎ backg <- randomPoints(predictors, n=1000, ext=ext, extf = 1.25)
‎ colnames(backg) = c('lon', 'lat')
‎ head(backg)
```

```
‎         lon    lat
‎ [1,] -68.25  11.25
‎ [2,] -51.75   4.25
‎ [3,] -43.75 -22.25
‎ [4,] -69.75 -22.25
‎ [5,] -56.25 -25.25
‎ [6,] -60.75 -32.75
```

Присвоения номеров групп для отбора в тестовую группу


``` r
‎ group <- kfold(backg,k)
‎ table(group)
```

```
‎ group
‎   1   2   3   4   5 
‎ 200 200 200 200 200 
```


]
]
---

name: H3d09e

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17).fg[]
### [Некоторые определения](#H87b17)
### [Требуемые пакеты ](#H8ae6a)
### [Находки ](#H0cbc5)
### [Картооснова ](#Hbf210)
### [Среда обитания ](#H81091)
### [Подвыборки ](#H1d589).fg[]
#### [Присутствие ](#Hba72c)
#### [Псевдоотсутствие ](#H1c7da)
#### [Обучение и тестирование ](#H3d09e) <span class="bullet bullet-active">[&#8226;](#H3d09e)</span><span class="bullet mslide22m">[&#8226;](#H0ca04)</span><span class="bullet mslide23m">[&#8226;](#H7ba77)</span><span class="bullet mslide24m">[&#8226;](#He5c3e)</span>.fg[].bg[]
### [В итоге ](#H7f519)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Обучение и тестирование .parent[.grand[Подвыборки .grand[Подготовка]]]
]

.fixprecode[


Формирование группы для обучения и группы для тестирования для точек псевдоотсутствия


``` r
‎ backg_train <- backg[group!=g,]
‎ backg_test <- backg[group==g,]
```

Формирование группы для обучения из точек присутствия и точек псевдоотсутствия


``` r
‎ train <- rbind(pres_train, backg_train)
```

Формирование группы для тестирования из точек присутствия и точек псевдоотсутствия


``` r
‎ test <- rbind(pres_test, backg_test)
```

Вектор присутствия (значение 1) и отсутствия (значения 0) для обучающей выборки


``` r
‎ pb_train <- c(rep(1L, nrow(pres_train)), rep(0L, nrow(backg_train)))
```

Вектор присутствия (значение 1) и отсутствия (значения 0) для тестовой выборки


``` r
‎ pb_test <- c(rep(1L, nrow(pres_test)), rep(0L, nrow(backg_test)))
```


]
]
---

name: H0ca04

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17).fg[]
### [Некоторые определения](#H87b17)
### [Требуемые пакеты ](#H8ae6a)
### [Находки ](#H0cbc5)
### [Картооснова ](#Hbf210)
### [Среда обитания ](#H81091)
### [Подвыборки ](#H1d589).fg[]
#### [Присутствие ](#Hba72c)
#### [Псевдоотсутствие ](#H1c7da)
#### [Обучение и тестирование ](#H3d09e) <span class="bullet bullet">[&#8226;](#H3d09e)</span><span class="bullet bullet-active">[&#8226;](#H0ca04)</span><span class="bullet mslide23m">[&#8226;](#H7ba77)</span><span class="bullet mslide24m">[&#8226;](#He5c3e)</span>.fg[].bg[]
### [В итоге ](#H7f519)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Обучение и тестирование .parent[.grand[Подвыборки .grand[Подготовка]]]
]

.fixprecode[

Получение характеристик из растров для точек обучающей выборки


``` r
‎ envtrain <- extract(predictors, train) |> data.frame()
```

Новый столбец присутствия/отсутствия


``` r
‎ envtrain <- cbind(pa=pb_train,envtrain)
```

Зададим биом категорией (фактором)


``` r
‎ envtrain$biome = factor(envtrain$biome,levels=levels)
‎ str(envtrain)
```

```
‎ 'data.frame':	893 obs. of  10 variables:
‎  $ pa   : int  1 1 1 1 1 1 1 1 1 1 ...
‎  $ bio1 : int  263 263 253 243 243 252 271 274 266 266 ...
‎  $ bio12: int  1639 1639 3624 1693 1693 2501 2212 2233 2592 2608 ...
‎  $ bio16: int  724 724 1547 775 775 1081 807 877 872 957 ...
‎  $ bio17: int  62 62 373 186 186 280 281 230 498 306 ...
‎  $ bio5 : int  338 338 329 318 318 326 327 329 320 322 ...
‎  $ bio6 : int  191 191 150 150 150 154 220 227 214 219 ...
‎  $ bio7 : int  147 147 179 168 168 172 107 102 105 103 ...
‎  $ bio8 : int  261 261 271 264 264 270 266 269 262 262 ...
‎  $ biome: Factor w/ 13 levels "1","2","3","4",..: 1 1 1 1 1 1 1 1 1 1 ...
```


]
]
---

name: H7ba77

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17).fg[]
### [Некоторые определения](#H87b17)
### [Требуемые пакеты ](#H8ae6a)
### [Находки ](#H0cbc5)
### [Картооснова ](#Hbf210)
### [Среда обитания ](#H81091)
### [Подвыборки ](#H1d589).fg[]
#### [Присутствие ](#Hba72c)
#### [Псевдоотсутствие ](#H1c7da)
#### [Обучение и тестирование ](#H3d09e) <span class="bullet bullet">[&#8226;](#H3d09e)</span><span class="bullet bullet">[&#8226;](#H0ca04)</span><span class="bullet bullet-active">[&#8226;](#H7ba77)</span><span class="bullet mslide24m">[&#8226;](#He5c3e)</span>.fg[].bg[]
### [В итоге ](#H7f519)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Обучение и тестирование .parent[.grand[Подвыборки .grand[Подготовка]]]
]

.fixprecode[



``` r
‎ head(envtrain,24)
```

```
‎    pa bio1 bio12 bio16 bio17 bio5 bio6 bio7 bio8 biome
‎ 1   1  263  1639   724    62  338  191  147  261     1
‎ 2   1  263  1639   724    62  338  191  147  261     1
‎ 3   1  253  3624  1547   373  329  150  179  271     1
‎ 4   1  243  1693   775   186  318  150  168  264     1
‎ 5   1  243  1693   775   186  318  150  168  264     1
‎ 6   1  252  2501  1081   280  326  154  172  270     1
‎ 7   1  271  2212   807   281  327  220  107  266     1
‎ 8   1  274  2233   877   230  329  227  102  269     1
‎ 9   1  266  2592   872   498  320  214  105  262     1
‎ 10  1  266  2608   957   306  322  219  103  262     1
‎ 11  1  239  1194   540   130  313  165  148  252     1
‎ 12  1  251  1617   808    97  312  194  118  246     1
‎ 13  1  271  2599  1250   136  325  224  101  267     1
‎ 14  1  269  2211   981   196  333  219  114  263     1
‎ 15  1  254  2084  1011   137  317  197  119  251     1
‎ 16  1  263  1878   893   122  324  212  112  259     1
‎ 17  1  263  1878   893   122  324  212  112  259     1
‎ 18  1  260  1882   845   170  324  203  121  255     1
‎ 19  1  260  1882   845   170  324  203  121  255     1
‎ 20  1  270  2479  1277   154  331  214  117  267     1
‎ 21  1  181  1372   650   114  259   86  172  206     1
‎ 22  1  258  2677   879   419  313  200  113  259     1
‎ 23  1  216  2835   985   267  277  160  117  212     1
‎ 24  1  199  2005   657   256  262  143  119  196     1
```


]
]
---

name: He5c3e

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17).fg[]
### [Некоторые определения](#H87b17)
### [Требуемые пакеты ](#H8ae6a)
### [Находки ](#H0cbc5)
### [Картооснова ](#Hbf210)
### [Среда обитания ](#H81091)
### [Подвыборки ](#H1d589).fg[]
#### [Присутствие ](#Hba72c)
#### [Псевдоотсутствие ](#H1c7da)
#### [Обучение и тестирование ](#H3d09e) <span class="bullet bullet">[&#8226;](#H3d09e)</span><span class="bullet bullet">[&#8226;](#H0ca04)</span><span class="bullet bullet">[&#8226;](#H7ba77)</span><span class="bullet bullet-active">[&#8226;](#He5c3e)</span>.fg[].bg[]
### [В итоге ](#H7f519)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Обучение и тестирование .parent[.grand[Подвыборки .grand[Подготовка]]]
]

.fixprecode[

Получение характеристик из растров для точек тестовой выборки


``` r
‎ envtest <- extract(predictors, test) |> data.frame()
‎ envtest <- cbind(pa=pb_test,envtest)
‎ envtest$biome = factor(envtest$biome, levels=levels)
‎ str(envtest)
```

```
‎ 'data.frame':	223 obs. of  10 variables:
‎  $ pa   : int  1 1 1 1 1 1 1 1 1 1 ...
‎  $ bio1 : int  240 275 274 270 263 260 270 270 254 272 ...
‎  $ bio12: int  1214 2259 2233 2274 1842 1945 2487 2413 1499 1656 ...
‎  $ bio16: int  516 956 877 1008 818 880 1221 1286 606 680 ...
‎  $ bio17: int  146 208 230 191 176 143 182 140 90 94 ...
‎  $ bio5 : int  317 335 329 331 326 324 329 330 325 335 ...
‎  $ bio6 : int  150 231 227 221 204 204 216 214 185 216 ...
‎  $ bio7 : int  168 104 102 110 121 120 113 116 140 118 ...
‎  $ bio8 : int  261 270 269 266 257 256 268 268 251 270 ...
‎  $ biome: Factor w/ 13 levels "1","2","3","4",..: 2 1 1 1 1 1 1 1 12 1 ...
```

Отдельно пригодятся точки присутствия и псевдоотсутствия тестовой выборки


``` r
‎ testpres <- envtest[envtest$pa==1,-1]
‎ testbackg <- envtest[envtest$pa==0,-1]
```


]
]
---

name: H7f519

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17).fg[]
### [Некоторые определения](#H87b17)
### [Требуемые пакеты ](#H8ae6a)
### [Находки ](#H0cbc5)
### [Картооснова ](#Hbf210)
### [Среда обитания ](#H81091)
### [Подвыборки ](#H1d589)
### [В итоге ](#H7f519) <span class="bullet bullet-active">[&#8226;](#H7f519)</span><span class="bullet mslide27m">[&#8226;](#H7ccab)</span>.fg[].bg[]
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[



.header.h3.broad[
В итоге .parent[.grand[Подготовка]]
]

.fixprecode[


Обзор размеров выборок


``` r
‎ data.frame(pres_train=nrow(pres_train),pres_test=nrow(pres_test),pres=nrow(pres)
‎  ,backg_train=nrow(backg_train),backg_test=nrow(backg_test)
‎  ,train=nrow(train),envtrain=nrow(envtrain)
‎  ,test=nrow(test),envtest=nrow(envtest)
‎  ,row.names="size") |> t() |> knitr::kable()
```



|            | size|
|:-----------|----:|
|pres_train  |   93|
|pres_test   |   23|
|pres        |  116|
|backg_train |  800|
|backg_test  |  200|
|train       |  893|
|envtrain    |  893|
|test        |  223|
|envtest     |  223|


]
]
---

name: H7ccab

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17).fg[]
### [Некоторые определения](#H87b17)
### [Требуемые пакеты ](#H8ae6a)
### [Находки ](#H0cbc5)
### [Картооснова ](#Hbf210)
### [Среда обитания ](#H81091)
### [Подвыборки ](#H1d589)
### [В итоге ](#H7f519) <span class="bullet bullet">[&#8226;](#H7f519)</span><span class="bullet bullet-active">[&#8226;](#H7ccab)</span>.fg[].bg[]
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h3.broad[
В итоге .parent[.grand[Подготовка]]
]

.fixprecode[





.notpull-left[



``` r
‎ opP <- par(mar=c(2.5,2.5,1,1))
‎ plot(!is.na(predictors[[1]]), col=c('white', 'light grey'), legend=FALSE)
‎ plot(ext, add=TRUE, col='red', lwd=2)
‎ points(backg_train, pch='b', cex=0.5, col='yellow')
‎ points(backg_test, pch='b',  cex=0.5, col='black')
‎ points(pres_train, pch= 'p', col='forestgreen')
‎ points(pres_test, pch='p', col='blue')
```

``` r
‎ par(opP)
```


]

.notpull-right[

<img src="assets/lesson10/loc-code-1.svg" width="1330" height="405" style="display: block; margin: auto auto auto 0;" />

]


]
]






---

name: He4650

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650).fg[]
### [GML ](#He4650).fg[]
#### [Binomilal/logit ](#He4650) <span class="bullet bullet-active">[&#8226;](#He4650)</span><span class="bullet mslide31m">[&#8226;](#H8cb22)</span><span class="bullet mslide32m">[&#8226;](#H15bb7)</span><span class="bullet mslide33m">[&#8226;](#H62bc4)</span><span class="bullet mslide34m">[&#8226;](#Hfcd8d)</span>.fg[].bg[]
#### [Gaussian/identity ](#H027e8)
### [Bioclim ](#Hb7208)
### [Domain ](#Hc69bc)
### [Mahalanobis ](#H0ad54)
### [MaxEnt ](#H583d1)
### [Random Forests ](#He0ae0)
### [SVM ](#H4b3dd)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Binomilal/logit .parent[.grand[GML .grand[Моделирование]]]
]

.fixprecode[


.font90[


``` r
‎ gm1 <- glm(pa ~ bio1 + bio5 + bio6 + bio7 + bio8 + bio12 + bio16 + bio17,
‎             family = binomial(link = "logit"), data=envtrain, na.action=na.pass)
‎ summary(gm1)
```

```
‎ 
‎ Call:
‎ glm(formula = pa ~ bio1 + bio5 + bio6 + bio7 + bio8 + bio12 + 
‎     bio16 + bio17, family = binomial(link = "logit"), data = envtrain, 
‎     na.action = na.pass)
‎ 
‎ Coefficients:
‎               Estimate Std. Error z value Pr(>|z|)    
‎ (Intercept)  2.7068107  1.5510790   1.745 0.080965 .  
‎ bio1         0.0904915  0.0557265   1.624 0.104408    
‎ bio5         0.1039209  0.2557367   0.406 0.684479    
‎ bio6        -0.2008521  0.2544308  -0.789 0.429868    
‎ bio7        -0.1953168  0.2542677  -0.768 0.442396    
‎ bio8         0.0044833  0.0248298   0.181 0.856711    
‎ bio12        0.0025515  0.0007104   3.592 0.000328 ***
‎ bio16       -0.0033142  0.0014862  -2.230 0.025750 *  
‎ bio17       -0.0055953  0.0015858  -3.528 0.000418 ***
‎ ---
‎ Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
‎ 
‎ (Dispersion parameter for binomial family taken to be 1)
‎ 
‎     Null deviance: 596.69  on 892  degrees of freedom
‎ Residual deviance: 439.21  on 884  degrees of freedom
‎ AIC: 457.21
‎ 
‎ Number of Fisher Scoring iterations: 8
```

]

]
]
---

name: H8cb22

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650).fg[]
### [GML ](#He4650).fg[]
#### [Binomilal/logit ](#He4650) <span class="bullet bullet">[&#8226;](#He4650)</span><span class="bullet bullet-active">[&#8226;](#H8cb22)</span><span class="bullet mslide32m">[&#8226;](#H15bb7)</span><span class="bullet mslide33m">[&#8226;](#H62bc4)</span><span class="bullet mslide34m">[&#8226;](#Hfcd8d)</span>.fg[].bg[]
#### [Gaussian/identity ](#H027e8)
### [Bioclim ](#Hb7208)
### [Domain ](#Hc69bc)
### [Mahalanobis ](#H0ad54)
### [MaxEnt ](#H583d1)
### [Random Forests ](#He0ae0)
### [SVM ](#H4b3dd)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Binomilal/logit .parent[.grand[GML .grand[Моделирование]]]
]

.fixprecode[

.font95[


``` r
‎ res <- MuMIn::get.models(MuMIn::dredge(gm1),subset=seq(2))
```

```
‎ Fixed term is "(Intercept)"
```

``` r
‎ gm1 <- res[[1]]
‎ summary(gm1)
```

```
‎ 
‎ Call:
‎ glm(formula = pa ~ bio1 + bio12 + bio16 + bio17 + bio5 + 1, family = binomial(link = "logit"), 
‎     data = envtrain, na.action = na.pass)
‎ 
‎ Coefficients:
‎              Estimate Std. Error z value Pr(>|z|)    
‎ (Intercept)  2.767217   1.532096   1.806 0.070893 .  
‎ bio1         0.080969   0.013643   5.935 2.95e-09 ***
‎ bio12        0.002501   0.000700   3.573 0.000353 ***
‎ bio16       -0.003297   0.001474  -2.237 0.025263 *  
‎ bio17       -0.005418   0.001545  -3.506 0.000455 ***
‎ bio5        -0.083530   0.013706  -6.094 1.10e-09 ***
‎ ---
‎ Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
‎ 
‎ (Dispersion parameter for binomial family taken to be 1)
‎ 
‎     Null deviance: 596.69  on 892  degrees of freedom
‎ Residual deviance: 440.08  on 887  degrees of freedom
‎ AIC: 452.08
‎ 
‎ Number of Fisher Scoring iterations: 7
```

]

]
]
---

name: H15bb7

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650).fg[]
### [GML ](#He4650).fg[]
#### [Binomilal/logit ](#He4650) <span class="bullet bullet">[&#8226;](#He4650)</span><span class="bullet bullet">[&#8226;](#H8cb22)</span><span class="bullet bullet-active">[&#8226;](#H15bb7)</span><span class="bullet mslide33m">[&#8226;](#H62bc4)</span><span class="bullet mslide34m">[&#8226;](#Hfcd8d)</span>.fg[].bg[]
#### [Gaussian/identity ](#H027e8)
### [Bioclim ](#Hb7208)
### [Domain ](#Hc69bc)
### [Mahalanobis ](#H0ad54)
### [MaxEnt ](#H583d1)
### [Random Forests ](#He0ae0)
### [SVM ](#H4b3dd)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Binomilal/logit .parent[.grand[GML .grand[Моделирование]]]
]

.fixprecode[



``` r
‎ (e1 <- evaluate(p=testpres,a=testbackg,model=gm1))
```

```
‎ class          : ModelEvaluation 
‎ n presences    : 23 
‎ n absences     : 200 
‎ AUC            : 0.8513043 
‎ cor            : 0.3137465 
‎ max TPR+TNR at : -2.212195 
```

``` r
‎ (tr <- threshold(e1))
```

```
‎                  thresholds
‎ kappa           -1.89928194
‎ spec_sens       -2.21219476
‎ no_omission     -3.73524089
‎ prevalence       0.09238409
‎ equal_sens_spec -1.95820072
‎ sensitivity     -2.15601451
```


]
]
---

name: H62bc4

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650).fg[]
### [GML ](#He4650).fg[]
#### [Binomilal/logit ](#He4650) <span class="bullet bullet">[&#8226;](#He4650)</span><span class="bullet bullet">[&#8226;](#H8cb22)</span><span class="bullet bullet">[&#8226;](#H15bb7)</span><span class="bullet bullet-active">[&#8226;](#H62bc4)</span><span class="bullet mslide34m">[&#8226;](#Hfcd8d)</span>.fg[].bg[]
#### [Gaussian/identity ](#H027e8)
### [Bioclim ](#Hb7208)
### [Domain ](#Hc69bc)
### [Mahalanobis ](#H0ad54)
### [MaxEnt ](#H583d1)
### [Random Forests ](#He0ae0)
### [SVM ](#H4b3dd)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Binomilal/logit .parent[.grand[GML .grand[Моделирование]]]
]

.fixprecode[



``` r
‎ (pg <- predict(predictors, gm1, ext=ext))
```

```
‎ class      : RasterLayer 
‎ dimensions : 112, 116, 12992  (nrow, ncol, ncell)
‎ resolution : 0.5, 0.5  (x, y)
‎ extent     : -90, -32, -33, 23  (xmin, xmax, ymin, ymax)
‎ crs        : +proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +no_defs 
‎ source     : memory
‎ names      : layer 
‎ values     : -11.40133, 3.161006  (min, max)
```


]
]
---

name: Hfcd8d

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650).fg[]
### [GML ](#He4650).fg[]
#### [Binomilal/logit ](#He4650) <span class="bullet bullet">[&#8226;](#He4650)</span><span class="bullet bullet">[&#8226;](#H8cb22)</span><span class="bullet bullet">[&#8226;](#H15bb7)</span><span class="bullet bullet">[&#8226;](#H62bc4)</span><span class="bullet bullet-active">[&#8226;](#Hfcd8d)</span>.fg[].bg[]
#### [Gaussian/identity ](#H027e8)
### [Bioclim ](#Hb7208)
### [Domain ](#Hc69bc)
### [Mahalanobis ](#H0ad54)
### [MaxEnt ](#H583d1)
### [Random Forests ](#He0ae0)
### [SVM ](#H4b3dd)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Binomilal/logit .parent[.grand[GML .grand[Моделирование]]]
]

.fixprecode[



``` r
‎ op <- par(mfrow=c(1,2),mar=rep(2,4))
‎ plot(pg, main='Binomial/logit, raw values')
‎ plot(World, add=TRUE, border='dark grey')
‎ plot(pg > tr$spec_sens, main='presence/absence')
‎ plot(World, add=TRUE, border='dark grey')
‎ points(backg_train, pch='x', cex=0.4,col="lightblue")
‎ points(pres_train, pch='o',cex=0.6,col="blue")
```

<img src="assets/lesson10/pgplot-1.svg" width="1330" height="360" style="display: block; margin: auto auto auto 0;" />

``` r
‎ par(op)
```


]
]
---

name: H027e8

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650).fg[]
### [GML ](#He4650).fg[]
#### [Binomilal/logit ](#He4650)
#### [Gaussian/identity ](#H027e8) <span class="bullet bullet-active">[&#8226;](#H027e8)</span><span class="bullet mslide36m">[&#8226;](#H12d6b)</span><span class="bullet mslide37m">[&#8226;](#H65d18)</span>.fg[].bg[]
### [Bioclim ](#Hb7208)
### [Domain ](#Hc69bc)
### [Mahalanobis ](#H0ad54)
### [MaxEnt ](#H583d1)
### [Random Forests ](#He0ae0)
### [SVM ](#H4b3dd)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Gaussian/identity .parent[.grand[GML .grand[Моделирование]]]
]

.fixprecode[


.font85[


``` r
‎ gm2 <- glm(pa ~ bio1 + bio5 + bio6 + bio7 + bio8 + bio12 + bio16 + bio17,
‎             family = gaussian(link = "identity"), data=envtrain, na.action=na.pass)
‎ res <- MuMIn::get.models(MuMIn::dredge(gm2) ,subset=seq(2))
```

```
‎ Fixed term is "(Intercept)"
```

``` r
‎ gm2 <- res[[1]]
‎ summary(gm2)
```

```
‎ 
‎ Call:
‎ glm(formula = pa ~ bio1 + bio12 + bio16 + bio17 + bio7 + bio8 + 
‎     1, family = gaussian(link = "identity"), data = envtrain, 
‎     na.action = na.pass)
‎ 
‎ Coefficients:
‎               Estimate Std. Error t value Pr(>|t|)    
‎ (Intercept)  3.990e-01  9.793e-02   4.075 5.02e-05 ***
‎ bio1        -2.052e-03  7.446e-04  -2.755  0.00598 ** 
‎ bio12        3.913e-04  6.753e-05   5.795 9.51e-09 ***
‎ bio16       -5.891e-04  1.363e-04  -4.321 1.73e-05 ***
‎ bio17       -6.849e-04  1.592e-04  -4.301 1.89e-05 ***
‎ bio7        -1.498e-03  3.064e-04  -4.887 1.21e-06 ***
‎ bio8         1.186e-03  6.205e-04   1.911  0.05634 .  
‎ ---
‎ Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
‎ 
‎ (Dispersion parameter for gaussian family taken to be 0.0794573)
‎ 
‎     Null deviance: 83.315  on 892  degrees of freedom
‎ Residual deviance: 70.399  on 886  degrees of freedom
‎ AIC: 281.64
‎ 
‎ Number of Fisher Scoring iterations: 2
```

]

]
]
---

name: H12d6b

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650).fg[]
### [GML ](#He4650).fg[]
#### [Binomilal/logit ](#He4650)
#### [Gaussian/identity ](#H027e8) <span class="bullet bullet">[&#8226;](#H027e8)</span><span class="bullet bullet-active">[&#8226;](#H12d6b)</span><span class="bullet mslide37m">[&#8226;](#H65d18)</span>.fg[].bg[]
### [Bioclim ](#Hb7208)
### [Domain ](#Hc69bc)
### [Mahalanobis ](#H0ad54)
### [MaxEnt ](#H583d1)
### [Random Forests ](#He0ae0)
### [SVM ](#H4b3dd)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Gaussian/identity .parent[.grand[GML .grand[Моделирование]]]
]

.fixprecode[



``` r
‎ (e2 <- evaluate(p=testpres,a=testbackg,model=gm2))
```

```
‎ class          : ModelEvaluation 
‎ n presences    : 23 
‎ n absences     : 200 
‎ AUC            : 0.8104348 
‎ cor            : 0.3586575 
‎ max TPR+TNR at : 0.1227401 
```

``` r
‎ (tr <- threshold(e2))
```

```
‎                 thresholds
‎ kappa           0.16083762
‎ spec_sens       0.12274007
‎ no_omission     0.03550278
‎ prevalence      0.10207994
‎ equal_sens_spec 0.14975670
‎ sensitivity     0.10207994
```


]
]
---

name: H65d18

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650).fg[]
### [GML ](#He4650).fg[]
#### [Binomilal/logit ](#He4650)
#### [Gaussian/identity ](#H027e8) <span class="bullet bullet">[&#8226;](#H027e8)</span><span class="bullet bullet">[&#8226;](#H12d6b)</span><span class="bullet bullet-active">[&#8226;](#H65d18)</span>.fg[].bg[]
### [Bioclim ](#Hb7208)
### [Domain ](#Hc69bc)
### [Mahalanobis ](#H0ad54)
### [MaxEnt ](#H583d1)
### [Random Forests ](#He0ae0)
### [SVM ](#H4b3dd)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Gaussian/identity .parent[.grand[GML .grand[Моделирование]]]
]

.fixprecode[



``` r
‎ pg <- predict(predictors, gm2, ext=ext)
‎ op <- par(mfrow=c(1,2),mar=rep(2,4))
‎ plot(pg, main='GLM/gaussian, raw values') 
‎ plot(World, add=TRUE, border='dark grey')
‎ plot(pg > tr$spec_sens, main='presence/absence') 
‎ plot(World, add=TRUE, border='dark grey')
‎ points(backg_train, pch='x', cex=0.4,col="lightblue")
‎ points(pres_train, pch='o',cex=0.6,col="blue")
```

<img src="assets/lesson10/gm2-1.svg" width="1330" height="360" style="display: block; margin: auto auto auto 0;" />

``` r
‎ par(op)
```


]
]
---

name: Hb7208

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650).fg[]
### [GML ](#He4650)
### [Bioclim ](#Hb7208) <span class="bullet bullet-active">[&#8226;](#Hb7208)</span><span class="bullet mslide39m">[&#8226;](#H8269a)</span><span class="bullet mslide40m">[&#8226;](#Hb4f48)</span><span class="bullet mslide41m">[&#8226;](#Hc3f3b)</span>.fg[].bg[]
### [Domain ](#Hc69bc)
### [Mahalanobis ](#H0ad54)
### [MaxEnt ](#H583d1)
### [Random Forests ](#He0ae0)
### [SVM ](#H4b3dd)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h3.broad[
Bioclim .parent[.grand[Моделирование]]
]

.fixprecode[




``` r
‎ pred_nf <- dropLayer(predictors,'biome')
‎ bc <- bioclim(x=pred_nf, p=pres_train)
```

``` r
‎ plot(bc) ## only two predictors
```

<img src="assets/lesson10/plotbc-1.svg" width="1330" height="535" style="display: block; margin: auto auto auto 0;" />


]
]
---

name: H8269a

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650).fg[]
### [GML ](#He4650)
### [Bioclim ](#Hb7208) <span class="bullet bullet">[&#8226;](#Hb7208)</span><span class="bullet bullet-active">[&#8226;](#H8269a)</span><span class="bullet mslide40m">[&#8226;](#Hb4f48)</span><span class="bullet mslide41m">[&#8226;](#Hc3f3b)</span>.fg[].bg[]
### [Domain ](#Hc69bc)
### [Mahalanobis ](#H0ad54)
### [MaxEnt ](#H583d1)
### [Random Forests ](#He0ae0)
### [SVM ](#H4b3dd)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h3.broad[
Bioclim .parent[.grand[Моделирование]]
]

.fixprecode[



``` r
‎ (e <- evaluate(p=pres_test, a=backg_test, model=bc, x=pred_nf))
```

```
‎ class          : ModelEvaluation 
‎ n presences    : 23 
‎ n absences     : 200 
‎ AUC            : 0.736413 
‎ cor            : 0.199087 
‎ max TPR+TNR at : 0.08592151 
```

``` r
‎ (tr <- threshold(e))
```

```
‎                  thresholds
‎ kappa            0.11817957
‎ spec_sens        0.08592151
‎ no_omission     -0.00010000
‎ prevalence       0.10742688
‎ equal_sens_spec  0.10742688
‎ sensitivity      0.03215806
```


]
]
---

name: Hb4f48

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650).fg[]
### [GML ](#He4650)
### [Bioclim ](#Hb7208) <span class="bullet bullet">[&#8226;](#Hb7208)</span><span class="bullet bullet">[&#8226;](#H8269a)</span><span class="bullet bullet-active">[&#8226;](#Hb4f48)</span><span class="bullet mslide41m">[&#8226;](#Hc3f3b)</span>.fg[].bg[]
### [Domain ](#Hc69bc)
### [Mahalanobis ](#H0ad54)
### [MaxEnt ](#H583d1)
### [Random Forests ](#He0ae0)
### [SVM ](#H4b3dd)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h3.broad[
Bioclim .parent[.grand[Моделирование]]
]

.fixprecode[



``` r
‎ op <- par(mar=c(4,4,1,1))
‎ response(bc) ## it's a plot
```

<img src="assets/lesson10/bcresponse-1.svg" width="1330" height="535" style="display: block; margin: auto auto auto 0;" />

``` r
‎ par(op)
```


]
]
---

name: Hc3f3b

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650).fg[]
### [GML ](#He4650)
### [Bioclim ](#Hb7208) <span class="bullet bullet">[&#8226;](#Hb7208)</span><span class="bullet bullet">[&#8226;](#H8269a)</span><span class="bullet bullet">[&#8226;](#Hb4f48)</span><span class="bullet bullet-active">[&#8226;](#Hc3f3b)</span>.fg[].bg[]
### [Domain ](#Hc69bc)
### [Mahalanobis ](#H0ad54)
### [MaxEnt ](#H583d1)
### [Random Forests ](#He0ae0)
### [SVM ](#H4b3dd)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h3.broad[
Bioclim .parent[.grand[Моделирование]]
]

.fixprecode[







``` r
‎ pb <- predict(predictors, bc, ext=ext, progress='')
‎ op <- par(mfrow=c(1,2),mar=c(2,2,2,4))
‎ plot(pb, main='Bioclim, raw values')
‎ plot(World, add=TRUE, border='dark grey')
‎ points(pres_train, pch='+')
‎ plot(pb > tr$spec_sens, main='presence/absence')
‎ plot(World, add=TRUE, border='dark grey')
‎ points(pres_train, pch='+')
```

<img src="assets/lesson10/bcplot-1.svg" width="1330" height="360" style="display: block; margin: auto auto auto 0;" />

``` r
‎ par(op)
```


]
]
---

name: Hc69bc

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650).fg[]
### [GML ](#He4650)
### [Bioclim ](#Hb7208)
### [Domain ](#Hc69bc) <span class="bullet bullet-active">[&#8226;](#Hc69bc)</span><span class="bullet mslide44m">[&#8226;](#Hb3994)</span>.fg[].bg[]
### [Mahalanobis ](#H0ad54)
### [MaxEnt ](#H583d1)
### [Random Forests ](#He0ae0)
### [SVM ](#H4b3dd)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h3.broad[
Domain .parent[.grand[Моделирование]]
]

.fixprecode[




``` r
‎ dm <- domain(pred_nf,pres_train)
‎ (e <- evaluate(pres_test, backg_test, dm, pred_nf))
```

```
‎ class          : ModelEvaluation 
‎ n presences    : 23 
‎ n absences     : 200 
‎ AUC            : 0.7951087 
‎ cor            : 0.302221 
‎ max TPR+TNR at : 0.7037708 
```

``` r
‎ (tr <- threshold(e))#, 'spec_sens')
```

```
‎                 thresholds
‎ kappa            0.7037708
‎ spec_sens        0.7037708
‎ no_omission      0.3353002
‎ prevalence       0.1072074
‎ equal_sens_spec  0.7219759
‎ sensitivity      0.5068124
```


]
]
---

name: Hb3994

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650).fg[]
### [GML ](#He4650)
### [Bioclim ](#Hb7208)
### [Domain ](#Hc69bc) <span class="bullet bullet">[&#8226;](#Hc69bc)</span><span class="bullet bullet-active">[&#8226;](#Hb3994)</span>.fg[].bg[]
### [Mahalanobis ](#H0ad54)
### [MaxEnt ](#H583d1)
### [Random Forests ](#He0ae0)
### [SVM ](#H4b3dd)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h3.broad[
Domain .parent[.grand[Моделирование]]
]

.fixprecode[



``` r
‎ pm <- predict(pred_nf,dm,ext=ext,progress='')
```

``` r
‎ op <- par(mfrow=c(1,2),mar=c(2,2,2,4))
‎ plot(pm, main='Domain, raw values')
‎ plot(World, add=TRUE, border='dark grey')
‎ points(pres_train, pch='+')
‎ plot(pm > tr$spec_sens, main='presence/absence')
‎ plot(World, add=TRUE, border='dark grey')
‎ points(pres_train, pch='+')
```

<img src="assets/lesson10/domainmap-1.svg" width="1330" height="360" style="display: block; margin: auto auto auto 0;" />

``` r
‎ par(op)
```


]
]
---

name: H0ad54

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650).fg[]
### [GML ](#He4650)
### [Bioclim ](#Hb7208)
### [Domain ](#Hc69bc)
### [Mahalanobis ](#H0ad54) <span class="bullet bullet-active">[&#8226;](#H0ad54)</span><span class="bullet mslide46m">[&#8226;](#H5d972)</span>.fg[].bg[]
### [MaxEnt ](#H583d1)
### [Random Forests ](#He0ae0)
### [SVM ](#H4b3dd)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h3.broad[
Mahalanobis .parent[.grand[Моделирование]]
]

.fixprecode[




``` r
‎ mm <- mahal(pred_nf,pres_train)  
‎ (e <- evaluate(pres_test, backg_test, mm, pred_nf))
```

```
‎ class          : ModelEvaluation 
‎ n presences    : 23 
‎ n absences     : 200 
‎ AUC            : 0.828587 
‎ cor            : 0.1342957 
‎ max TPR+TNR at : -1.517164 
```

``` r
‎ (tr <- threshold(e))#, 'spec_sens')
```

```
‎                 thresholds
‎ kappa            0.1077334
‎ spec_sens       -1.5171635
‎ no_omission     -9.1928651
‎ prevalence       0.1077334
‎ equal_sens_spec -1.9422703
‎ sensitivity     -5.9378411
```


]
]
---

name: H5d972

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650).fg[]
### [GML ](#He4650)
### [Bioclim ](#Hb7208)
### [Domain ](#Hc69bc)
### [Mahalanobis ](#H0ad54) <span class="bullet bullet">[&#8226;](#H0ad54)</span><span class="bullet bullet-active">[&#8226;](#H5d972)</span>.fg[].bg[]
### [MaxEnt ](#H583d1)
### [Random Forests ](#He0ae0)
### [SVM ](#H4b3dd)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h3.broad[
Mahalanobis .parent[.grand[Моделирование]]
]

.fixprecode[




``` r
‎ pm <- predict(pred_nf,mm,ext=ext,progress='')
```

``` r
‎ op <- par(mfrow=c(1,2),mar=c(2,2,2,4))
‎ plot(pm, main='Mahalanobis, raw values')
‎ plot(World, add=TRUE, border='dark grey')
‎ points(pres_train, pch='+')
‎ plot(pm > tr$spec_sens, main='presence/absence')
‎ plot(World, add=TRUE, border='dark grey')
‎ points(pres_train, pch='+')
```

<img src="assets/lesson10/malplot-1.svg" width="1330" height="360" style="display: block; margin: auto auto auto 0;" />

``` r
‎ par(op)
```


]
]
---

name: H583d1

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650).fg[]
### [GML ](#He4650)
### [Bioclim ](#Hb7208)
### [Domain ](#Hc69bc)
### [Mahalanobis ](#H0ad54)
### [MaxEnt ](#H583d1) <span class="bullet bullet-active">[&#8226;](#H583d1)</span><span class="bullet mslide48m">[&#8226;](#Hba2f0)</span><span class="bullet mslide49m">[&#8226;](#Hcd283)</span><span class="bullet mslide50m">[&#8226;](#Hadefb)</span>.fg[].bg[]
### [Random Forests ](#He0ae0)
### [SVM ](#H4b3dd)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h3.broad[
MaxEnt .parent[.grand[Моделирование]]
]

.fixprecode[




``` r
‎ # maxent(silent=F)
‎ xm <- maxent(predictors, pres_train, factors='biome',silent=TRUE)
```

```
‎ Loading required namespace: rJava
```

``` r
‎ plot(xm)
```

<img src="assets/lesson10/plotxm-1.svg" width="1330" height="422" style="display: block; margin: auto auto auto 0;" />


]
]
---

name: Hba2f0

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650).fg[]
### [GML ](#He4650)
### [Bioclim ](#Hb7208)
### [Domain ](#Hc69bc)
### [Mahalanobis ](#H0ad54)
### [MaxEnt ](#H583d1) <span class="bullet bullet">[&#8226;](#H583d1)</span><span class="bullet bullet-active">[&#8226;](#Hba2f0)</span><span class="bullet mslide49m">[&#8226;](#Hcd283)</span><span class="bullet mslide50m">[&#8226;](#Hadefb)</span>.fg[].bg[]
### [Random Forests ](#He0ae0)
### [SVM ](#H4b3dd)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h3.broad[
MaxEnt .parent[.grand[Моделирование]]
]

.fixprecode[



``` r
‎ response(xm) ## it's a plot
```

<img src="assets/lesson10/meresp-1.svg" width="1330" height="700" style="display: block; margin: auto auto auto 0;" />


]
]
---

name: Hcd283

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650).fg[]
### [GML ](#He4650)
### [Bioclim ](#Hb7208)
### [Domain ](#Hc69bc)
### [Mahalanobis ](#H0ad54)
### [MaxEnt ](#H583d1) <span class="bullet bullet">[&#8226;](#H583d1)</span><span class="bullet bullet">[&#8226;](#Hba2f0)</span><span class="bullet bullet-active">[&#8226;](#Hcd283)</span><span class="bullet mslide50m">[&#8226;](#Hadefb)</span>.fg[].bg[]
### [Random Forests ](#He0ae0)
### [SVM ](#H4b3dd)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h3.broad[
MaxEnt .parent[.grand[Моделирование]]
]

.fixprecode[



``` r
‎ (e <- evaluate(p=pres_test, a=backg_test, model=xm, x=predictors))
```

```
‎ class          : ModelEvaluation 
‎ n presences    : 23 
‎ n absences     : 200 
‎ AUC            : 0.8678261 
‎ cor            : 0.4315427 
‎ max TPR+TNR at : 0.4084028 
```

``` r
‎ (tr <- threshold(e)) #, 'spec_sens')
```

```
‎                 thresholds
‎ kappa           0.40840282
‎ spec_sens       0.40840282
‎ no_omission     0.05457153
‎ prevalence      0.10271222
‎ equal_sens_spec 0.46403961
‎ sensitivity     0.42879875
```


]
]
---

name: Hadefb

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650).fg[]
### [GML ](#He4650)
### [Bioclim ](#Hb7208)
### [Domain ](#Hc69bc)
### [Mahalanobis ](#H0ad54)
### [MaxEnt ](#H583d1) <span class="bullet bullet">[&#8226;](#H583d1)</span><span class="bullet bullet">[&#8226;](#Hba2f0)</span><span class="bullet bullet">[&#8226;](#Hcd283)</span><span class="bullet bullet-active">[&#8226;](#Hadefb)</span>.fg[].bg[]
### [Random Forests ](#He0ae0)
### [SVM ](#H4b3dd)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h3.broad[
MaxEnt .parent[.grand[Моделирование]]
]

.fixprecode[



``` r
‎ px <- predict(predictors,xm,ext=ext,progress='')
```


``` r
‎ op <- par(mfrow=c(1,2),mar=c(2,2,2,4))
‎ plot(px, main='Maxent, raw values')
‎ plot(World, add=TRUE, border='dark grey')
‎ points(pres_train, pch='+')
‎ plot(px > tr$spec_sens, main='presence/absence')
‎ plot(World, add=TRUE, border='dark grey')
‎ points(pres_train, pch='+')
```

<img src="assets/lesson10/meplot-1.svg" width="1330" height="360" style="display: block; margin: auto auto auto 0;" />

``` r
‎ par(op)
```


]
]
---

name: He0ae0

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650).fg[]
### [GML ](#He4650)
### [Bioclim ](#Hb7208)
### [Domain ](#Hc69bc)
### [Mahalanobis ](#H0ad54)
### [MaxEnt ](#H583d1)
### [Random Forests ](#He0ae0) <span class="bullet bullet-active">[&#8226;](#He0ae0)</span><span class="bullet mslide52m">[&#8226;](#H43e1d)</span><span class="bullet mslide53m">[&#8226;](#H34e6e)</span><span class="bullet mslide54m">[&#8226;](#Haa827)</span><span class="bullet mslide55m">[&#8226;](#Hdd854)</span>.fg[].bg[]
### [SVM ](#H4b3dd)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h3.broad[
Random Forests .parent[.grand[Моделирование]]
]

.fixprecode[




``` r
‎ require(randomForest)
```

```
‎ Loading required package: randomForest
```

```
‎ randomForest 4.7-1.2
```

```
‎ Type rfNews() to see new features/changes/bug fixes.
```

``` r
‎ model <- pa ~ bio1 + bio5 + bio6 + bio7 + bio8 + bio12 + bio16 + bio17
‎ (rf1 <- randomForest(model, data=envtrain))
```

```
‎ Warning in randomForest.default(m, y, ...): The response has five or
‎ fewer unique values.  Are you sure you want to do regression?
```

```
‎ 
‎ Call:
‎  randomForest(formula = model, data = envtrain) 
‎                Type of random forest: regression
‎                      Number of trees: 500
‎ No. of variables tried at each split: 2
‎ 
‎           Mean of squared residuals: 0.07212838
‎                     % Var explained: 22.69
```


]
]
---

name: H43e1d

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650).fg[]
### [GML ](#He4650)
### [Bioclim ](#Hb7208)
### [Domain ](#Hc69bc)
### [Mahalanobis ](#H0ad54)
### [MaxEnt ](#H583d1)
### [Random Forests ](#He0ae0) <span class="bullet bullet">[&#8226;](#He0ae0)</span><span class="bullet bullet-active">[&#8226;](#H43e1d)</span><span class="bullet mslide53m">[&#8226;](#H34e6e)</span><span class="bullet mslide54m">[&#8226;](#Haa827)</span><span class="bullet mslide55m">[&#8226;](#Hdd854)</span>.fg[].bg[]
### [SVM ](#H4b3dd)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h3.broad[
Random Forests .parent[.grand[Моделирование]]
]

.fixprecode[



``` r
‎ model <- factor(pa) ~ bio1 + bio5 + bio6 + bio7 + bio8 + bio12 + bio16 + bio17
‎ (rf2 <- randomForest(model, data=envtrain))
```

```
‎ 
‎ Call:
‎  randomForest(formula = model, data = envtrain) 
‎                Type of random forest: classification
‎                      Number of trees: 500
‎ No. of variables tried at each split: 2
‎ 
‎         OOB estimate of  error rate: 7.95%
‎ Confusion matrix:
‎     0  1 class.error
‎ 0 784 16   0.0200000
‎ 1  55 38   0.5913978
```


]
]
---

name: H34e6e

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650).fg[]
### [GML ](#He4650)
### [Bioclim ](#Hb7208)
### [Domain ](#Hc69bc)
### [Mahalanobis ](#H0ad54)
### [MaxEnt ](#H583d1)
### [Random Forests ](#He0ae0) <span class="bullet bullet">[&#8226;](#He0ae0)</span><span class="bullet bullet">[&#8226;](#H43e1d)</span><span class="bullet bullet-active">[&#8226;](#H34e6e)</span><span class="bullet mslide54m">[&#8226;](#Haa827)</span><span class="bullet mslide55m">[&#8226;](#Hdd854)</span>.fg[].bg[]
### [SVM ](#H4b3dd)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h3.broad[
Random Forests .parent[.grand[Моделирование]]
]

.fixprecode[



``` r
‎ (rf3 <- randomForest(envtrain[,1:8], factor(pb_train)))
```

```
‎ 
‎ Call:
‎  randomForest(x = envtrain[, 1:8], y = factor(pb_train)) 
‎                Type of random forest: classification
‎                      Number of trees: 500
‎ No. of variables tried at each split: 2
‎ 
‎         OOB estimate of  error rate: 0%
‎ Confusion matrix:
‎     0  1 class.error
‎ 0 800  0           0
‎ 1   0 93           0
```


]
]
---

name: Haa827

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650).fg[]
### [GML ](#He4650)
### [Bioclim ](#Hb7208)
### [Domain ](#Hc69bc)
### [Mahalanobis ](#H0ad54)
### [MaxEnt ](#H583d1)
### [Random Forests ](#He0ae0) <span class="bullet bullet">[&#8226;](#He0ae0)</span><span class="bullet bullet">[&#8226;](#H43e1d)</span><span class="bullet bullet">[&#8226;](#H34e6e)</span><span class="bullet bullet-active">[&#8226;](#Haa827)</span><span class="bullet mslide55m">[&#8226;](#Hdd854)</span>.fg[].bg[]
### [SVM ](#H4b3dd)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h3.broad[
Random Forests .parent[.grand[Моделирование]]
]

.fixprecode[



``` r
‎ (erf <- evaluate(testpres, testbackg, rf1))
```

```
‎ class          : ModelEvaluation 
‎ n presences    : 23 
‎ n absences     : 200 
‎ AUC            : 0.9084783 
‎ cor            : 0.5324386 
‎ max TPR+TNR at : 0.0819 
```

``` r
‎ (tr <- threshold(erf))
```

```
‎                 thresholds
‎ kappa           0.23456667
‎ spec_sens       0.08190000
‎ no_omission     0.06596667
‎ prevalence      0.10273333
‎ equal_sens_spec 0.11033333
‎ sensitivity     0.09296667
```


]
]
---

name: Hdd854

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650).fg[]
### [GML ](#He4650)
### [Bioclim ](#Hb7208)
### [Domain ](#Hc69bc)
### [Mahalanobis ](#H0ad54)
### [MaxEnt ](#H583d1)
### [Random Forests ](#He0ae0) <span class="bullet bullet">[&#8226;](#He0ae0)</span><span class="bullet bullet">[&#8226;](#H43e1d)</span><span class="bullet bullet">[&#8226;](#H34e6e)</span><span class="bullet bullet">[&#8226;](#Haa827)</span><span class="bullet bullet-active">[&#8226;](#Hdd854)</span>.fg[].bg[]
### [SVM ](#H4b3dd)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h3.broad[
Random Forests .parent[.grand[Моделирование]]
]

.fixprecode[



``` r
‎ pr <- predict(predictors, rf1, ext=ext)
```

``` r
‎ op <- par(mfrow=c(1,2),mar=c(2,2,2,4))
‎ plot(pr, main='Random Forest, regression')
‎ plot(World, add=TRUE, border='dark grey')
‎ plot(pr > tr$spec_sens, main='presence/absence')
‎ plot(World, add=TRUE, border='dark grey')
‎ points(pres_train, pch='+')
‎ points(backg_train, pch='-',cex=0.4)
```

<img src="assets/lesson10/rf1plot-1.svg" width="1330" height="360" style="display: block; margin: auto auto auto 0;" />

``` r
‎ par(op)
```


]
]
---

name: H4b3dd

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650).fg[]
### [GML ](#He4650)
### [Bioclim ](#Hb7208)
### [Domain ](#Hc69bc)
### [Mahalanobis ](#H0ad54)
### [MaxEnt ](#H583d1)
### [Random Forests ](#He0ae0)
### [SVM ](#H4b3dd) <span class="bullet bullet-active">[&#8226;](#H4b3dd)</span><span class="bullet mslide57m">[&#8226;](#H338b2)</span>.fg[].bg[]
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h3.broad[
SVM .parent[.grand[Моделирование]]
]

.fixprecode[



 ### Support Vector Machine (SVM)


``` r
‎ require(kernlab) |> suppressMessages()
‎ svm <- ksvm(pa ~ bio1+bio5+bio6+bio7+bio8+bio12+bio16+bio17, data=envtrain)
‎ (esv <- evaluate(p=testpres, a=testbackg, model=svm))
```

```
‎ class          : ModelEvaluation 
‎ n presences    : 23 
‎ n absences     : 200 
‎ AUC            : 0.6580435 
‎ cor            : 0.2572697 
‎ max TPR+TNR at : 0.0344006 
```

.font60[



]


``` r
‎ (tr <- threshold(esv))
```

```
‎                  thresholds
‎ kappa            0.08103368
‎ spec_sens        0.03440060
‎ no_omission     -0.01769190
‎ prevalence       0.10095988
‎ equal_sens_spec  0.02521893
‎ sensitivity      0.00388271
```


]
]
---

name: H338b2

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650).fg[]
### [GML ](#He4650)
### [Bioclim ](#Hb7208)
### [Domain ](#Hc69bc)
### [Mahalanobis ](#H0ad54)
### [MaxEnt ](#H583d1)
### [Random Forests ](#He0ae0)
### [SVM ](#H4b3dd) <span class="bullet bullet">[&#8226;](#H4b3dd)</span><span class="bullet bullet-active">[&#8226;](#H338b2)</span>.fg[].bg[]
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[


.header.h3.broad[
SVM .parent[.grand[Моделирование]]
]

.fixprecode[



``` r
‎ ps <- predict(predictors, svm, ext=ext)
```

``` r
‎ op <- par(mfrow=c(1,2),mar=c(2,2,2,4))
‎ plot(ps, main='Support Vector Machine')
‎ plot(World, add=TRUE, border='dark grey')
‎ plot(ps > tr$spec_sens, main='presence/absence')
‎ plot(World, add=TRUE, border='dark grey')
‎ points(pres_train, pch='+',cex=0.75)
‎ points(backg_train, pch='-', cex=0.25)
```

<img src="assets/lesson10/svplot-1.svg" width="1330" height="360" style="display: block; margin: auto auto auto 0;" />

``` r
‎ par(op)
```


]
]



---

name: H8e2c1

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1).fg[]
### [Находки ](#H8e2c1).fg[].bg[]
### [Среда обитания ](#H48743)
### [Модели ](#Ha345a)
### [Прогноз ](#H53b03)
]
]
.toc.mainbar.right-column.scrollable[


.header.h3.broad[
Находки .parent[.grand[Пакет **`sdm`**]]
]

.fixprecode[




``` r
‎ # require(raster)
‎ fname <- system.file("external/species.shp", package="sdm") # get the location of the species shapefile
‎ species <- sf::st_read(fname,quiet=TRUE) |> sf::as_Spatial()
```
<img src="assets/lesson10//ursa03_species.png" width="1330" height="356" bound style="display: block; margin: auto auto auto 0;" />

``` r
‎ table(species$Occurrence)
```

```
‎ 
‎   0   1 
‎ 106  94 
```


]
]
---

name: H48743

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1).fg[]
### [Находки ](#H8e2c1)
### [Среда обитания ](#H48743) <span class="bullet bullet-active">[&#8226;](#H48743)</span><span class="bullet mslide61m">[&#8226;](#Hf1c5d)</span><span class="bullet mslide62m">[&#8226;](#H68cc8)</span>.fg[].bg[]
### [Модели ](#Ha345a)
### [Прогноз ](#H53b03)
]
]
.toc.mainbar.right-column.scrollable[


.header.h3.broad[
Среда обитания .parent[.grand[Пакет **`sdm`**]]
]

.fixprecode[




``` r
‎ list1 <- list.files(path=system.file("external",package="sdm")
‎                    ,pattern='\\.asc$',full.names= T) 
‎ preds <- stack(list1)
‎ crs(preds) <- crs(species)
```
<img src="assets/lesson10//ursa05_preds.png" width="1330" height="500" bound style="display: block; margin: auto auto auto 0;" />


]
]
---

name: Hf1c5d

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1).fg[]
### [Находки ](#H8e2c1)
### [Среда обитания ](#H48743) <span class="bullet bullet">[&#8226;](#H48743)</span><span class="bullet bullet-active">[&#8226;](#Hf1c5d)</span><span class="bullet mslide62m">[&#8226;](#H68cc8)</span>.fg[].bg[]
### [Модели ](#Ha345a)
### [Прогноз ](#H53b03)
]
]
.toc.mainbar.right-column.scrollable[


.header.h3.broad[
Среда обитания .parent[.grand[Пакет **`sdm`**]]
]

.fixprecode[

.oversize[


``` r
‎ require(sdm) # ,lib.loc="C:/tmp/libs-1.1.8")
```

```
‎ Loading required package: sdm
```

```
‎ Loading required package: terra
```

```
‎ terra 1.8.29
```

```
‎ 
‎ Attaching package: 'terra'
```

```
‎ The following objects are masked from 'package:kernlab':
‎ 
‎     buffer, size
```

```
‎ sdm 1.2-55 (2025-01-11)
```

```
‎ 
‎ Attaching package: 'sdm'
```

```
‎ The following object is masked from 'package:dismo':
‎ 
‎     threshold
```

``` r
‎ # d <- sdmData(formula=Occurrence~., train=species, predictors=preds)
‎ d <- sdmData(train=species, predictors=preds)
‎ # d <- sdmData(formula=Occurrence~precipitation+temperature,train=species,predictors=preds)
‎ # d <- sdmData(formula= ~., train=species, predictors=preds)
```

]

]
]
---

name: H68cc8

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1).fg[]
### [Находки ](#H8e2c1)
### [Среда обитания ](#H48743) <span class="bullet bullet">[&#8226;](#H48743)</span><span class="bullet bullet">[&#8226;](#Hf1c5d)</span><span class="bullet bullet-active">[&#8226;](#H68cc8)</span>.fg[].bg[]
### [Модели ](#Ha345a)
### [Прогноз ](#H53b03)
]
]
.toc.mainbar.right-column.scrollable[


.header.h3.broad[
Среда обитания .parent[.grand[Пакет **`sdm`**]]
]

.fixprecode[



``` r
‎ d
```

```
‎ class                                 : sdmdata 
‎ =========================================================== 
‎ number of species                     :  1 
‎ species names                         :  Occurrence 
‎ number of features                    :  4 
‎ feature names                         :  elevation, precipitation, temperature, ... 
‎ type                                  :  Presence-Absence 
‎ has independent test data?             :  FALSE 
‎ number of records                     :  200 
‎ has Coordinates?                      :  TRUE 
```


]
]



---

name: Ha345a

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1).fg[]
### [Находки ](#H8e2c1)
### [Среда обитания ](#H48743)
### [Модели ](#Ha345a).fg[]
#### [Построение ](#Ha345a) <span class="bullet bullet-active">[&#8226;](#Ha345a)</span><span class="bullet mslide65m">[&#8226;](#Hf6a81)</span>.fg[].bg[]
#### [Характеристики ](#H07b77)
### [Прогноз ](#H53b03)
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Построение .parent[.grand[Модели .grand[Пакет **`sdm`**]]]
]

.fixprecode[


.font95[


``` r
‎ (m1 <- sdm(Occurrence~.,data=d,methods=c('glm','gam','brt')))
```

```
‎ class                                 : sdmModels 
‎ ======================================================== 
‎ number of species                     :  1 
‎ number of modelling methods           :  3 
‎ names of modelling methods            :  glm, gam, brt 
‎ ------------------------------------------
‎ model run success percentage (per species)  :
‎ ------------------------------------------
‎ method          Occurrence       
‎ ---------------------- 
‎ glm        :        100   %
‎ gam        :        100   %
‎ brt        :        100   %
‎ 
‎ ###################################################################
‎ model performance (per species), using training test dataset:
‎ -------------------------------------------------------------------------------
‎ 
‎  ## species   :  Occurrence 
‎ =========================
‎ 
‎ methods    :     AUC     |     COR     |     TSS     |     Deviance 
‎ -------------------------------------------------------------------------
‎ glm        :     0.88    |     0.7     |     0.69    |     0.83     
‎ gam        :     0.88    |     0.71    |     0.7     |     0.82     
‎ brt        :     0.94    |     0.77    |     0.76    |     0.85     
```

]

]
]
---

name: Hf6a81

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1).fg[]
### [Находки ](#H8e2c1)
### [Среда обитания ](#H48743)
### [Модели ](#Ha345a).fg[]
#### [Построение ](#Ha345a) <span class="bullet bullet">[&#8226;](#Ha345a)</span><span class="bullet bullet-active">[&#8226;](#Hf6a81)</span>.fg[].bg[]
#### [Характеристики ](#H07b77)
### [Прогноз ](#H53b03)
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Построение .parent[.grand[Модели .grand[Пакет **`sdm`**]]]
]

.fixprecode[

.font95.oversize[


``` r
‎ (m2 <- sdm(Occurrence~.,data=d
‎          ,methods=c('rf','tree','fda','mars','svm')
‎          ,replicatin='sub' # replicate.methods (data partitioning)
‎          ,test.percent=1/5*100
‎          ,n=2)) # number of replicates (each method) 
```

```
‎ class                                 : sdmModels 
‎ ======================================================== 
‎ number of species                     :  1 
‎ number of modelling methods           :  5 
‎ names of modelling methods            :  rf, cart, fda, mars, svm 
‎ replicate.methods (data partitioning) :  subsampling 
‎ number of replicates (each method)    :  2 
‎ toral number of replicates per model  :  2 (per species) 
‎ test percentage (in subsampling)      :  20 
‎ ------------------------------------------
‎ model run success percentage (per species)  :
‎ ------------------------------------------
‎ method          Occurrence       
‎ ---------------------- 
‎ rf         :        100   %
‎ cart       :        100   %
‎ fda        :        100   %
‎ mars       :        100   %
‎ svm        :        100   %
‎ 
‎ ###################################################################
‎ model Mean performance (per species), using test dataset (generated using partitioning):
‎ -------------------------------------------------------------------------------
‎ 
‎  ## species   :  Occurrence 
‎ =========================
‎ 
‎ methods    :     AUC     |     COR     |     TSS     |     Deviance 
‎ -------------------------------------------------------------------------
‎ rf         :     0.87    |     0.69    |     0.75    |     0.9      
‎ cart       :     0.86    |     0.67    |     0.66    |     0.87     
‎ fda        :     0.88    |     0.74    |     0.75    |     0.78     
‎ mars       :     0.84    |     0.62    |     0.66    |     1.02     
‎ svm        :     0.9     |     0.76    |     0.82    |     0.76     
```

]

]
]
---

name: H07b77

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1).fg[]
### [Находки ](#H8e2c1)
### [Среда обитания ](#H48743)
### [Модели ](#Ha345a).fg[]
#### [Построение ](#Ha345a)
#### [Характеристики ](#H07b77) <span class="bullet bullet-active">[&#8226;](#H07b77)</span><span class="bullet mslide67m">[&#8226;](#H18a67)</span><span class="bullet mslide68m">[&#8226;](#H88196)</span>.fg[].bg[]
### [Прогноз ](#H53b03)
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Характеристики .parent[.grand[Модели .grand[Пакет **`sdm`**]]]
]

.fixprecode[


.font79[


``` r
‎ getModelInfo(m2) |> knitr::kable()
```



| modelID|species    |method |replication | replicationID|success |training |test.dep |test.indep |
|-------:|:----------|:------|:-----------|-------------:|:-------|:--------|:--------|:----------|
|       1|Occurrence |rf     |subsampling |             1|TRUE    |TRUE     |TRUE     |FALSE      |
|       2|Occurrence |rf     |subsampling |             2|TRUE    |TRUE     |TRUE     |FALSE      |
|       3|Occurrence |cart   |subsampling |             1|TRUE    |TRUE     |TRUE     |FALSE      |
|       4|Occurrence |cart   |subsampling |             2|TRUE    |TRUE     |TRUE     |FALSE      |
|       5|Occurrence |fda    |subsampling |             1|TRUE    |TRUE     |TRUE     |FALSE      |
|       6|Occurrence |fda    |subsampling |             2|TRUE    |TRUE     |TRUE     |FALSE      |
|       7|Occurrence |mars   |subsampling |             1|TRUE    |TRUE     |TRUE     |FALSE      |
|       8|Occurrence |mars   |subsampling |             2|TRUE    |TRUE     |TRUE     |FALSE      |
|       9|Occurrence |svm    |subsampling |             1|TRUE    |TRUE     |TRUE     |FALSE      |
|      10|Occurrence |svm    |subsampling |             2|TRUE    |TRUE     |TRUE     |FALSE      |

]

]
]
---

name: H18a67

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1).fg[]
### [Находки ](#H8e2c1)
### [Среда обитания ](#H48743)
### [Модели ](#Ha345a).fg[]
#### [Построение ](#Ha345a)
#### [Характеристики ](#H07b77) <span class="bullet bullet">[&#8226;](#H07b77)</span><span class="bullet bullet-active">[&#8226;](#H18a67)</span><span class="bullet mslide68m">[&#8226;](#H88196)</span>.fg[].bg[]
### [Прогноз ](#H53b03)
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Характеристики .parent[.grand[Модели .grand[Пакет **`sdm`**]]]
]

.fixprecode[



``` r
‎ roc(m2)
```

<img src="assets/lesson10/roc-1.svg" width="1330" height="700" style="display: block; margin: auto auto auto 0;" />


]
]
---

name: H88196

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1).fg[]
### [Находки ](#H8e2c1)
### [Среда обитания ](#H48743)
### [Модели ](#Ha345a).fg[]
#### [Построение ](#Ha345a)
#### [Характеристики ](#H07b77) <span class="bullet bullet">[&#8226;](#H07b77)</span><span class="bullet bullet">[&#8226;](#H18a67)</span><span class="bullet bullet-active">[&#8226;](#H88196)</span>.fg[].bg[]
### [Прогноз ](#H53b03)
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Характеристики .parent[.grand[Модели .grand[Пакет **`sdm`**]]]
]

.fixprecode[



``` r
‎ roc(m2,smooth=T)
```

<img src="assets/lesson10/rocs-1.svg" width="1330" height="700" style="display: block; margin: auto auto auto 0;" />


]
]



---

name: H53b03

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1).fg[]
### [Находки ](#H8e2c1)
### [Среда обитания ](#H48743)
### [Модели ](#Ha345a)
### [Прогноз ](#H53b03).fg[]
#### [Индивидуальный ](#H53b03) <span class="bullet bullet-active">[&#8226;](#H53b03)</span><span class="bullet mslide71m">[&#8226;](#He8dee)</span><span class="bullet mslide72m">[&#8226;](#H71d7b)</span><span class="bullet mslide73m">[&#8226;](#H06d08)</span><span class="bullet mslide74m">[&#8226;](#H98b41)</span><span class="bullet mslide75m">[&#8226;](#Hefb32)</span><span class="bullet mslide76m">[&#8226;](#H76ba7)</span>.fg[].bg[]
#### [Ансамбли ](#Hedd6b)
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Индивидуальный .parent[.grand[Прогноз .grand[Пакет **`sdm`**]]]
]

.fixprecode[




``` r
‎ (p1 <- predict(m1,newdata=preds,filename=tempfile(fileext=".grd")))
```

```
‎ class       : SpatRaster 
‎ dimensions  : 71, 124, 3  (nrow, ncol, nlyr)
‎ resolution  : 4219.223, 4219.223  (x, y)
‎ extent      : 100975.3, 624159, 3988830, 4288395  (xmin, xmax, ymin, ymax)
‎ coord. ref. : WGS 84 / UTM zone 30N (EPSG:32630) 
‎ source      : file32fc602053b9.grd 
‎ names       : id_1__sp_O~nce__m_glm, id_2__sp_O~nce__m_gam, id_3__sp_O~nce__m_brt 
‎ min values  :            0.00376331,           0.002174899,             0.2088896 
‎ max values  :            0.99573916,           0.995700896,             0.7821212 
```



]
]
---

name: He8dee

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1).fg[]
### [Находки ](#H8e2c1)
### [Среда обитания ](#H48743)
### [Модели ](#Ha345a)
### [Прогноз ](#H53b03).fg[]
#### [Индивидуальный ](#H53b03) <span class="bullet bullet">[&#8226;](#H53b03)</span><span class="bullet bullet-active">[&#8226;](#He8dee)</span><span class="bullet mslide72m">[&#8226;](#H71d7b)</span><span class="bullet mslide73m">[&#8226;](#H06d08)</span><span class="bullet mslide74m">[&#8226;](#H98b41)</span><span class="bullet mslide75m">[&#8226;](#Hefb32)</span><span class="bullet mslide76m">[&#8226;](#H76ba7)</span>.fg[].bg[]
#### [Ансамбли ](#Hedd6b)
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Индивидуальный .parent[.grand[Прогноз .grand[Пакет **`sdm`**]]]
]

.fixprecode[



<img src="assets/lesson10//ursa07_p1.png" width="1330" height="700" bound style="display: block; margin: auto auto auto 0;" />


]
]
---

name: H71d7b

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1).fg[]
### [Находки ](#H8e2c1)
### [Среда обитания ](#H48743)
### [Модели ](#Ha345a)
### [Прогноз ](#H53b03).fg[]
#### [Индивидуальный ](#H53b03) <span class="bullet bullet">[&#8226;](#H53b03)</span><span class="bullet bullet">[&#8226;](#He8dee)</span><span class="bullet bullet-active">[&#8226;](#H71d7b)</span><span class="bullet mslide73m">[&#8226;](#H06d08)</span><span class="bullet mslide74m">[&#8226;](#H98b41)</span><span class="bullet mslide75m">[&#8226;](#Hefb32)</span><span class="bullet mslide76m">[&#8226;](#H76ba7)</span>.fg[].bg[]
#### [Ансамбли ](#Hedd6b)
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Индивидуальный .parent[.grand[Прогноз .grand[Пакет **`sdm`**]]]
]

.fixprecode[



``` r
‎ (p2 <- predict(m2,newdata=preds,filename=tempfile(fileext=".grd")))
```

```
‎ class       : SpatRaster 
‎ dimensions  : 71, 124, 10  (nrow, ncol, nlyr)
‎ resolution  : 4219.223, 4219.223  (x, y)
‎ extent      : 100975.3, 624159, 3988830, 4288395  (xmin, xmax, ymin, ymax)
‎ coord. ref. : WGS 84 / UTM zone 30N (EPSG:32630) 
‎ source      : file32fc6f467a14.grd 
‎ names       : id_1_~_subs, id_2_~_subs, id_3_~_subs, id_4_~_subs, id_5_~_subs, id_6_~_subs, ... 
‎ min values  :   0.0048500,     0.00290,   0.0000000,    0.000000, 0.001863041, 0.001091335, ... 
‎ max values  :   0.9980167,     0.99585,   0.9705882,    0.972973, 0.996974468, 0.998476267, ... 
```


]
]
---

name: H06d08

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1).fg[]
### [Находки ](#H8e2c1)
### [Среда обитания ](#H48743)
### [Модели ](#Ha345a)
### [Прогноз ](#H53b03).fg[]
#### [Индивидуальный ](#H53b03) <span class="bullet bullet">[&#8226;](#H53b03)</span><span class="bullet bullet">[&#8226;](#He8dee)</span><span class="bullet bullet">[&#8226;](#H71d7b)</span><span class="bullet bullet-active">[&#8226;](#H06d08)</span><span class="bullet mslide74m">[&#8226;](#H98b41)</span><span class="bullet mslide75m">[&#8226;](#Hefb32)</span><span class="bullet mslide76m">[&#8226;](#H76ba7)</span>.fg[].bg[]
#### [Ансамбли ](#Hedd6b)
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Индивидуальный .parent[.grand[Прогноз .grand[Пакет **`sdm`**]]]
]

.fixprecode[


<img src="assets/lesson10//ursa09_p2.png" width="1330" height="700" bound style="display: block; margin: auto auto auto 0;" />


]
]
---

name: H98b41

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1).fg[]
### [Находки ](#H8e2c1)
### [Среда обитания ](#H48743)
### [Модели ](#Ha345a)
### [Прогноз ](#H53b03).fg[]
#### [Индивидуальный ](#H53b03) <span class="bullet bullet">[&#8226;](#H53b03)</span><span class="bullet bullet">[&#8226;](#He8dee)</span><span class="bullet bullet">[&#8226;](#H71d7b)</span><span class="bullet bullet">[&#8226;](#H06d08)</span><span class="bullet bullet-active">[&#8226;](#H98b41)</span><span class="bullet mslide75m">[&#8226;](#Hefb32)</span><span class="bullet mslide76m">[&#8226;](#H76ba7)</span>.fg[].bg[]
#### [Ансамбли ](#Hedd6b)
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Индивидуальный .parent[.grand[Прогноз .grand[Пакет **`sdm`**]]]
]

.fixprecode[

.font94[


``` r
‎ (p2m <- predict(m2,newdata=preds,mean=T,filename=tempfile(fileext=".grd")))
```

```
‎ class       : SpatRaster 
‎ dimensions  : 71, 124, 5  (nrow, ncol, nlyr)
‎ resolution  : 4219.223, 4219.223  (x, y)
‎ extent      : 100975.3, 624159, 3988830, 4288395  (xmin, xmax, ymin, ymax)
‎ coord. ref. : WGS 84 / UTM zone 30N (EPSG:32630) 
‎ source      : file32fc15f148bd.grd 
‎ names       : sp_Occ~e_subs, sp_Occ~e_subs, sp_Occ~e_subs, sp_Occ~e_subs, sp_Occ~e_subs 
‎ min values  :     0.0060750,     0.0000000,   0.001477188,   0.002498658,    0.08281051 
‎ max values  :     0.9961417,     0.9717806,   0.997725368,   0.994826734,    0.92775464 
```

``` r
‎ (u2m <- ursa::as_ursa(p2m))
```

```
‎                               name mean  sd  sum   min max    n  nNA
‎ [1] sp_Occurrence__m_rf__re_subs    0.5 0.3 2639 0.006 1.0 5108 3696
‎ [2] sp_Occurrence__m_cart__re_subs  0.5 0.4 2605 0.000 1.0 5108 3696
‎ [3] sp_Occurrence__m_fda__re_subs   0.5 0.3 2377 0.001 1.0 5108 3696
‎ [4] sp_Occurrence__m_mars__re_subs  0.5 0.3 2639 0.002 1.0 5108 3696
‎ [5] sp_Occurrence__m_svm__re_subs   0.5 0.3 2542 0.083 0.9 5108 3696
```

]
.footer[



]

]
]
---

name: Hefb32

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1).fg[]
### [Находки ](#H8e2c1)
### [Среда обитания ](#H48743)
### [Модели ](#Ha345a)
### [Прогноз ](#H53b03).fg[]
#### [Индивидуальный ](#H53b03) <span class="bullet bullet">[&#8226;](#H53b03)</span><span class="bullet bullet">[&#8226;](#He8dee)</span><span class="bullet bullet">[&#8226;](#H71d7b)</span><span class="bullet bullet">[&#8226;](#H06d08)</span><span class="bullet bullet">[&#8226;](#H98b41)</span><span class="bullet bullet-active">[&#8226;](#Hefb32)</span><span class="bullet mslide76m">[&#8226;](#H76ba7)</span>.fg[].bg[]
#### [Ансамбли ](#Hedd6b)
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Индивидуальный .parent[.grand[Прогноз .grand[Пакет **`sdm`**]]]
]

.fixprecode[


<img src="assets/lesson10//ursa11_p2m.png" width="1330" height="700" bound style="display: block; margin: auto auto auto 0;" />


]
]
---

name: H76ba7

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1).fg[]
### [Находки ](#H8e2c1)
### [Среда обитания ](#H48743)
### [Модели ](#Ha345a)
### [Прогноз ](#H53b03).fg[]
#### [Индивидуальный ](#H53b03) <span class="bullet bullet">[&#8226;](#H53b03)</span><span class="bullet bullet">[&#8226;](#He8dee)</span><span class="bullet bullet">[&#8226;](#H71d7b)</span><span class="bullet bullet">[&#8226;](#H06d08)</span><span class="bullet bullet">[&#8226;](#H98b41)</span><span class="bullet bullet">[&#8226;](#Hefb32)</span><span class="bullet bullet-active">[&#8226;](#H76ba7)</span>.fg[].bg[]
#### [Ансамбли ](#Hedd6b)
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Индивидуальный .parent[.grand[Прогноз .grand[Пакет **`sdm`**]]]
]

.fixprecode[



``` r
‎ class(p2m)
```

```
‎ [1] "SpatRaster"
‎ attr(,"package")
‎ [1] "terra"
```

``` r
‎ if (inherits(p2m,"RasterBrick")) raster::getZ(p2m) else names(p2m)
```

```
‎ [1] "sp_Occurrence__m_rf__re_subs"   "sp_Occurrence__m_cart__re_subs"
‎ [3] "sp_Occurrence__m_fda__re_subs"  "sp_Occurrence__m_mars__re_subs"
‎ [5] "sp_Occurrence__m_svm__re_subs" 
```


]
]
---

name: Hedd6b

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1).fg[]
### [Находки ](#H8e2c1)
### [Среда обитания ](#H48743)
### [Модели ](#Ha345a)
### [Прогноз ](#H53b03).fg[]
#### [Индивидуальный ](#H53b03)
#### [Ансамбли ](#Hedd6b) <span class="bullet bullet-active">[&#8226;](#Hedd6b)</span><span class="bullet mslide78m">[&#8226;](#H91025)</span><span class="bullet mslide79m">[&#8226;](#He6056)</span>.fg[].bg[]
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Ансамбли .parent[.grand[Прогноз .grand[Пакет **`sdm`**]]]
]

.fixprecode[




``` r
‎ (e1 <- ensemble(m1,newdata=preds,filename=tempfile(fileext=".grd")
‎               ,setting=list(method='weighted',stat='AUC')))
```

```
‎ class      : RasterLayer 
‎ dimensions : 71, 124, 8804  (nrow, ncol, ncell)
‎ resolution : 4219.223, 4219.223  (x, y)
‎ extent     : 100975.3, 624159, 3988830, 4288395  (xmin, xmax, ymin, ymax)
‎ crs        : +proj=utm +zone=30 +datum=WGS84 +units=m +no_defs 
‎ source     : file32fc427d483b.grd 
‎ names      : ensemble_weighted 
‎ values     : -3.194461e+38, 3.393843e+38  (min, max)
```
<img src="assets/lesson10//ursa13_e1.png" width="1330" height="320" bound style="display: block; margin: auto auto auto 0;" />


]
]
---

name: H91025

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1).fg[]
### [Находки ](#H8e2c1)
### [Среда обитания ](#H48743)
### [Модели ](#Ha345a)
### [Прогноз ](#H53b03).fg[]
#### [Индивидуальный ](#H53b03)
#### [Ансамбли ](#Hedd6b) <span class="bullet bullet">[&#8226;](#Hedd6b)</span><span class="bullet bullet-active">[&#8226;](#H91025)</span><span class="bullet mslide79m">[&#8226;](#He6056)</span>.fg[].bg[]
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Ансамбли .parent[.grand[Прогноз .grand[Пакет **`sdm`**]]]
]

.fixprecode[



``` r
‎ (e2 <- ensemble(m2,newdata=preds,filename=tempfile(fileext=".grd")
‎               ,setting=list(method='weighted',stat='TSS',opt=2)))
```

```
‎ class      : RasterLayer 
‎ dimensions : 71, 124, 8804  (nrow, ncol, ncell)
‎ resolution : 4219.223, 4219.223  (x, y)
‎ extent     : 100975.3, 624159, 3988830, 4288395  (xmin, xmax, ymin, ymax)
‎ crs        : +proj=utm +zone=30 +datum=WGS84 +units=m +no_defs 
‎ source     : file32fc37b794d.grd 
‎ names      : ensemble_weighted 
‎ values     : -3.358053e+38, 3.399499e+38  (min, max)
```
<img src="assets/lesson10//ursa14_e2.png" width="1330" height="320" bound style="display: block; margin: auto auto auto 0;" />


]
]
---

name: He6056

.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1).fg[]
### [Находки ](#H8e2c1)
### [Среда обитания ](#H48743)
### [Модели ](#Ha345a)
### [Прогноз ](#H53b03).fg[]
#### [Индивидуальный ](#H53b03)
#### [Ансамбли ](#Hedd6b) <span class="bullet bullet">[&#8226;](#Hedd6b)</span><span class="bullet bullet">[&#8226;](#H91025)</span><span class="bullet bullet-active">[&#8226;](#He6056)</span>.fg[].bg[]
]
]
.toc.mainbar.right-column.scrollable[


.header.h4.broad[
Ансамбли .parent[.grand[Прогноз .grand[Пакет **`sdm`**]]]
]

.fixprecode[



``` r
‎ (e3 <- ensemble(m2,newdata=preds,filename=tempfile(fileext=".grd")
‎               ,setting=list(method='unweighted')))
```

```
‎ class      : RasterLayer 
‎ dimensions : 71, 124, 8804  (nrow, ncol, ncell)
‎ resolution : 4219.223, 4219.223  (x, y)
‎ extent     : 100975.3, 624159, 3988830, 4288395  (xmin, xmax, ymin, ymax)
‎ crs        : +proj=utm +zone=30 +datum=WGS84 +units=m +no_defs 
‎ source     : file32fc6c8e5924.grd 
‎ names      : ensemble_unweighted 
‎ values     : -3.334174e+38, 3.40233e+38  (min, max)
```
<img src="assets/lesson10//ursa15_e3.png" width="1330" height="320" bound style="display: block; margin: auto auto auto 0;" />



]
]
---
name: beforefinalizing


.toc.sidebar.left-column[
.outline[
## [Подготовка ](#H87b17)
## [Моделирование ](#He4650)
## [Пакет **`sdm`** ](#H8e2c1)
]
]
.toc.mainbar.right-column.scrollable[




]


---
name: endofslideshow
class: right bottom notable blackout
.endofslideshow[]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://nplatonov.github.io/site_libs/remark.js/remark-latest.min.js"></script>
<script src="https://nplatonov.github.io/site_libs/moon_reader-before.js"></script>
<script>var slideshow = remark.create({
  "countIncrementalSlides": false,
  "slideNumberFormat": "<div class=\"custom-slide-number\" data-total=\"%total%\" data-current=\"%current%\"></div>",
  "ratio": "29:18",
  "navigation": {
    "scroll": true,
    "click": false,
    "touch": true
  },
  "highlightLines": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script src="https://nplatonov.github.io/site_libs/moon_reader-after.js"></script>

  </body>
</html>
