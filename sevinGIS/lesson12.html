<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>ГИС 12</title>

<script src="https://nplatonov.github.io/site_libs/header-attrs-2.29/header-attrs.js"></script>
<link href="https://nplatonov.github.io/site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="https://nplatonov.github.io/site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="https://nplatonov.github.io/site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="https://nplatonov.github.io/site_libs/datatables-binding-0.33/datatables.js"></script>
<script src="https://nplatonov.github.io/site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="https://nplatonov.github.io/site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="https://nplatonov.github.io/site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="https://nplatonov.github.io/site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="https://nplatonov.github.io/site_libs/dt-ext-scroller-1.13.6/css/scroller.dataTables.min.css" rel="stylesheet" />
<script src="https://nplatonov.github.io/site_libs/dt-ext-scroller-1.13.6/js/dataTables.scroller.min.js"></script>
<link href="https://nplatonov.github.io/site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="https://nplatonov.github.io/site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
      .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="https://nplatonov.github.io/site_libs/common.css" type="text/css" />
<link rel="stylesheet" href="https://nplatonov.github.io/site_libs/html_vignette.css" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Обработка данных с геопозиционированием</h1>
<h3 class="subtitle">ГИС технологии в биологических исследованиях</h3>
<h4 class="author">Никита Платонов</h4>
<address class="author_afil">
с.н.с. ИПЭЭ РАН</address><br><h4 class="date"><span class="what">Занятие 12</span> <span class="when"> <span class="updated">Обновлено: 2025-02-05 16:59</span></span></h4>


<div id="TOC">
<ul>
<li><a href="#%D1%81%D0%B1%D0%BE%D1%80-%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85" id="toc-сбор-данных">Сбор данных</a>
<ul>
<li><a href="#hiddentoc-goodies" id="toc-hiddentoc-goodies">Goodies</a></li>
</ul></li>
<li><a href="#skip-data" id="toc-skip-data">Переброс данных</a>
<ul>
<li><a href="#%D0%B8%D0%B7-%D1%83%D1%87%D1%91%D1%82%D0%BD%D0%BE%D0%B3%D0%BE-%D0%BB%D0%B8%D1%81%D1%82%D0%B0" id="toc-из-учётного-листа">Из учётного листа</a></li>
<li><a href="#gps" id="toc-gps">С GPS</a></li>
<li><a href="#%D1%81-%D1%84%D0%BE%D1%82%D0%BE%D0%B0%D0%BF%D0%BF%D0%B0%D1%80%D0%B0%D1%82%D0%B0" id="toc-с-фотоаппарата">С фотоаппарата</a></li>
<li><a href="#%D0%BF%D0%BE%D1%81%D0%BB%D0%B5-%D0%B0%D0%B2%D0%B8%D0%B0%D1%83%D1%87%D1%91%D1%82%D0%B0" id="toc-после-авиаучёта">После авиаучёта</a></li>
</ul></li>
<li><a href="#%D1%82%D1%80%D0%B5%D0%BA%D0%B8" id="toc-треки">Треки</a>
<ul>
<li><a href="#%D0%BE%D0%B1%D1%8A%D0%B5%D0%B4%D0%B8%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5-%D1%84%D1%80%D0%B0%D0%B3%D0%BC%D0%B5%D0%BD%D1%82%D0%BE%D0%B2" id="toc-объединение-фрагментов">Объединение фрагментов</a></li>
<li><a href="#%D0%B2%D0%B8%D0%B7%D1%83%D0%B0%D0%BB%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F" id="toc-визуализация">Визуализация</a></li>
</ul></li>
<li><a href="#%D0%BD%D0%B0%D1%85%D0%BE%D0%B4%D0%BA%D0%B8" id="toc-находки">Находки</a>
<ul>
<li><a href="#%D0%B2%D1%80%D0%B5%D0%BC%D1%8F" id="toc-время">Время</a>
<ul>
<li><a href="#%D0%BF%D0%BE-gps" id="toc-по-gps">по GPS</a></li>
<li><a href="#%D0%BF%D0%BE-%D1%84%D0%BE%D1%82%D0%BE%D0%B3%D1%80%D0%B0%D1%84%D0%B8%D0%B8" id="toc-по-фотографии">по фотографии</a></li>
<li><a href="#%D0%BD%D0%B0%D0%BF%D1%80%D1%8F%D0%BC%D1%83%D1%8E" id="toc-напрямую">напрямую</a></li>
</ul></li>
<li><a href="#%D0%BA%D0%BE%D0%BE%D1%80%D0%B4%D0%B8%D0%BD%D0%B0%D1%82%D1%8B" id="toc-координаты">Координаты</a>
<ul>
<li><a href="#%D0%B8%D0%B7-gps-%D0%BC%D0%B5%D1%82%D0%BA%D0%B8" id="toc-из-gps-метки">из GPS метки</a></li>
<li><a href="#%D0%B8%D0%B7-%D0%BF%D1%83%D1%82%D0%B5%D0%B2%D0%BE%D0%B3%D0%BE-%D1%82%D1%80%D0%B5%D0%BA%D0%B0" id="toc-из-путевого-трека">из путевого трека</a></li>
</ul></li>
<li><a href="#%D0%BF%D0%B5%D0%BB%D0%B5%D0%BD%D0%B3%D0%B0%D1%86%D0%B8%D1%8F" id="toc-пеленгация">Пеленгация</a></li>
<li><a href="#hiddentoc-crd" id="toc-hiddentoc-crd">План «Б»</a></li>
<li><a href="#%D1%8D%D0%BA%D1%81%D0%BF%D0%BE%D1%80%D1%82-%D0%B4%D0%BB%D1%8F-%D0%B3%D0%B8%D1%81" id="toc-экспорт-для-гис">Экспорт для ГИС</a></li>
<li><a href="#%D0%B2%D0%B8%D0%B7%D1%83%D0%B0%D0%BB%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F-1" id="toc-визуализация-1">Визуализация</a></li>
</ul></li>
<li><a href="#%D0%BE%D0%BA%D1%80%D1%83%D0%B6%D0%B0%D1%8E%D1%89%D0%B0%D1%8F-%D1%81%D1%80%D0%B5%D0%B4%D0%B0" id="toc-окружающая-среда">Окружающая среда</a>
<ul>
<li><a href="#%D0%B2%D0%B8%D0%B7%D1%83%D0%B0%D0%BB%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F-2" id="toc-визуализация-2">Визуализация</a></li>
</ul></li>
<li><a href="#%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7" id="toc-анализ">Анализ</a>
<ul>
<li><a href="#dist2coast" id="toc-dist2coast">Расстояние до берега</a>
<ul>
<li><a href="#%D0%BF%D0%BE-%D0%B2%D1%81%D0%B5%D0%BC%D1%83-%D1%80%D0%B5%D0%B3%D0%B8%D0%BE%D0%BD%D1%83" id="toc-по-всему-региону">по всему региону</a></li>
<li><a href="#%D0%B4%D0%BB%D1%8F-%D0%BD%D0%B0%D1%85%D0%BE%D0%B4%D0%BE%D0%BA" id="toc-для-находок">для находок</a></li>
</ul></li>
</ul></li>
</ul>
</div>

<div id="сбор-данных" class="section level1">
<h1>Сбор данных</h1>
<div id="tips-tricks" class="section level2 unlisted unnumbered">
<h2 class="unlisted unnumbered">Tips &amp; tricks</h2>
<div class="zont86">
<div class="pulling">
<div class="pull-left-55">
<h4 class="toc-ignore unnumbered unlisted">
Интернет
</h4>
<p>Рассчитывать на него не стоит</p>
<ul>
<li><p>Всё необходимое скачать до рейса</p></li>
<li><p>Отключить обновления на <svg aria-hidden="true" role="img" viewBox="0 0 640 512" style="height:1em;width:1.25em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M384 96V320H64L64 96H384zM64 32C28.7 32 0 60.7 0 96V320c0 35.3 28.7 64 64 64H181.3l-10.7 32H96c-17.7 0-32 14.3-32 32s14.3 32 32 32H352c17.7 0 32-14.3 32-32s-14.3-32-32-32H277.3l-10.7-32H384c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zm464 0c-26.5 0-48 21.5-48 48V432c0 26.5 21.5 48 48 48h64c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48H528zm16 64h32c8.8 0 16 7.2 16 16s-7.2 16-16 16H544c-8.8 0-16-7.2-16-16s7.2-16 16-16zm-16 80c0-8.8 7.2-16 16-16h32c8.8 0 16 7.2 16 16s-7.2 16-16 16H544c-8.8 0-16-7.2-16-16zm32 160a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"/></svg> и <svg aria-hidden="true" role="img" viewBox="0 0 384 512" style="height:1em;width:0.75em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M16 64C16 28.7 44.7 0 80 0H304c35.3 0 64 28.7 64 64V448c0 35.3-28.7 64-64 64H80c-35.3 0-64-28.7-64-64V64zM144 448c0 8.8 7.2 16 16 16h64c8.8 0 16-7.2 16-16s-7.2-16-16-16H160c-8.8 0-16 7.2-16 16zM304 64H80V384H304V64z"/></svg>.</p></li>
<li><p><svg aria-hidden="true" role="img" viewBox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M92.1 254.6c0 24.9 7 49.2 20.2 70.1l3.1 5-13.3 48.6L152 365.2l4.8 2.9c20.2 12 43.4 18.4 67.1 18.4h.1c72.6 0 133.3-59.1 133.3-131.8c0-35.2-15.2-68.3-40.1-93.2c-25-25-58-38.7-93.2-38.7c-72.7 0-131.8 59.1-131.9 131.8zM274.8 330c-12.6 1.9-22.4 .9-47.5-9.9c-36.8-15.9-61.8-51.5-66.9-58.7c-.4-.6-.7-.9-.8-1.1c-2-2.6-16.2-21.5-16.2-41c0-18.4 9-27.9 13.2-32.3c.3-.3 .5-.5 .7-.8c3.6-4 7.9-5 10.6-5c2.6 0 5.3 0 7.6 .1c.3 0 .5 0 .8 0c2.3 0 5.2 0 8.1 6.8c1.2 2.9 3 7.3 4.9 11.8c3.3 8 6.7 16.3 7.3 17.6c1 2 1.7 4.3 .3 6.9c-3.4 6.8-6.9 10.4-9.3 13c-3.1 3.2-4.5 4.7-2.3 8.6c15.3 26.3 30.6 35.4 53.9 47.1c4 2 6.3 1.7 8.6-1c2.3-2.6 9.9-11.6 12.5-15.5c2.6-4 5.3-3.3 8.9-2s23.1 10.9 27.1 12.9c.8 .4 1.5 .7 2.1 1c2.8 1.4 4.7 2.3 5.5 3.6c.9 1.9 .9 9.9-2.4 19.1c-3.3 9.3-19.1 17.7-26.7 18.8zM448 96c0-35.3-28.7-64-64-64H64C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V96zM148.1 393.9L64 416l22.5-82.2c-13.9-24-21.2-51.3-21.2-79.3C65.4 167.1 136.5 96 223.9 96c42.4 0 82.2 16.5 112.2 46.5c29.9 30 47.9 69.8 47.9 112.2c0 87.4-72.7 158.5-160.1 158.5c-26.6 0-52.7-6.7-75.8-19.3z"/></svg> надежнее <svg aria-hidden="true" role="img" viewBox="0 0 496 512" style="height:1em;width:0.97em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M248,8C111.033,8,0,119.033,0,256S111.033,504,248,504,496,392.967,496,256,384.967,8,248,8ZM362.952,176.66c-3.732,39.215-19.881,134.378-28.1,178.3-3.476,18.584-10.322,24.816-16.948,25.425-14.4,1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25,5.342-39.5,3.652-3.793,67.107-61.51,68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608,69.142-14.845,10.194-26.894,9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7,18.45-13.7,108.446-47.248,144.628-62.3c68.872-28.647,83.183-33.623,92.511-33.789,2.052-.034,6.639.474,9.61,2.885a10.452,10.452,0,0,1,3.53,6.716A43.765,43.765,0,0,1,362.952,176.66Z"/></svg> при малой пропускной способности</p></li>
</ul>
<h4 class="toc-ignore unnumbered unlisted">
Часовой пояс
</h4>
<ul>
<li><p>Зафиксировать с момента начала до момента окончания рейса для всех участников и всех устройств на вахте</p>
<ul>
<li>UTC, если судовое время меняется в течение рейса</li>
</ul>
<p><!-- + любой, но неизменный --></p>
<ul>
<li>судовое время, если оно не меняется.</li>
</ul></li>
</ul>
<h4 class="toc-ignore unnumbered unlisted">
GPS
</h4>
<ul>
<li><p>Запись трека разными приборами (потеря сигнала, разряд батарей)</p></li>
<li><p>Задать часовой пояс</p></li>
</ul>
</div>
<div class="pull-right-45">
<h4 class="toc-ignore unnumbered unlisted">
Фотоаппарат
</h4>
<ul>
<li><p>EXIF нужен</p></li>
<li><p>Время и часовой пояс по GPS</p></li>
</ul>
<h4 class="toc-ignore unnumbered unlisted">
Смартфон, часы
</h4>
<ul>
<li>🤷 Удобнее судовое время</li>
</ul>
<h4 class="toc-ignore unnumbered unlisted">
Диктофон
</h4>
<ul>
<li>Время и часовой пояс по GPS</li>
</ul>
<h4 class="toc-ignore unnumbered unlisted">
Учётный лист
</h4>
<ul>
<li><p>Карандаш</p></li>
<li><p>Время начала и окончания вахты</p></li>
<li><div class="clarify">
<p>Ширина учётной полосы (при каждом изменении)
<!--
   + Все животные могут быть идентифицированы
   
   + Параметр для оценки плотности
--></p>
</div></li>
</ul>
</div>
</div>
</div>
</div>
<div id="hiddentoc-goodies" class="section level2 blackout">
<h2 class="blackout">Goodies</h2>
<ul>
<li><p>Настолки</p></li>
<li><p>Вкусняшки</p></li>
<li><p>Сигареты</p></li>
<li><p>🍾 (не афишируем)</p></li>
</ul>
</div>
<div id="наблюдения" class="section level2 unlisted unnumbered">
<h2 class="unlisted unnumbered">Наблюдения</h2>
<p class="centered-image"><img src="assets/lesson12/bridge.jpg" width="614" height="670" contain /></p>
</div>
<div id="protocol" class="section level2 unlisted unnumbered">
<h2 class="unlisted unnumbered">Регистрация находок</h2>
<div class="blackout">
<p class="centered-image"><img src="assets/lesson12/records.jpg" width="1024" height="670" contain /></p>
</div>
<div class="double blackout">
<p class="centered-image"><img src="assets/lesson12/records1.jpg" width="480" /></p>
<p class="centered-image"><img src="assets/lesson12/records2.jpg" width="480" /></p>
</div>
<div class="blackout">
<p class="centered-image"><img src="assets/lesson12/records.jpg" width="1024" height="670" contain /></p>
</div>
<p>Важно отметить время любым способом:</p>
<ul>
<li><p>Поставить метку GPS, ввести в запись три цифры метки</p></li>
<li><p>Сделать фотографию (пусть даже «отбивку»), ввести в запись четыре цифры фото или диапазон номеров фото серийной съемки.</p></li>
<li><p>Выписать время (стараться до секунд) с GPS или наручных часов</p></li>
</ul>
<p>GPS пишет маршрут. При записи маршрута фиксируются и координаты, и время. По известному времени находки оцениваются её координаты.</p>
</div>
</div>
<div id="skip-data" class="section level1 focus">
<h1 class="focus">Переброс данных</h1>
<div id="из-учётного-листа" class="section level2">
<h2>Из учётного листа</h2>
<div id="findings" class="hiddenanchor">
 
</div>
<div id="findings" class="section level3 unlisted unnumbered">
<h3 class="unlisted unnumbered">Таблица находок</h3>
<div class="protocol">
<div class="datatables html-widget html-fill-item" id="htmlwidget-75db6349eeddd1237ca9" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-75db6349eeddd1237ca9">{"x":{"filter":"none","vertical":false,"extensions":["Scroller"],"data":[["2023-07-06",null,null,null,null,null,null,null,null,null,null,null,null,null,"2023-07-07",null,"2023-07-08",null,"2023-07-09",null,"2023-07-10",null,null,"2023-07-11",null,"2023-07-12",null,null,null,"2023-07-13",null,null,null,null,null,null,null,null,null,null,null,"2023-07-14",null,null,null,null,null,null,null,"2023-07-15",null,null,null,"2023-07-16",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"2023-07-17",null,"2023-07-18",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"2023-07-19",null,"2023-07-20",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"2023-07-21",null,null,null,null,null,null,"2023-07-22",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"2023-07-23",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"2023-07-24",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,"Ход","Ход","Ход","Ход","Ход","Ход","Ход","Ход","Ход","Ход","Ход","Ход","Ход",null,null,null,"Ход",null,"Ход",null,"Авиа","Авиа",null,null,null,"Рейд","Рейд","Рейд",null,"Ход","Ход","Ход","Ход","Рейд","Рейд","Рейд","Рейд",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"16:20",null,"01:12",null,null,"05:28",null,null,null,"04:04","04:58","05:01",null,"04:03",null,"04:47","06:32","06:53","13:47","15:40","21:18","21:20","21:31","22:38",null,"03:19","03:44",null,"15:00","15:00","19:33","19:47",null,"09:30","14:59","19:28",null,"01:53",null,"03:12","03:16","03:55",null,"04:03",null,"04:59","06:06","06:20","07:15","07:27","07:56","08:07","08:12","08:12","08:13","08:13","08:12","08:13","08:13","08:13","08:13","08:13","08:13","08:13","08:13","08:14","08:14","08:14","08:00","08:16","08:16","08:18","08:19","08:20","08:23","08:23","08:24","08:24","08:26","08:26","08:26","08:37","08:41","08:49",null,null,null,null,null,null,null,"08:34",null,null,null,null,null,null,null,null,null,null,"10:40",null,"07:06",null,"01:09","01:08","01:14",null,"01:20",null,null,null,null,"01:40","01:43","01:46",null,"01:52","01:52","01:52","01:52","01:52","01:52","01:52",null,"01:54",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"02:09",null,"02:13","02:18",null,null,"02:19",null,null,null,null,null,null,"02:59",null,"03:19","03:28",null,null,null,null,null,null,"03:57",null,null,null,"04:03",null,null,null,null,null,null,"04:33",null,null,"05:01",null,null,null,"08:09","08:10","14:39",null,"15:15","15:22","15:29","17:45","17:47","18:15","20:30","20:57","23:31","23:35",null,null,null,"04:12","04:15",null,null,null,null,null,"14:25",null,null,null,null,null,"14:22","14:22","14:21",null,"13:53",null,null,null,null,null,"16:30","16:35","16:47",null,"01:14",null,"02:55","02:59","17:15",null,null,"06:46","08:11","08:21","08:22","08:30","08:31","10:23","12:45",null,null,null,null,"18:59","19:03","19:08","19:33","19:47","20:23","20:47","20:56",null,null,null,"00:38","00:38",null,null,null,null,"00:42","05:08",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"09:19","10:15","10:19",null,"10:53","11:14",null,null,null,null,null,null,null,null,null,null,null,"06:34","06:41","06:41",null,null,null,"10:10","13:16","13:21","15:15","15:20","15:33","15:48","15:48","17:18",null],[null,"П","П","Б","Б","Б","Б","Б","Б","Б","Б","Б","Б","Б",null,null,null,"П",null,"П",null,"П","ПЭ",null,null,null,"ПМ","Б","Б",null,"П","П","П","Б","Б","П","П","Н","НЭ","Н","Н",null,"П","П","ПШ","ПШ","ПШ","Б","Б",null,"ПЭ","П","ПЭ",null,"П","П","П","П","П","П","П","П","П","Б","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","Б левый","П правый","П правый","П правый","П правый","П правый","П правый","П правый","П правый","П правый","П правый","П правый","П правый","П правый","П правый","П правый","П правый","П правый","П правый","БЭ",null,"БН",null,"П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","ПЭ","П","Б","П","П","П","П","П","Б","Б","Б","Б","Б","Н","Н",null,null,null,"П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П",null,"П","П","П","П","ПЭ","Э",null,"Б","Б","Б","Б","Б","Б","НЭ","ПЭ","П","П","П","П","Б","Б","Б","Б","Б","Б","Б","Б",null,null,"П","Б","Н","Н","П","П","П","Б","Б","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","П","Б","Б","Б","Б","Б","Б","П","П",null,"П","П","П","П","П","П","Б","П","Б","Б","П","П","П","П","ПЭ","П","П","П","П","Б","П","Б","П","П"],[null,"9921-9970","9921-9970","9975-9989","8890-8913","8914-8915","8916-8926","Н074","8982-8984","8985-8994","8995-8997","Н078","Н079","9043-9058",null,null,null,"О170",null,"0289-0328",null,"О172","05:27:50",null,null,null,"04:04","04:58","05:01",null,"О208","1151-1183","О209","0263-0271","0284","13:47","15:40","6754","21:20","6772","22:38",null,"1315-1351, О210","1359","О213","15:00","15:00","19:33","Н099 0351",null,"09:30","1555 О214","19:28",null,"О216","О217","О218","1673","1735","О221","1745","О222","1821","0507","06:20","07:15","0566","0577","0580","0581","0582","0583","0584","0585, 0589","0587","0587","0587","0587","0591","0592","0593","0593","0595","0600","0602","0611","0612","0613","0614","0618","0623","0626","0627","0629","0631","0634","0635","0640","0651","0658","0662","Н104","Н104","Н104","Н104","1915","1917","1919","1973","1974","1974","1983","1984-2006","2030","2070","2080","2104-2125","2126-2132","2133-2163","10:40",null,"07:06:30",null,"2359-2378","01:08:29","О228","2396","01:20","2402","2409-2411","2432","2433","2443","2471","2496","О229","2520-2536","2520-2536","2520-2536","2520-2536","2520-2536","2520-2536","2520-2536","2546","01:54","2553","2553","2564","2564","2565","2565","2581","2581","2582","2582","2588","2589","2591","2591","2594","2594","2594","2594","2598","2605-2652","2604","2663-2726","02:18","02:18","2817","02:19","02:19","2818","2829","2829","2856","3165-3167","О231","3226","03:19","3246","3262","3282","3282","3302","3302","3318","3337","3347","3370","3386-3387","04:03","3421","3439","3441","3441","3464","3470","3547","О232","3592","О233","3607","3624","О234","3795","0806","3838","3846","О236 3877","3898","3899","0858","0859","0877","1014","20:57","23:31","23:35",null,null,null,"4060","04:15","4184","4202","4223","4209","4233","4362","4356","4355","4354","4348","4316","4306","4280","4253","4134","4138","4134","4136","4143","4131","4108","О238","4409","4410",null,"4421","4424-4579","4658","4724","18:04",null,null,"Н112","1636","08:21","1638","1649","Н115 1659","10:23","12:45","О256","5595","5597-5603","5605","Н116 1726","Н117 1746","Н118 1764","Н119 1774","1797-1879","Н120 1896-1929","1936-1996","2000-2077",null,null,"О259","2086","7209","7231","5619-5648","5649-5678","5887","2098-2101","2279","6028","6028","6032","6032","6037","6039","6060","6060","6069","6132","6134","6135","6137","6145","6147","6150","6155","6157","6166","6191","09:19","10:15","10:19","Н126","2498-2627","2629-2678","6330","6232",null,"О264","О264","О265","6340","6342","О266","2739, 2744","О267","2780","2790","6496","6498","6500","6500","10:10","6595","6598","6611","6619","2928-2995","6676","2996-2997","17:18","6753"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"время",null,null,null,null,null,null,"место",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"время",null,"место","место",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"место",null,null,"место","место","место","место",null,null,null,null,null,null,null,null,null,null,null,"время",null,"место",null,"место",null,null,null,null,null,null,null,"место",null,"место",null,null,null,"время","время",null,"место",null,null,null,null,null,null,null,null,null,null,null,"время",null,"место",null,"место",null,null,null,null,null,null,null,null,null,null,null,null,null,"место",null,null,null,null,"место","место","место",null,"место",null,null,null,null,null,"время",null,null,null,"место",null,"место","место",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"место",null,null,null,null,"место","место",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"время",null,null,null,null,null,null,null],[null,"Морская свинья","Морская свинья","Белуха","Белуха","Белуха","Белуха","Белуха","Белуха","Белуха","Белуха","Белуха","Белуха","Белуха",null,null,null,"Тюлень sp",null,"Белый медведь",null,"Тюлень sp","Белуха",null,null,null,"Белуха","Белуха","Кольчатая нерпа",null,"Кольчатая нерпа","Лахтак","Кольчатая нерпа","Морж","Белуха","Белуха","Белуха","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа",null,"Морж","Морж","Тюлень sp","Тюлень sp","Кит sp","Кольчатая нерпа","Кольчатая нерпа",null,"Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа",null,"Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Тюлень sp","Кольчатая нерпа","Тюлень sp","Лахтак","Тюлень sp","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Тюлень sp","Тюлень sp","Тюлень sp","Кольчатая нерпа","Тюлень sp",null,null,"Тюлень sp","Тюлень sp","Лахтак","Тюлень sp","Тюлень sp","Тюлень sp","Белуха",null,"Белуха",null,"Тюлень sp","Тюлень sp","Тюлень sp","Лахтак","Тюлень sp","Лахтак","Тюлень sp","Лахтак","Кольчатая нерпа","Лахтак","Кольчатая нерпа","Кольчатая нерпа","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Кольчатая нерпа","Тюлень sp","Лахтак","Кольчатая нерпа","Тюлень sp","Кольчатая нерпа","Тюлень sp","Кольчатая нерпа","Лахтак","Лахтак","Тюлень sp","Лахтак","Лахтак","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Кольчатая нерпа","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Лахтак","Тюлень sp","Белуха","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Тюлень sp","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Тюлень sp","Кольчатая нерпа","Белый медведь","Белуха","Белуха","Белуха","Белуха","Кольчатая нерпа","Кольчатая нерпа","Белый медведь","Белый медведь","Кольчатая нерпа","Белый медведь","Кольчатая нерпа","Кольчатая нерпа","Тюлень sp","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Белуха","Белуха",null,null,null,"Тюлень sp","Тюлень sp","Тюлень sp","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Гренландский тюлень","Кольчатая нерпа","Тюлень sp","Тюлень sp","Тюлень sp","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа",null,"Белуха","Белуха","Кольчатая нерпа","Кольчатая нерпа","Морж","Дельфин sp",null,"Финвал","Малый полосатик","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Тюлень sp","Тюлень sp","Кольчатая нерпа","Лахтак","Следы белого медведя","Следы белого медведя","Гренландский кит","Гренландский кит","Гренландский кит","Гренландский кит","Гренландский кит","Гренландский кит","Гренландский кит","Гренландский кит",null,null,"Белуха","Белуха","Белуха","Белый медведь","Белуха","Морж","Тюлень sp","Следы белого медведя","Следы белого медведя","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Белый медведь","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Тюлень sp","Родовая берлога","Морж","Морж","Морж","Морж","Белый медведь","Морж","Тюлень sp","Белый медведь",null,"Кольчатая нерпа","Кольчатая нерпа","Кольчатая нерпа","Морж","Морж","Лахтак","Лахтак","Белый медведь","Белый медведь","Лахтак","Лахтак","Тюлень sp","Лахтак","Лахтак","Морж","Морж","Морж","Морж","Кольчатая нерпа","Морж","Морж","Кольчатая нерпа","Морж","Морж"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"никого",null,null,null,"никого",null,null,null,null,null,null,null,null,"Тюлень sp",null,"Тюлень sp",null,null,null,null,null,"никого",null,null,null,null,null,null,"Тюлень sp",null,null,null,null,null,null,"никого",null,null,null,null,null,null,null,"Тюлень sp",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"никого",null,null,null,null,"Поморники",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"Гренландский тюлень","Гренландский тюлень",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"Морж",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"никого","никого",null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.5,null,null,null,0.7,null,null,null,null,null,null,null,null,0.5,null,0.5,null,0.1,null,null,null,0.3,null,null,null,null,null,0.3,0.3,1,null,null,null,0,null,0.6,null,null,null,null,null,null,null,0.2,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,null,null,null,null,0.4,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.3,0.3,0.4,0.5,0.2,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.5,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.4,0.4,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"0.01",null,null,null,null,null,null,"13:47",null,"13:47",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"1973","1973",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"2564",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"О232",null,"О233",null,null,null,"3795",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"4421",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"0.6",null,null,null,"О259",null,null,"7209",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"2498-2627",null,null,null,null,null,"0.9 6340",null,"О266","1","1","6496",null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,2,2,1,1,1,3,1,1,1,1,1,1,1,null,null,null,1,null,1,null,1,4,null,null,null,14,2,null,null,1,1,1,null,4,7,4,1,1,1,1,null,3,3,1,1,2,1,1,null,1,1,1,null,1,1,1,3,1,null,1,1,1,1,1,1,1,1,1,1,1,1,1,8,6,2,4,3,3,1,1,1,1,4,1,2,4,1,1,4,2,4,1,1,1,1,1,2,1,1,1,1,1,1,1,1,null,1,17,1,1,null,null,3,7,3,17,3,4,3,null,15,null,7,1,1,3,1,3,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,18,1,27,5,19,1,1,1,1,1,1,7,2,1,1,59,1,1,1,1,1,2,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,null,8,2,1,1,1,1,null,null,null,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,1,1,1,1,1,1,1,1,1,1,null,5,5,1,1,6,1,null,1,1,1,1,2,1,1,2,1,1,0,0,1,1,1,1,1,1,1,1,null,null,1,1,16,1,7,2,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,3,1,1,1,3,null,1,3,null,2,1,1,1,1,1,1,3,3,1,1,1,1,1,4,1,1,2,1,2,2,1,1,null],[null,null,null,null,null,null,"1",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"2","2",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"?",null,null,null,null,null,"1",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"4",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"2",null,null,"2",null,null,null,null,null,null,null,null,"2","2",null,null,null,null,null,"2",null,null,"1",null,"1","1",null,null,null],[null,"7","7","9","2","3","5","2","2","4","12","11","4","7",null,null,null,"10",null,"3",null,"4",null,null,null,null,"310Т","310Т","TBS",null,"14","10","15","3","030Т","030Т","030Т","10","2","10","2",null,"2","8","10",null,null,"10","3",null,"9","11","3",null,"10","11","11","10","2","10","9","14","9","9","10","7","9","2","10","10","10","9","8","9","10","10","10","10","9","9","9","11","11","9","10","9","10","10","9","9","9","9","9","9","9","9","9","9","9","9","9","1","2","4","5",null,"5","3","3","3","3",null,null,"3","3","3","3","5","3","3",null,"3",null,"9","3","10","10",null,"9","11","9","9","3","11","10",null,"1","2","2","3","4","4","5","3","11","11","11","2","2","2","2","3","3","12","1","2",null,"2","3","11","10","9","8","2","3","3","3","3","3","3","3","3","3","2","11","3","4","11","3","3","3","2","9","9","10","10","9","12","2","11","11","9","2","2","1","11","10","9","9","11","9","12","9","1","14","14","2","10","3","2","11","11","10",null,null,null,null,"12","1",null,null,null,"280Т","290Т","2","3","11","7","10","8","11","8","3","9","8","8","11","2","10","2","1","2","10","1","10","11","2","2",null,"2","5","9","9","000Т","9",null,"10","10","9","9","10","10","6","3","3","10","3","3","11","4","1","11","9","11","3","2",null,null,"8",null,"3","3","135Т","150Т","170Т",null,null,"03:00","03:05","02:45","03:15","3","3","03:50","04:10","3","3","2",null,"3","3","4","3","3","4","2","3","9","2","3","1","1",null,"6","10",null,"100Т","100Т","190Т","040Т","085Т","4","4","240Т",null,null,"250Т","330Т","310Т","320Т","6","270Т","190Т","265Т","105Т","11+270Т","090Т","150Т","12+110Т","225"],[null,"200","200","200","200","250","300","700","500","400","40","350","350","170",null,null,null,"10",null,"1200",null,"400",null,null,null,null,"2500","1000","800",null,"300","50","700","320","3000","4000","5000","25","25","50","250",null,"1500","2000","30",null,null,"1500","1500",null,"50","30","50",null,"30","40","50","600","200","100","600","600","120","150","200","230","200","250","800","600","500","600","500","600","600","700","800","900","500","470","450","600","400","500","200","600","700","400","350","450","400","600","300","300","350","550","400","350","300","500","350","400","500","700","600",null,"600","800","1200","300","600",null,null,"1200","1200","700",null,"700",null,"300",null,"350",null,"700","1000","50","500",null,"900","1000","400","600","700","120","300",null,"900","900","900","900","900","900","900","300","500","800","300","200","200","600","200","150","250","100","300","300",null,"300","900","700","900","500","600","250","800","400","800","500","1000","200","700","900","400","300","100","300","600","70","200","1500","800","800","600","600","600","600","600","150","400","200","100","399","300","500","400","150","200","200","1000","400","400","300","300","80","100","1000","600","500","4000","200","40","600","650",null,null,null,null,"1200","1000",null,null,null,"2000","1700","200","200","100","200","100","150","200","200","200","100","300","100","200","300","100","100","200","120","150","300","200","300","200","300",null,"150","1000","150","50","300","15",null,"600","500","400","300","400","200","10","100","60","800","40","40","1500","1200","1200","1500","800","700","400","700",null,null,"60 градусов",null,"60 градусов","60 градусов","800","600","1200",null,null,"2500","2500","2500","2500","2500","2500","3000","3000","3500","3000","2000","2500","2000","3000","3000","3500","4000","3500","3500","4000","800","600","600","400","200",null,"400","1000",null,"1000","1500","1000","500","600","100","200","700","500","500","600","2000","2000","2000","100","2000","150","250","500","450","2000","600","50","2000"],[null,"8","8",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"Удаление от наблюдателя, вдоль берега в сторону Амдермы",null,null,null,null,"9",null,null,null,null,null,null,null,null,null,null,"1",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"9","12","9",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"2","6",null,null,null,null,null,"6","6",null,"12",null,null,null,null,null,null,null,"4","6",null,null,null,null,null,null,null,null,null,"6",null,null,null,"240Т","240Т",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"3",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"9",null,null,null,null,"5+110Т"],[null,"вода","вода","вода","вода","вода","вода","вода","вода","вода","вода","вода","вода","вода",null,null,null,"вода",null,"суша CT00",null,"вода","вода",null,null,null,"вода","вода","вода?",null,"вода","вода","вода","вода","вода","вода","вода","вода","вода","вода","вода",null,"вода","вода","вода","вода","вода","вода?","вода",null,"вода","вода","разводья CT23",null,"вода","вода","вода","разводья","вода","вода","льдина","разводья","вода","разводья","разводья","разводья","разводья","льдина","льдина","льдина","льдина","льдина","льдина","льдина","льдина","льдина","льдина","льдина","льдина","льдина","льдина","льдина","льдина","льдина","разводья","льдина","льдина","льдина","льдина","льдина","льдина","льдина","льдина","льдина","разводья","разводья","разводья","льдина","разводья","разводья","разводья","разводья","разводья","разводья","разводья","разводья","льдина","льдина","льдина","разводья","льдина",null,"льдина","льдина","льдина","льдина","льдина","льдина","льдина","вода",null,"вода",null,"льдина","разводья","разводья","льдина","разводья","льдина","льдина","льдина","разводья","разводья","разводья","льдина","разводья","льдина","льдина","льдина","льдина","льдина","льдина","льдина","разводья","разводья","льдина","льдина","льдина","льдина","льдина","льдина","льдина","льдина","разводья","разводья","льдина","разводья","разводья","разводья","льдина","льдина","льдина","льдина","разводья","льдина","льдина","льдина","льдина","льдина","разводья","разводья","разводья","разводья","разводья","разводья","разводья","разводья","вода","вода","льдина","льдина","льдина","льдина","льдина","льдина","льдина","льдина","разводья","льдина","разводья","разводья","разводья","разводья","разводья","разводья","разводья","разводья","разводья","льдина","вода","вода","вода","вода","разводья","разводья","льдина","льдина","вода","суша","разводья CT01","вода","разводья","льдина","льдина","льдина","разводья","разводья","вода","вода",null,null,null,"льдина","вода","разводья","разводья","разводья","разводья","разводья CT12","разводья","разводья","разводья","разводья CT01","разводья","разводья","разводья","разводья","разводья","разводья","разводья","разводья","разводья","разводья","разводья","разводья","вода","вода","вода",null,"вода","вода","вода","вода","вода",null,null,"вода?","вода","вода","вода","вода","вода","вода","вода","вода","льдина","льдина","льдина","вода","вода","вода","вода","вода","вода","вода","вода",null,null,"вода",null,"вода","суша","вода","вода","разводья","суша","суша","припай","припай","припай","припай","припай","припай","припай","припай","припай","припай","припай","припай","припай","припай","припай","припай","припай","припай","льдина гладкий ледяной массив","суша","льдина","льдина","льдина","льдина","льдина","разводья","льдина","льдина",null,"разводья","разводья","разводья","разводья","разводья","вода","вода","льдина",null,null,"льдина","льдина","льдина","льдина","разводья","льдина","разводья","льдина","разводья","льдина","льдина","льдина","льдина","разводья"],[null,"2 пары по 2 особи","2 пары по 2 особи",null,null,null,null,"Двигалась в сторону берега","Плывет вдоль берега навстречу судну",null,"прямо перед носом (фото 8995) в 6:13 всплыл по левому борту на 9 часов в 700 метрах","занырнула и скрылась","не успела, выгнали с пеленгаторной за попытку фотофиксации с элементами тяжелой ходьбы",null,null,null,null,"замечен под бортом, занырнул",null,"Упитанность 3 (м.б.4). Вылез на о. Отдельный из воды",null,"При взлете вертолета ушел в воду с камней острова","Левый борт (Платонов с правого не видел). Попробовать либо О172, либо 05:28",null,null,null,"Платонов 03:54 0959 (отбивка) фонтаны белух, 310Т 2000м. Поодаль, 2.5км – спины белух. В 04:04 спины двух белух. Макаров через 2-3 дня: Усть-Кара, в 4 км от парохода около 20 белух (берем 14, 2/3), с детенышами, “заглядываются на вертолет, красуются пилотам”","ныряет. Направление (310Т) задано то же, где и регистрировались ранее. Маленькая вероятность повтора обозначенного выше стада",null,null,"В бинокль. Достоверно – тюлень sp, по поведению – долгое время носик головы на поверхности – кольчатая нерпа (характерное поведение)","Замечены всплески, свойственные тюленям. При последующих наблюдениях идентифицирован как лахтак.","Плыл. Не лахтак. По свойственному поведению – кольчатая нерпа",null,"Сомневаюсь. Платонов камералка: 0274-0295. Тот же ракурс (ветровая полоса, облака), зум. Минимум четыре белухи. Указано 4 белухи. По направлению похоже, что видел Платонов спустя несколько часов. Расстояние может быть ближе, чем у Платонова, так как удалось запечатлеть на 400mm объектив","Кормятся. Наблюдения в бинокль в течение 1338-1356.","Кормятся. Наблюдения в бинокль в течение 1540-1550","Ныряет. Стаим на якоре у Х….","Нырнула. Со слов художника Ивана. Платонов: Иван быстрее Всеволода вошел в мормлекологию, можно и поверить","Нырнула","6774 Не успела сфотографировать",null,null,"Три головы, две головы фыркали","Заныривание, типичное для тюленя. Отслеживание в течение 3 мин – без результата. Подтверждение с мостика, что был тюлень.","На мостике видели “котика” по правому борту во время выхты 13-17 UTC. Из экспертного опроса рулевого Арсения выяснено, что котиками он называет тюленей с вытянутой мордочкой. У гренландского тюленя выниривание из воды и держание стаями больше похоже на поведение моржей, поэтому с определенной уверенностью котики Арсения – кольчатые нерпы","Со слов Арсения “старпом видел китов”. Вообще-то старпом глазастый на. Со своеобразной манерой общения на.","Не успела сфотографировать.","Двигается в сторону берега",null,"Расстояние 50м – комфортное для наблюдения любителем невооруженным взглядом.","занырнула прямо под бортом","Всеволод. “Нерпа возле льдинки” До Амдермы многое увиденное им было не мормлеком, но постепенно обучался, хотя достоверно ему нельзя верить. В воде рядом со льдинкой",null,null,"тюлень смотрел на судно, подпустил близко, занырнул","занырнула","Три тюленя на льду, на снимке посередине по вертикали и чуть вправо по горизонтали","Нерпа занырнула. На фото круги","занырнул тюлень","Точно тюлень. Но уж больно похож на зайчика. Направление (лев борт) уточнено по смещению на фото","тюленья морда в воде занырнула","1764-1823","ныряет","перемещение; показывает только носик","перемещение; показывает только носик","перемещение; показывает только носик","объеденное тело; П записал субстратом льдину","отдых","отдых","отдых","отдых","отдых","отдых","Отдых; 600-900 15 шт, из них 2 дет. Разнесено на 4 записи","Отдых; 600-900 15 шт, из них 2 дет. Разнесено на 4 записи","Отдых; 600-900 15 шт, из них 2 дет. Разнесено на 4 записи","Отдых; 600-900 15 шт, из них 2 дет. Разнесено на 4 записи","отдых","отдых","отдых","отдых","отдых","отдых","перемещение","отдых","отдых","отдых","отдых","отдых","отдых","отдых","отдых","отдых","перемещение; заполнено поле направления (9ч)","перемещение; заполнено поле направления (9ч)","перемещение; заполнено поле направления (9ч)","отдых","перемещение; заполнено поле направления (9ч)","перемещение; заполнено поле направления (9ч)","перемещение; заполнено поле направления (9ч)","4 нерпы в разводьях по правому борту 400-700 м во время скана с 5 до 1ч","4 нерпы в разводьях по правому борту 400-700 м во время скана с 5 до 1ч","4 нерпы в разводьях по правому борту 400-700 м во время скана с 5 до 1ч","4 нерпы в разводьях по правому борту 400-700 м во время скана с 5 до 1ч","Нерпа ушла в воду рядом со льдиной","Тюлень вылез на льдину","Тюдень на льду","1973 и ранее. Две серии фото льдины, на которой 17 тюленей","В воде нерпа","Тюлень на льду","Те же самые","Поле льда с 17 тюленями","Следующее поле 3 тюленя; 2006 отбивка. ФОТО ПО ХРОН.","Следующее поле – 7 тюленей. ФОТО ПО ХРОН.","Ближнее к полю с 7 тюленями – поле с 3 зайцами ФОТО ПО ХРОН.","Еще одно поле. Около 17 тюленей на 2104. Повтор 1973?","3 тюленя","Птицы + 4 тюленя. Либо тюленей много","Вакулова. Опрос Быковой. Платонов посадил Веру на правый борт, так как она из 39 или 41 каюты",null,"попутный авиаучет",null,"Визуально 7 тюленей","1 тюлень. 2023-08-13 указан субстрат “разводья”, так в случае “льдины“ была бы попытка сфотографировать, а в “разводьях” тюлень мог скрыться","тюдень занырнул",null,"Тюленья морда в воде. Не указан борт","Три зайца. По серии 2400-2402 борт – левый, а расстояние – приличное.","Для ЗШПУ-2025 изменено 2409 на 2409-2411 (Платонов)","“До 9ч 400м”. Похоже, что та же льдина, что 2409, только зайцы в другой, ближней части льдины","Обнаружено случайно во время камеральной обработки","Заяц? Уточнено при камеральной обработке","Кольчатая нерпа. При камеральной обработке, особенно 2486, похож на лысуна (гренландского тюленя). Оставлен как кольчатая нерпа, так как среди зарегистрированных на льду тюленей нет лысунов","кольчатая нерпа на льду","тюленья морда в разводьях","7 тюленей правый сектор","7 тюленей правый сектор","7 тюленей правый сектор","7 тюленей правый сектор","7 тюленей правый сектор","7 тюленей правый сектор","7 тюленей правый сектор","тюленья морда. Борт восстановлен по серии фото. Камеральная обработка – кольчатая нерпа","тюлень в разводьях",null,null,"два тюленя на льду. Со спины – нерпа. А с лица кто?","два тюленя на льду. Со спины – нерпа. А с лица кто?","1 т на л","Обнаружено при камеральной обработке, часть снимка 2564",null,null,"1 т в разв 12ч","Обнаружен в правом верхнем углу снимка при камеральной обработке","заяц на льдине","т в разв","т в разв","Обнаружено при камеральной обработке","Скан 11-8ч 500-1000м. Рандом филлед. На снимке животные есть","Скан 11-8ч 500-1000м. Рандом филлед. На снимке животные есть","Скан 11-8ч 500-1000м. Рандом филлед. На снимке животные есть","Скан 11-8ч 500-1000м. Рандом филлед. На снимке животные есть","т в разв","скан 2-4ч 80м 18т. Уточнить, есть ли повтор с 2663-2726","В тетрадке указано 2600 1т, но это 2602-2604. И с большой уверенностью при камералке – кольчатая нерпа","Уточнить, есть ли повтор с 2605-2652. Сильно отличаются условия наблюдения. В этой серии видимость существенно лучше",null,null,"т в разв",null,null,null,null,null,"Всплеск 2838, потом тушки 2846-3162. В области обширного пространства открытой воды, потом через перемычку льда ушли в разводье","В тетрадке отметка, что можно попробовать найти тюленей на фото, но тюлени не нашлись","тюлень занырнул","т занырнул с высокими брызгами","1500-2000м на 3ч 59 тюленей на поле льда","т на л","т на л","Темнее. 3282 на 9ч, 3296 на 8ч","Светлее.  3282 на 9ч, 3296 на 8ч","т на л. См. след. запись про еще два","“Рядом еще два”. Но на фото рядом только один. В протокол записывается два.","Отбивка, но на фото и рядом могут быть. 4Т на льд","Занырнула в 50м. Уточнить по морде на фото. А не гренландский ли это тюлень?","по отбивке указано время и льдина","~30 фото ныряющей кольчатой нерпы","к нерпа нырнула","нырнул тюлень без фото","на фото кругов нет, поэтому отбивка “время”. Сначала отмечено тюлень, потом уточнение кольчатой нерпы","на фото кругов нет, поэтому отбивка “время”. К нерпа в разводьях","к нерпа в разводьях","к нерпа круги","тюлень, три круга, уплывал от судна","~3470-3515 к нерпа в разв","миша жрёт тюленя. Упитанность 3-4","О232, потом 3592","О232, потом 3592","сначала дв на 12ч, потом на 9ч","сначала дв на 12ч, потом на 9ч","к нерпа в развод","Всеволод. Опрос Платоновым","БМ на ледяном острове 2-3 Га. При приближениии парохода стал отходить. Упитанность 4. У АМ на фото вблизи остатки тюленя","на льдине, видно объеденное тело нерпы (или не нерпы)","На фото нет кругов, поэтому отбивка времени","Миша маловероятно, стоит анфас. При камералке не подтвердилось","Нос ~20 сек; нырок","к нерпа нырок","перед льдиной голова тюленя","отдых","Я думаю, что это поморники. Платонов камералка: по тушкам – тюлени. Из нетюленьего то, что лежат в одну сторону, разворачивась по ветру по-птичьи. Из нептичьего см. D7500-2597: даже если попой в снегу, голова хорошо выделяется",null,null,"НЕ УКАЗАНО КОЛ-ВО. Платонов указал 1","7057 Не успела сфотографировать. Платонов указал субстратом воду, хотя льда в окрестностях много","7057 Не успела сфотографировать. Платонов указал субстратом воду, хотя льда в окрестностях много",null,null,null,"Тюлень на льду. Его сначала не было, потом выбрался, через ~20’ пропал. В том районе после этого кто-то плавал из ластоногих, возможно, он же","+1 тюлень к 04:12 на С-З в воде","т занырнул","к нерпа в разводье",null,null,"Субстрат оценен по фото","К нерпа разводья","К нерпа отбивка. Разводья по отбивке","К нерпа разв","Разводья с редкими льдинами – по отбивке",null,null,null,null,"2 (м.б.3) тюленя в разв. Камералка: три к нерпы","Камералка фото 4098-4188","Камералка фото 4098-4188 – тюлень sp","к н в разв","Камералка фото 4098-4188 – тюлень sp","Камералка фото 4098-4188. Голова. Занырнул","к н в разв","к н в разв","в бинокль","головой вверх (так в тетрадке)","столбиком",null,null,null,"к н купается","не ныряет","По месту должен быть географический мыс Желания. Фактическое время между 17:00 и 17:30, но в это время все GPS были далеко. Алексей, Вера и Артем видели от 5 до 7 моржей у камней вблизи скал мыса","Иван. Какое время???",null,"перемещался против судна, большой фонтан, тонкий серповидный плавник, хвост не показывал",null,null,null,"Камералка 1646-1669. Группа из трех тюленей. По скупому опыту Платонова гр.тюлени держатся группой, а кольчатые нерпы так сильно не высовывают корпус из воды. Платонов усмотрел группу из трех тюленей, которая у наблюдателя разбита на 2+1 (так и оставим) Оригинальный вид: “какая-то жесть”","Камералка 1646-1669. Группа из трех тюленей. По скупому опыту Платонова гр.тюлени держатся группой, а кольчатые нерпы так сильно не высовывают корпус из воды. Платонов усмотрел группу из трех тюленей, которая у наблюдателя разбита на 2+1 (так и оставим)","Со слов полярник с совочной Карги","Костя(?) бортмеханик-стажёр, 15:45 судового два всплеска по правому борту","Нырок тюленя. Вероятно, кольчатая нерпа","Спасибо Маше Соловьевой за помощь в идентификации. Складообразочными движениями молодой лахтак сбежал в воду.","следы БМ на трех льдинах","следы БМ",null,null,null,null,null,null,"Платонов убрал время “20:47”; было “20:47 1936-1996”","вероятнее тот же, занырнул после 5 фонтанов. Платонов убрал время “20:56”; было “20:56 2000-2077”",null,null,"Занырнула при достижении надира вертолета береговой линии",null,"Уточнить у Тони и экспедиции, сколько же было белух. Уточнено.","на снежнике. Самец","Почти в одну линию перемещались слева направо по солнцу. При камералке получается 9-10. Место совпадает с регистрацией при авиаучете","правее белух. Плыли в том же направлении, что белухи, потом занырнули","в разводьях тюлень",null,null,null,"на два градуса правее предыдущего","возможно, отбивка. 2т на припае 3ч. Разнес каждого на полчаса","возможно, отбивка. 2т на припае 3ч. Разнес каждого на полчаса","см. еще 6045","см. еще 6047","2т (м/м) на п. Разнес каждого на полчаса","2т (м/м) на п. Разнес каждого на полчаса","На 4 км. При камералке 3500м","т на п, и к нему идет миша справа","перед полосой разводья","т на п ближе, чем 6132",null,"за линеий разводья","Не 6145",null,null,"т на п; рядом с 6147, но 6147 сполз 20” ранее; в бинокль было оба два",null,"Возможно, родовая берлога. В снежнике. Около 70 метров над уровнем моря, крутизна 40°, экспозиция восток","отдых","отдых","отдых","тазом в воде","Проявляют любопытство, приблизились к судну","Ушли под воду по мере приближения судна, вынырнули в другой полынье, в поле зрения медведей ушли под воду и скрылись","к на л","Добавлено при камералке. Самка с двумя сеголетками. Упитанность медведицы 2.",null,"2 нерпы, 2 головы рядом, 3ч 1 км. Нос судна на 010Т. Субстрат по визуальной памяти. В во время стоянки у о. Хейса льдины проплывали","Голова. 1.5км 3ч.  Нос судна на 010Т. Субстрат по визуальной памяти. В во время стоянки у о. Хейса льдины проплывали","1 к н поплавок (голова + часть туловища) 6ч 1км. Нос судна на 010Т. Субстрат по визуальной памяти. В во время стоянки у о. Хейса льдины проплывали","Занырнул. 500М 2ч. Нос судна на 010Т. Субстрат по визуальной памяти. В во время стоянки у о. Хейса льдины проплывали","Морж 600м 5ч занырнул. Возможно, тот же 6340. Нос судна на 010Т. Субстрат по визуальной памяти. В во время стоянки у о. Хейса льдины проплывали","2744 D90. ПЕРЕВЕСТИ ЧАСЫ В ГРАДУСЫ. Камералка: это лахтак с дыркой в голове на месте уха","перемещение","F+2C1 Самка с двумя сеголетками. В 3-4 км от первоначальной регистрации полуднем ранее. Льдина. Потом вышла на сушу. Изначальное направление 045Т при камералке исправлено на 240Т","Большой Комсомольский остров. Та же медведица, что и 23.07. Заметили на прибрежных льдах с двумя медвежлонками. Проявляла сильное любопытство, пошла на группу людей. Не реагировала на ракетницы, медвежата двигались за мамой слегка опасаясь. Подошла близко к человеку, получила по носу и убежала.","На прибрежном льду в 400 м от медведя. При движении медведицы в его сторону занырнул и скрылся.","WSW – 250Т. Т на л","NNW – 330Т. Т на л","NW – 315Т. Две кучки лахтаков на льду. Разнесены по 5 градусов","NW – 315Т. Две кучки лахтаков на льду. Разнесены по 5 градусов","Арт’ем 4 моржа за кормой, есть молодые. Есть видео. ПЕРЕВЕСТИ ЧАСЫ В ГРАДУСЫ","W. морж выполз на льдину","SSW. Морж занырнул",null,"Нос 270Т, 7ч=105Т","отдых","Вероятно, два моржа. Нос 270Т, 12ч=090Т. Уточнить у Ани. Уточнили:  F+C","Мертвая. Без движения, рядом видно кровавый след… на 7-8ч","Указано только время, 17:18 UTC. Пеленг, дальность и субстрат – отсебятина Платонова","морж в воде плывет SW затем нырнул"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Дата<\/th>\n      <th>Вахта<\/th>\n      <th>Время UTC<\/th>\n      <th>Наблюдатель<\/th>\n      <th>Точка трека<\/th>\n      <th>Отбивка<\/th>\n      <th>Вид<\/th>\n      <th>Альтернатива<\/th>\n      <th>Сомнит.<\/th>\n      <th>Повтор<\/th>\n      <th>Кол-во<\/th>\n      <th>Из них дет.<\/th>\n      <th>Пеленг от набл., час<\/th>\n      <th>Расстояние от набл., м<\/th>\n      <th>Направление перемещ., час<\/th>\n      <th>Субстрат<\/th>\n      <th>Поведение наблюдателя, поведение животного, примечания<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scroller":true,"scrollX":true,"scrollY":"505px","scrollCollapse":true,"dom":"ift","autoWidth":true,"columnDefs":[{"className":"dt-right","targets":[8,10]},{"name":"Дата","targets":0},{"name":"Вахта","targets":1},{"name":"Время UTC","targets":2},{"name":"Наблюдатель","targets":3},{"name":"Точка трека","targets":4},{"name":"Отбивка","targets":5},{"name":"Вид","targets":6},{"name":"Альтернатива","targets":7},{"name":"Сомнит.","targets":8},{"name":"Повтор","targets":9},{"name":"Кол-во","targets":10},{"name":"Из них дет.","targets":11},{"name":"Пеленг от набл., час","targets":12},{"name":"Расстояние от набл., м","targets":13},{"name":"Направление перемещ., час","targets":14},{"name":"Субстрат","targets":15},{"name":"Поведение наблюдателя, поведение животного, примечания","targets":16}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<ul>
<li><p>Не откладывать</p>
<ul>
<li><p>какие-то пропущенные записи можно восстановить в памяти</p></li>
<li><p>бывает, что даже свой почерк требует расшифровки</p></li>
<li><p>бумажные записи могут потеряться</p></li>
</ul></li>
<li><p>Время, даты в формате ISO 8601 (YYYY-MM-DD HH:MM:SS, YYYY-MM-DD)</p></li>
<li><p>Камеральная обработка уточняет наблюдения</p></li>
</ul>
</div>
</div>
<div id="gps" class="section level2">
<h2>С GPS</h2>
<p>Наборы данных («слои» в терминологии ГИС)</p>
<ul>
<li><div class="clarify required">
<p><strong>waypoints</strong></p>
<ul>
<li>маршрутные точки. Это метки находок.</li>
</ul>
</div></li>
<li><div class="clarify optional">
<p><strong>routes</strong></p>
<ul>
<li>линии планируемого маршрута.</li>
</ul>
</div></li>
<li><div class="clarify required">
<p><strong>tracks</strong></p>
<ul>
<li>линии фактического маршрута, трек.</li>
</ul>
</div></li>
<li><div class="clarify optional">
<p><strong>route_points</strong></p>
<ul>
<li>точки планируемого маршрута. Они не содержат атрибута времени.</li>
</ul>
</div></li>
<li><div class="clarify required">
<p><strong>track_points</strong></p>
<ul>
<li>точки фактического маршрута, точки трека.</li>
</ul>
</div></li>
</ul>
<p>Импорт данных либо непосредственным чтением данных из внутренней памяти прибора или флеш-карты, либо с помощью дополнительного программного обеспечения, например, программой <a href="https://www8.garmin.com/support/download_details.jsp?id=209/">MapSource</a> для приборов Garmin.</p>
<div id="формат-gdb" class="section level3 unlisted unnumbered">
<h3 class="unlisted unnumbered">Формат GDB</h3>
<p>По-умолчанию, программа MapSource сохраняет в формате GDB.</p>
<p>В этом случае можно воспользоваться утилитой <code>gpsbabel</code>, которая входит в состав QGIS (возможно, устанавливается отдельным пакетом установщика OSGeo4W).</p>
<p>Пример скрипта на R для конвертации GDB-файлов в GPX-файлы:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">Sys.setenv</span>(<span class="at">PATH=</span><span class="fu">paste0</span>(<span class="st">&quot;C:</span><span class="sc">\\</span><span class="st">Software</span><span class="sc">\\</span><span class="st">OSGeo4W</span><span class="sc">\\</span><span class="st">apps</span><span class="sc">\\</span><span class="st">Qt5</span><span class="sc">\\</span><span class="st">bin;&quot;</span>,<span class="fu">Sys.getenv</span>(<span class="st">&quot;PATH&quot;</span>)))</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>src <span class="ot">&lt;-</span> <span class="fu">dir</span>(<span class="at">pattern=</span><span class="st">&quot;2023.+</span><span class="sc">\\</span><span class="st">.gdb$&quot;</span>,<span class="at">recursive=</span><span class="cn">TRUE</span>,<span class="at">full.names=</span><span class="cn">TRUE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>dst <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">.gdb$&quot;</span>,<span class="st">&quot;.gpx&quot;</span>,src)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="sc">!</span><span class="fu">file.exists</span>(dst) <span class="sc">|</span> <span class="fu">file.size</span>(dst)<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(ind)) {</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>   cmd <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;gpsbabel -w -r -t -i gdb,via=0,roadbook=0&quot;</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>               ,<span class="st">&quot;-f&quot;</span>,src[ind]</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>               ,<span class="st">&quot;-o gpx,suppresswhite=0,logpoint=0,humminbirdextensions=0,garminextensions=0&quot;</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>               ,<span class="st">&quot;-F&quot;</span>,dst[ind])</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>   <span class="fu">print</span>(cmd)</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>   <span class="fu">sapply</span>(cmd,system)</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>}</span></code></pre></div>
<p>R-библиотека <strong><code>sf</code></strong> может прочесть GDB при установленной QGIS и прописанным путям к <code>gpsbabel</code> и другим необходимым библиотекам.</p>
</div>
<div id="gpx" class="section level3 unlisted unnumbered">
<h3 class="unlisted unnumbered">Формат GPX</h3>
<p>Формат GPX, поддерживаемый GDAL (R, QGIS)</p>
<div class="scrollable">
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;gpx version=&quot;1.0&quot; creator=&quot;GPSBabel - https://www.gpsbabel.org&quot; xmlns=&quot;http://www.topografix.com/GPX/1/0&quot;&gt;
  &lt;time&gt;2023-07-07T19:48:29.358Z&lt;/time&gt;
  &lt;bounds minlat=&quot;64.872794878&quot; minlon=&quot;39.336913051&quot; maxlat=&quot;76.958201230&quot; maxlon=&quot;162.497487059&quot;/&gt;
  &lt;wpt lat=&quot;80.607721&quot; lon=&quot;58.581165&quot;&gt;
    &lt;ele&gt;74.776161&lt;/ele&gt;
    &lt;time&gt;2023-07-27T13:09:59Z&lt;/time&gt;
    &lt;name&gt;269&lt;/name&gt;
    &lt;sym&gt;Animal Tracks&lt;/sym&gt;
  &lt;/wpt&gt;
  &lt;wpt lat=&quot;68.093320057&quot; lon=&quot;49.233305762&quot;&gt;
    &lt;ele&gt;14.786&lt;/ele&gt;
    &lt;name&gt;074&lt;/name&gt;
    &lt;cmt&gt;20-NOV-03 21:28:46&lt;/cmt&gt;
    &lt;desc&gt;20-NOV-03 21:28:46&lt;/desc&gt;
    &lt;sym&gt;Golf Course&lt;/sym&gt;
  &lt;/wpt&gt;
  &lt;wpt lat=&quot;55.712468466&quot; lon=&quot;37.589259753&quot;&gt;
    &lt;ele&gt;149.610&lt;/ele&gt;
    &lt;name&gt;048&lt;/name&gt;
    &lt;cmt&gt;048&lt;/cmt&gt;
    &lt;desc&gt;048&lt;/desc&gt;
    &lt;sym&gt;Museum&lt;/sym&gt;
  &lt;/wpt&gt;
  &lt;trk&gt;
    &lt;name&gt;ACTIVE LOG 001&lt;/name&gt;
    &lt;trkseg&gt;
      &lt;trkpt lat=&quot;67.242339542&quot; lon=&quot;42.252169400&quot;&gt;
        &lt;ele&gt;17.922&lt;/ele&gt;
        &lt;time&gt;2003-11-19T10:30:26Z&lt;/time&gt;
      &lt;/trkpt&gt;
      &lt;trkpt lat=&quot;67.242339542&quot; lon=&quot;42.252169400&quot;&gt;
        &lt;ele&gt;19.364&lt;/ele&gt;
        &lt;time&gt;2003-11-19T10:30:27Z&lt;/time&gt;
      &lt;/trkpt&gt;
    &lt;/trkseg&gt;
  &lt;/trk&gt;
  &lt;trk&gt;
    &lt;name&gt;ACTIVE LOG 002&lt;/name&gt;
    &lt;trkseg&gt;
      &lt;trkpt lat=&quot;67.515644403&quot; lon=&quot;42.656655153&quot;&gt;
        &lt;ele&gt;25.132&lt;/ele&gt;
        &lt;time&gt;2003-11-19T11:49:44Z&lt;/time&gt;
      &lt;/trkpt&gt;
      &lt;trkpt lat=&quot;67.516311938&quot; lon=&quot;42.657577582&quot;&gt;
        &lt;ele&gt;25.132&lt;/ele&gt;
        &lt;time&gt;2003-11-19T11:50:00Z&lt;/time&gt;
      &lt;/trkpt&gt;
      &lt;trkpt lat=&quot;67.517105620&quot; lon=&quot;42.658706121&quot;&gt;
        &lt;ele&gt;24.170&lt;/ele&gt;
        &lt;time&gt;2003-11-19T11:50:19Z&lt;/time&gt;
      &lt;/trkpt&gt;
      &lt;trkpt lat=&quot;67.517714985&quot; lon=&quot;42.659608936&quot;&gt;
        &lt;ele&gt;24.651&lt;/ele&gt;
        &lt;time&gt;2003-11-19T11:50:34Z&lt;/time&gt;
      &lt;/trkpt&gt;
      &lt;trkpt lat=&quot;67.518301550&quot; lon=&quot;42.660562294&quot;&gt;
        &lt;ele&gt;24.651&lt;/ele&gt;
        &lt;time&gt;2003-11-19T11:50:49Z&lt;/time&gt;
      &lt;/trkpt&gt;
      &lt;trkpt lat=&quot;67.518808153&quot; lon=&quot;42.661250113&quot;&gt;
        &lt;ele&gt;24.651&lt;/ele&gt;
        &lt;time&gt;2003-11-19T11:51:01Z&lt;/time&gt;
      &lt;/trkpt&gt;
      &lt;trkpt lat=&quot;67.519428832&quot; lon=&quot;42.661977410&quot;&gt;
        &lt;ele&gt;25.132&lt;/ele&gt;
        &lt;time&gt;2003-11-19T11:51:15Z&lt;/time&gt;
      &lt;/trkpt&gt;
    &lt;/trkseg&gt;
  &lt;/trk&gt;
&lt;/gpx&gt;</code></pre>
</div>
</div>
<div id="импорт-в-qgis" class="section level3 unlisted unnumbered">
<h3 class="unlisted unnumbered">Импорт в QGIS</h3>
<div id="menulayer" class="hiddenanchor">
 
</div>
<p><a href="#selectvector"><img src="assets/lesson12/AddVector.jpg" width="877" height="672" contain /></a></p>
<div id="selectvector" class="hiddenanchor">
 
</div>
<p><a href="#selectlayers"><img src="assets/lesson12/SelectVector.jpg" width="557" height="672" contain /></a></p>
<div id="selectlayers" class="hiddenanchor">
 
</div>
<p><a href="#addlayers"><img src="assets/lesson12/SelectLayers.jpg" width="476" height="672" contain /></a></p>
<div id="addlayers" class="hiddenanchor">
 
</div>
<p><a href="#trackinqgis"><img src="assets/lesson12/TrackInQGIS.jpg" width="877" height="672" contain /></a></p>
</div>
</div>
<div id="с-фотоаппарата" class="section level2">
<h2>С фотоаппарата</h2>
<p>Переименовать исходные файлы</p>
<ul>
<li><p>в новом имени файла должна содержаться информация о времени съемки</p></li>
<li><p>убедиться, что EXIF не пропадает</p></li>
</ul>
<div class="scrollable.explorer">
<div class="kable-table">
<table>
<colgroup>
<col width="36%" />
<col width="11%" />
<col width="8%" />
<col width="7%" />
<col width="29%" />
<col width="5%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">size</th>
<th align="left">isdir</th>
<th align="right">mode</th>
<th align="left">mtime</th>
<th align="left">exe</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">20230718-012638-2408.jpg</td>
<td align="right">559244</td>
<td align="left">FALSE</td>
<td align="right">666</td>
<td align="left">2023-07-17 22:26:38</td>
<td align="left">no</td>
</tr>
<tr class="even">
<td align="left">20230718-012639-2409.jpg</td>
<td align="right">549317</td>
<td align="left">FALSE</td>
<td align="right">666</td>
<td align="left">2023-07-17 22:26:40</td>
<td align="left">no</td>
</tr>
<tr class="odd">
<td align="left">20230718-012639-2410.jpg</td>
<td align="right">554643</td>
<td align="left">FALSE</td>
<td align="right">666</td>
<td align="left">2023-07-17 22:26:40</td>
<td align="left">no</td>
</tr>
<tr class="even">
<td align="left">20230718-012639-2411.jpg</td>
<td align="right">551275</td>
<td align="left">FALSE</td>
<td align="right">666</td>
<td align="left">2023-07-17 22:26:40</td>
<td align="left">no</td>
</tr>
<tr class="odd">
<td align="left">20230718-012805-2412.jpg</td>
<td align="right">590298</td>
<td align="left">FALSE</td>
<td align="right">666</td>
<td align="left">2023-07-17 22:28:04</td>
<td align="left">no</td>
</tr>
<tr class="even">
<td align="left">20230718-012805-2413.jpg</td>
<td align="right">583264</td>
<td align="left">FALSE</td>
<td align="right">666</td>
<td align="left">2023-07-17 22:28:04</td>
<td align="left">no</td>
</tr>
<tr class="odd">
<td align="left">20230718-012858-2414.jpg</td>
<td align="right">697853</td>
<td align="left">FALSE</td>
<td align="right">666</td>
<td align="left">2023-07-17 22:28:58</td>
<td align="left">no</td>
</tr>
<tr class="even">
<td align="left">20230718-012859-2415.jpg</td>
<td align="right">703233</td>
<td align="left">FALSE</td>
<td align="right">666</td>
<td align="left">2023-07-17 22:28:58</td>
<td align="left">no</td>
</tr>
<tr class="odd">
<td align="left">20230718-012900-2416.jpg</td>
<td align="right">689682</td>
<td align="left">FALSE</td>
<td align="right">666</td>
<td align="left">2023-07-17 22:29:00</td>
<td align="left">no</td>
</tr>
<tr class="even">
<td align="left">20230718-012935-2417.jpg</td>
<td align="right">654982</td>
<td align="left">FALSE</td>
<td align="right">666</td>
<td align="left">2023-07-17 22:29:34</td>
<td align="left">no</td>
</tr>
<tr class="odd">
<td align="left">20230718-012935-2418.jpg</td>
<td align="right">663912</td>
<td align="left">FALSE</td>
<td align="right">666</td>
<td align="left">2023-07-17 22:29:36</td>
<td align="left">no</td>
</tr>
<tr class="even">
<td align="left">20230718-013018-2419.jpg</td>
<td align="right">559580</td>
<td align="left">FALSE</td>
<td align="right">666</td>
<td align="left">2023-07-17 22:30:18</td>
<td align="left">no</td>
</tr>
<tr class="odd">
<td align="left">20230718-013018-2420.jpg</td>
<td align="right">550939</td>
<td align="left">FALSE</td>
<td align="right">666</td>
<td align="left">2023-07-17 22:30:18</td>
<td align="left">no</td>
</tr>
<tr class="even">
<td align="left">20230718-013111-2430.jpg</td>
<td align="right">631630</td>
<td align="left">FALSE</td>
<td align="right">666</td>
<td align="left">2023-07-17 22:31:12</td>
<td align="left">no</td>
</tr>
<tr class="odd">
<td align="left">20230718-013119-2431.jpg</td>
<td align="right">624154</td>
<td align="left">FALSE</td>
<td align="right">666</td>
<td align="left">2023-07-17 22:31:18</td>
<td align="left">no</td>
</tr>
<tr class="even">
<td align="left">20230718-013121-2432.jpg</td>
<td align="right">620069</td>
<td align="left">FALSE</td>
<td align="right">666</td>
<td align="left">2023-07-17 22:31:20</td>
<td align="left">no</td>
</tr>
<tr class="odd">
<td align="left">20230718-014054-2433.jpg</td>
<td align="right">628477</td>
<td align="left">FALSE</td>
<td align="right">666</td>
<td align="left">2023-07-17 22:40:54</td>
<td align="left">no</td>
</tr>
<tr class="even">
<td align="left">20230718-014055-2434.jpg</td>
<td align="right">626081</td>
<td align="left">FALSE</td>
<td align="right">666</td>
<td align="left">2023-07-17 22:40:56</td>
<td align="left">no</td>
</tr>
<tr class="odd">
<td align="left">20230718-014055-2435.jpg</td>
<td align="right">634811</td>
<td align="left">FALSE</td>
<td align="right">666</td>
<td align="left">2023-07-17 22:40:56</td>
<td align="left">no</td>
</tr>
<tr class="even">
<td align="left">20230718-151545-3877.jpg</td>
<td align="right">1021547</td>
<td align="left">FALSE</td>
<td align="right">666</td>
<td align="left">2023-07-18 12:15:44</td>
<td align="left">no</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Время съёмки извлекать из EXIF. Очень часто при серийной съемке изображения находятся в оперативной памяти фотоаппарата и последовательно записываются на карту памяти. Этот процесс может занять несколько секунд. Это наиболее критично при авиаучётах.</p>
<div id="exif-в-qgis" class="section level3 unlisted unnumbered">
<h3 class="unlisted unnumbered">EXIF в QGIS</h3>
<p class="centered-image"><img src="assets/lesson12/AddRaster.jpg" width="974" height="672" contain /></p>
<p class="centered-image"><img src="assets/lesson12/SelectRaster.jpg" width="609" height="672" contain /></p>
<p class="centered-image"><img src="assets/lesson12/RasterProperties.jpg" width="855" height="672" contain /></p>
<p class="centered-image"><img src="assets/lesson12/qgisEXIF.jpg" width="674" height="672" contain /></p>
</div>
<div id="exif-в-r" class="section level3 unlisted unnumbered">
<h3 class="unlisted unnumbered">EXIF в R</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>sf<span class="sc">::</span><span class="fu">gdal_utils</span>(<span class="st">&quot;info&quot;</span>,<span class="st">&quot;./input/DSC_2414.JPG&quot;</span>)</span></code></pre></div>
<pre><code>Driver: JPEG/JPEG JFIF
Files: ./input/DSC_2414.JPG
Size is 2144, 1429
Metadata:
  EXIF_Artist=
  EXIF_CFAPattern=0x02 0x00 0x02 0x00 0x00 0x01 0x01 0x02
  EXIF_ColorSpace=1
  EXIF_ComponentsConfiguration=0x01 0x02 0x03 0x00
  EXIF_CompressedBitsPerPixel=(4)
  EXIF_Contrast=0
  EXIF_Copyright=
  EXIF_CustomRendered=0
  EXIF_DateTime=2023:07:18 01:28:58
  EXIF_DateTimeDigitized=2023:07:18 01:28:58
  EXIF_DateTimeOriginal=2023:07:18 01:28:58
  EXIF_ExifVersion=0231
  EXIF_ExposureBiasValue=(0)
  EXIF_ExposureMode=0
  EXIF_ExposureProgram=4
  EXIF_ExposureTime=(0.0005)
  EXIF_FileSource=0x03
  EXIF_Flash=16
  EXIF_FlashpixVersion=0100
  EXIF_FNumber=(3.2)
  EXIF_FocalLength=(200)
  EXIF_FocalLengthIn35mmFilm=300
  EXIF_GainControl=0
  EXIF_GPSVersionID=0x02 0x03 0x00 0x00
  EXIF_Interoperability_Index=R98
  EXIF_Interoperability_Version=0x30 0x31 0x30 0x30
  EXIF_ISOSpeedRatings=160
  EXIF_LightSource=0
  EXIF_Make=NIKON CORPORATION
  EXIF_MakerNote=Nikon
  EXIF_MaxApertureValue=(3)
  EXIF_MeteringMode=3
  EXIF_Model=NIKON D7500
  EXIF_OffsetTime=+00:00
  EXIF_OffsetTimeDigitized=+00:00
  EXIF_OffsetTimeOriginal=+00:00
  EXIF_Orientation=1
  EXIF_PixelXDimension=2144
  EXIF_PixelYDimension=1429
  EXIF_RecommendedExposureIndex=160
  EXIF_ResolutionUnit=2
  EXIF_Saturation=0
  EXIF_SceneCaptureType=0
  EXIF_SceneType=0x01
  EXIF_SensingMethod=2
  EXIF_SensitivityType=2
  EXIF_Sharpness=0
  EXIF_Software=Ver.1.10 
  EXIF_SubjectDistanceRange=0
  EXIF_SubSecTime=58
  EXIF_SubSecTime_Digitized=58
  EXIF_SubSecTime_Original=58
  EXIF_UserComment=
  EXIF_WhiteBalance=0
  EXIF_XResolution=(300)
  EXIF_YCbCrPositioning=2
  EXIF_YResolution=(300)
Image Structure Metadata:
  SOURCE_COLOR_SPACE=YCbCr
  INTERLEAVE=PIXEL
  COMPRESSION=JPEG
  JPEG_QUALITY=95
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0, 1429.0)
Upper Right ( 2144.0,    0.0)
Lower Right ( 2144.0, 1429.0)
Center      ( 1072.0,  714.5)
Band 1 Block=2144x1 Type=Byte, ColorInterp=Red
  Overviews: 1072x715, 536x358, 268x179, 160x107
  Image Structure Metadata:
    COMPRESSION=JPEG
Band 2 Block=2144x1 Type=Byte, ColorInterp=Green
  Overviews: 1072x715, 536x358, 268x179, 160x107
  Image Structure Metadata:
    COMPRESSION=JPEG
Band 3 Block=2144x1 Type=Byte, ColorInterp=Blue
  Overviews: 1072x715, 536x358, 268x179, 160x107
  Image Structure Metadata:
    COMPRESSION=JPEG</code></pre>
</div>
<div id="переименование-в-r" class="section level3 unlisted unnumbered">
<h3 class="unlisted unnumbered">Переименование в R</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>tz <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;D7500&#39;</span><span class="ot">=</span><span class="st">&quot;UTC&quot;</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>       ,<span class="st">&#39;Oregon&#39;</span><span class="ot">=</span><span class="st">&quot;Asia/Krasnoyarsk&quot;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>user <span class="ot">&lt;-</span> <span class="st">&quot;D7500&quot;</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>src <span class="ot">&lt;-</span> <span class="st">&quot;./input/DSC_2414.JPG&quot;</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="fu">file.info</span>(src)</span></code></pre></div>
<div class="kable-table">
<table>
<colgroup>
<col width="20%" />
<col width="6%" />
<col width="5%" />
<col width="4%" />
<col width="19%" />
<col width="19%" />
<col width="19%" />
<col width="3%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">size</th>
<th align="left">isdir</th>
<th align="right">mode</th>
<th align="left">mtime</th>
<th align="left">ctime</th>
<th align="left">atime</th>
<th align="left">exe</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">./input/DSC_2414.JPG</td>
<td align="right">697853</td>
<td align="left">FALSE</td>
<td align="right">666</td>
<td align="left">2023-07-17 22:28:58</td>
<td align="left">2025-02-04 12:32:44</td>
<td align="left">2025-02-05 13:59:48</td>
<td align="left">no</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>photoID <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;.*</span><span class="sc">\\</span><span class="st">D(</span><span class="sc">\\</span><span class="st">d{4})</span><span class="sc">\\</span><span class="st">D.*&quot;</span>,<span class="st">&quot;</span><span class="sc">\\</span><span class="st">1&quot;</span>,<span class="fu">basename</span>(src))</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">gdal_utils</span>(<span class="st">&quot;info&quot;</span>,src,<span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(a,<span class="at">split=</span><span class="st">&quot;</span><span class="sc">\\</span><span class="st">n&quot;</span>)[[<span class="dv">1</span>]]</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>patt1 <span class="ot">&lt;-</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">s*EXIF_DateTimeOriginal=(.+)&quot;</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(ind1 <span class="ot">&lt;-</span> <span class="fu">grep</span>(patt1,a))<span class="sc">==</span><span class="dv">1</span>) {</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>   t3 <span class="ot">&lt;-</span> <span class="fu">gsub</span>(patt1,<span class="st">&quot;</span><span class="sc">\\</span><span class="st">1&quot;</span>,a[ind1])</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>   t3 <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(t3,<span class="at">format=</span><span class="st">&quot;%Y:%m:%d %H:%M:%S&quot;</span>,<span class="at">tz=</span><span class="st">&quot;UTC&quot;</span>)</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>   patt2 <span class="ot">&lt;-</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">s*EXIF_OffsetTimeOriginal=(.+)&quot;</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>   <span class="cf">if</span> (<span class="fu">length</span>(ind2 <span class="ot">&lt;-</span> <span class="fu">grep</span>(patt2,a))<span class="sc">==</span><span class="dv">1</span>) {</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>      tz3 <span class="ot">&lt;-</span> <span class="fu">gsub</span>(patt2,<span class="st">&quot;</span><span class="sc">\\</span><span class="st">1&quot;</span>,a[ind2])</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">c</span>(<span class="at">TZ=</span>tz3))</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>      t3 <span class="ot">&lt;-</span> t3<span class="sc">-</span>(<span class="fu">as.difftime</span>(<span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">&quot;^(.+):(.+)$&quot;</span>,<span class="st">&quot;</span><span class="sc">\\</span><span class="st">1&quot;</span>,tz3))<span class="sc">+</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>            <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">&quot;^(.+):(.+)$&quot;</span>,<span class="st">&quot;</span><span class="sc">\\</span><span class="st">2&quot;</span>,tz3))<span class="sc">/</span><span class="dv">60</span>,<span class="at">units=</span><span class="st">&quot;hours&quot;</span>))</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>      t3 <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(t3,<span class="at">tz=</span>tz[user])</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>   }</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>   <span class="fu">print</span>(<span class="fu">c</span>(<span class="at">t3=</span>t3))</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>   <span class="fu">print</span>(<span class="fu">c</span>(<span class="at">photoID=</span>photoID))</span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>   dst <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;./output&quot;</span>,<span class="fu">paste0</span>(<span class="fu">format</span>(t3,<span class="st">&quot;%Y%m%d-%H%M%S-&quot;</span>),photoID</span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>                                 ,<span class="fu">tolower</span>(<span class="fu">gsub</span>(<span class="st">&quot;.*(</span><span class="sc">\\</span><span class="st">..+$)&quot;</span>,<span class="st">&quot;</span><span class="sc">\\</span><span class="st">1&quot;</span>,<span class="fu">basename</span>(src)))</span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a>                                 ))</span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>   <span class="fu">print</span>(<span class="fu">data.frame</span>(<span class="st">&#39;src&#39;</span><span class="ot">=</span>src,<span class="st">&#39;dst&#39;</span><span class="ot">=</span>dst))</span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>      TZ 
&quot;+00:00&quot; 
                       t3 
&quot;2023-07-18 01:28:58 UTC&quot; 
photoID 
 &quot;2414&quot; 
                   src                               dst
1 ./input/DSC_2414.JPG ./output/20230718-012858-2414.jpg</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="st">&quot;./output&quot;</span>))</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>   <span class="fu">dir.create</span>(<span class="st">&quot;./output&quot;</span>)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co"># file.rename(src,dst)</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="fu">file.copy</span>(src,dst,<span class="at">overwrite=</span><span class="cn">TRUE</span>,<span class="at">copy.date=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<div id="после-авиаучёта" class="section level2">
<h2>После авиаучёта</h2>
<p>Полётное время и дальность полёта не позволяет провести учёт галсами.</p>
<p>Учёт наиболее населенной страты местообитаний, с манёврами.</p>
<p>Таблица находок формируется в ГИС с целью исключить повторный учёт.</p>
<p class="centered-image"><img src="assets/lesson12/aerial1.jpg" width="883" height="672" contain /></p>
<p class="centered-image"><img src="assets/lesson12/aerial2.jpg" width="818" height="672" contain /></p>
<div class="youturn">
<h1 class="toc-ignore unnumbered unlisted">
You turn
</h1>
<ul>
<li><p>Загрузить фотографию</p></li>
<li><p>Посмотреть ее свойства</p></li>
</ul>
</div>
</div>
</div>
<div id="треки" class="section level1">
<h1>Треки</h1>
<p>Треки - запись фактического маршрута. Непрерывный трек желателен для включения в отчёт.</p>
<p>Непрерывная запись треков маловероятна:</p>
<ul>
<li><p>Выключение устройства с целью замены батареек/аккумуляторов.</p></li>
<li><p><span class="serga">Батарейки сели</span></p></li>
<li><p>Спутники нашлись не сразу или забыли вовремя включить</p></li>
</ul>
<p>В итоге, запись маршрута фрагментарна. Необходимость объединения фрагментов.</p>
<div id="объединение-фрагментов" class="section level2">
<h2>Объединение фрагментов</h2>
<p>Запись трека осуществлялась несколькми устройствами. Устройство «Zhenya» находилось в каюте, устройство «Oregon» – у наблюдателя. Приоритетным считается устройство наблюдателя, но в случае отсутствия записи с устройства наблюдателя используются записи с запасного устройстваю</p>
<div id="в-r" class="section level3 unlisted unnumbered">
<h3 class="unlisted unnumbered">в R</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">Sys.setenv</span>(<span class="at">TZ=</span><span class="st">&quot;UTC&quot;</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(<span class="st">&quot;2023-07-04&quot;</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="st">&#39;getTrack&#39;</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(device,<span class="at">vehicle=</span><span class="cn">FALSE</span>,<span class="at">ltraj=</span><span class="cn">FALSE</span>,<span class="at">inside=</span><span class="cn">NULL</span>) {</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>   <span class="cf">if</span> (<span class="fu">missing</span>(device))</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>      <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>   <span class="cf">if</span> (<span class="sc">!</span>ursa<span class="sc">::</span><span class="fu">is_spatial</span>(device)) {</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>      list1 <span class="ot">&lt;-</span> <span class="fu">dir</span>(<span class="at">path=</span><span class="fu">file.path</span>(<span class="st">&quot;./input&quot;</span>,device)</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>                  ,<span class="at">pattern=</span><span class="st">&quot;.*20[x2]3.+</span><span class="sc">\\</span><span class="st">.gpx$&quot;</span>,<span class="at">full.names=</span><span class="cn">TRUE</span>)</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>      res <span class="ot">&lt;-</span> <span class="fu">lapply</span>(list1,\(fname) {</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>         a <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_read</span>(fname,<span class="at">layer=</span><span class="st">&quot;track_points&quot;</span>,<span class="at">quiet=</span><span class="cn">TRUE</span>)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>         a <span class="ot">&lt;-</span> a[<span class="sc">!</span><span class="fu">is.na</span>(a<span class="sc">$</span>time),]</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>         <span class="cf">if</span> (<span class="sc">!</span>ursa<span class="sc">::</span><span class="fu">spatial_count</span>(a))</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>            <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>         taf <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">track_fid=</span>a<span class="sc">$</span>track_fid)</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>         tas <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">track_seg_id=</span>a<span class="sc">$</span>track_seg_id)</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>         <span class="cf">if</span> (<span class="fu">length</span>(tas)<span class="sc">&gt;</span><span class="fu">length</span>(taf)) {</span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>            b <span class="ot">&lt;-</span> <span class="fu">by</span>(a,a<span class="sc">$</span>track_seg_id,\(x) x)</span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>         }</span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a>         <span class="cf">else</span> {</span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a>            b <span class="ot">&lt;-</span> <span class="fu">by</span>(a,a<span class="sc">$</span>track_fid,\(x) x)</span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a>         }</span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a>         a <span class="ot">&lt;-</span> <span class="fu">lapply</span>(b,\(x) {</span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a>            rt <span class="ot">&lt;-</span> <span class="fu">range</span>(x<span class="sc">$</span>time)</span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a>            y <span class="ot">&lt;-</span> ursa<span class="sc">::</span><span class="fu">trackline</span>(x)</span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a>            len <span class="ot">&lt;-</span> ursa<span class="sc">::</span><span class="fu">spatial_length</span>(y)</span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a>            dur <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">diff</span>(<span class="fu">range</span>(x<span class="sc">$</span>time)),<span class="at">units=</span><span class="st">&quot;hours&quot;</span>)</span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a>            speed <span class="ot">&lt;-</span> len<span class="sc">*</span><span class="fl">1e-3</span><span class="sc">/</span>dur</span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a>            sa <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n=</span>ursa<span class="sc">::</span><span class="fu">spatial_count</span>(x),<span class="at">length=</span>len,<span class="at">dur=</span>dur,<span class="at">speed=</span>speed</span>
<span id="cb10-29"><a href="#cb10-29" tabindex="-1"></a>                            ,<span class="at">from=</span>rt[<span class="dv">1</span>],<span class="at">to=</span>rt[<span class="dv">2</span>])</span>
<span id="cb10-30"><a href="#cb10-30" tabindex="-1"></a>            cond1 <span class="ot">&lt;-</span> sa<span class="sc">$</span>dur<span class="sc">&gt;</span><span class="dv">10</span><span class="sc">/</span><span class="dv">60</span> <span class="sc">&amp;</span> sa<span class="sc">$</span>n<span class="sc">&gt;</span><span class="dv">10</span></span>
<span id="cb10-31"><a href="#cb10-31" tabindex="-1"></a>            sa <span class="ot">&lt;-</span> sa[cond1,]</span>
<span id="cb10-32"><a href="#cb10-32" tabindex="-1"></a>            <span class="cf">if</span> (<span class="sc">!</span>cond1)</span>
<span id="cb10-33"><a href="#cb10-33" tabindex="-1"></a>               <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb10-34"><a href="#cb10-34" tabindex="-1"></a>            x<span class="sc">$</span>device <span class="ot">&lt;-</span> <span class="fu">tolower</span>(device)</span>
<span id="cb10-35"><a href="#cb10-35" tabindex="-1"></a>            x<span class="sc">$</span>segment <span class="ot">&lt;-</span> digest<span class="sc">::</span><span class="fu">digest</span>(x,<span class="st">&quot;crc32&quot;</span>)</span>
<span id="cb10-36"><a href="#cb10-36" tabindex="-1"></a>            <span class="fu">tail</span>(x[,<span class="fu">c</span>(<span class="st">&quot;time&quot;</span>,<span class="st">&quot;ele&quot;</span>,<span class="st">&quot;device&quot;</span>,<span class="st">&quot;segment&quot;</span>)],<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb10-37"><a href="#cb10-37" tabindex="-1"></a>         }) <span class="sc">|&gt;</span> <span class="fu">do.call</span>(ursa<span class="sc">::</span>spatial_bind,<span class="at">args=</span>_)</span>
<span id="cb10-38"><a href="#cb10-38" tabindex="-1"></a>         a</span>
<span id="cb10-39"><a href="#cb10-39" tabindex="-1"></a>      }) <span class="sc">|&gt;</span> ursa<span class="sc">::</span><span class="fu">spatial_bind</span>()</span>
<span id="cb10-40"><a href="#cb10-40" tabindex="-1"></a>      res <span class="ot">&lt;-</span> res[<span class="fu">order</span>(res<span class="sc">$</span>time),]</span>
<span id="cb10-41"><a href="#cb10-41" tabindex="-1"></a>      <span class="cf">if</span> (vehicle) {</span>
<span id="cb10-42"><a href="#cb10-42" tabindex="-1"></a>         <span class="cf">if</span> (<span class="fu">length</span>(ind <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;^(cruise|road)&quot;</span>,res<span class="sc">$</span>survey,<span class="at">invert=</span><span class="cn">TRUE</span>))) {</span>
<span id="cb10-43"><a href="#cb10-43" tabindex="-1"></a>            res <span class="ot">&lt;-</span> res[<span class="sc">-</span>ind,]</span>
<span id="cb10-44"><a href="#cb10-44" tabindex="-1"></a>         }</span>
<span id="cb10-45"><a href="#cb10-45" tabindex="-1"></a>      }</span>
<span id="cb10-46"><a href="#cb10-46" tabindex="-1"></a>      <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(inside)) {</span>
<span id="cb10-47"><a href="#cb10-47" tabindex="-1"></a>         cond <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>,<span class="fu">nrow</span>(inside))</span>
<span id="cb10-48"><a href="#cb10-48" tabindex="-1"></a>         <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="fu">nrow</span>(inside))) {</span>
<span id="cb10-49"><a href="#cb10-49" tabindex="-1"></a>            <span class="cf">if</span> (<span class="sc">!</span>inside<span class="sc">$</span>fill[i])</span>
<span id="cb10-50"><a href="#cb10-50" tabindex="-1"></a>               cond[[i]] <span class="ot">&lt;-</span> <span class="fu">integer</span>()</span>
<span id="cb10-51"><a href="#cb10-51" tabindex="-1"></a>            <span class="cf">else</span> {</span>
<span id="cb10-52"><a href="#cb10-52" tabindex="-1"></a>               j <span class="ot">&lt;-</span> <span class="fu">which</span>(res<span class="sc">$</span>time<span class="sc">&gt;</span>inside<span class="sc">$</span>begin[i] <span class="sc">&amp;</span> res<span class="sc">$</span>time<span class="sc">&lt;</span>inside<span class="sc">$</span>end[i])</span>
<span id="cb10-53"><a href="#cb10-53" tabindex="-1"></a>               cond[[i]] <span class="ot">&lt;-</span> j</span>
<span id="cb10-54"><a href="#cb10-54" tabindex="-1"></a>            }</span>
<span id="cb10-55"><a href="#cb10-55" tabindex="-1"></a>         }</span>
<span id="cb10-56"><a href="#cb10-56" tabindex="-1"></a>         cond <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unlist</span>(cond))</span>
<span id="cb10-57"><a href="#cb10-57" tabindex="-1"></a>         <span class="cf">if</span> (<span class="sc">!</span><span class="fu">length</span>(cond))</span>
<span id="cb10-58"><a href="#cb10-58" tabindex="-1"></a>            <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb10-59"><a href="#cb10-59" tabindex="-1"></a>         res <span class="ot">&lt;-</span> res[cond,]</span>
<span id="cb10-60"><a href="#cb10-60" tabindex="-1"></a>      }</span>
<span id="cb10-61"><a href="#cb10-61" tabindex="-1"></a>      res<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="st">&quot;merge&quot;</span></span>
<span id="cb10-62"><a href="#cb10-62" tabindex="-1"></a>   }</span>
<span id="cb10-63"><a href="#cb10-63" tabindex="-1"></a>   <span class="cf">else</span> {</span>
<span id="cb10-64"><a href="#cb10-64" tabindex="-1"></a>      res <span class="ot">&lt;-</span> device</span>
<span id="cb10-65"><a href="#cb10-65" tabindex="-1"></a>      ltraj <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb10-66"><a href="#cb10-66" tabindex="-1"></a>   }</span>
<span id="cb10-67"><a href="#cb10-67" tabindex="-1"></a>   <span class="cf">if</span> (<span class="sc">!</span>ltraj)</span>
<span id="cb10-68"><a href="#cb10-68" tabindex="-1"></a>      <span class="fu">return</span>(res)</span>
<span id="cb10-69"><a href="#cb10-69" tabindex="-1"></a>   <span class="cf">if</span> (<span class="fu">length</span>(ind <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">duplicated</span>(res<span class="sc">$</span>time)))) {</span>
<span id="cb10-70"><a href="#cb10-70" tabindex="-1"></a>      res <span class="ot">&lt;-</span> res[<span class="sc">-</span>ind,]</span>
<span id="cb10-71"><a href="#cb10-71" tabindex="-1"></a>   }</span>
<span id="cb10-72"><a href="#cb10-72" tabindex="-1"></a>   res2 <span class="ot">&lt;-</span> adehabitatLT<span class="sc">::</span><span class="fu">as.ltraj</span>(sf<span class="sc">::</span><span class="fu">st_coordinates</span>(res)</span>
<span id="cb10-73"><a href="#cb10-73" tabindex="-1"></a>                                 ,<span class="at">date=</span>res<span class="sc">$</span>time</span>
<span id="cb10-74"><a href="#cb10-74" tabindex="-1"></a>                                 ,<span class="at">id=</span>res<span class="sc">$</span>id</span>
<span id="cb10-75"><a href="#cb10-75" tabindex="-1"></a>                                 ,<span class="at">proj4string=</span>sp<span class="sc">::</span><span class="fu">CRS</span>(sf<span class="sc">::</span><span class="fu">st_crs</span>(res)<span class="sc">$</span>proj4string)</span>
<span id="cb10-76"><a href="#cb10-76" tabindex="-1"></a>                                 )</span>
<span id="cb10-77"><a href="#cb10-77" tabindex="-1"></a>   opW <span class="ot">&lt;-</span> <span class="fu">options</span>(<span class="at">warn=</span><span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb10-78"><a href="#cb10-78" tabindex="-1"></a>   res3 <span class="ot">&lt;-</span> adehabitatLT<span class="sc">::</span><span class="fu">cutltraj</span>(res2,<span class="st">&quot;dt&gt;c(days=1)*c(hour=1)*c(min=12)*c(sec=60)&quot;</span></span>
<span id="cb10-79"><a href="#cb10-79" tabindex="-1"></a>                                 ,<span class="at">nextr=</span><span class="cn">TRUE</span>)</span>
<span id="cb10-80"><a href="#cb10-80" tabindex="-1"></a>   <span class="fu">options</span>(opW)</span>
<span id="cb10-81"><a href="#cb10-81" tabindex="-1"></a>   res3</span>
<span id="cb10-82"><a href="#cb10-82" tabindex="-1"></a>}</span>
<span id="cb10-83"><a href="#cb10-83" tabindex="-1"></a><span class="st">&#39;inside&#39;</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(device,<span class="at">dt=</span><span class="fu">as.difftime</span>(<span class="dv">12</span>,<span class="at">units=</span><span class="st">&quot;mins&quot;</span>),<span class="at">dl=</span><span class="dv">50</span>) {</span>
<span id="cb10-84"><a href="#cb10-84" tabindex="-1"></a>   <span class="cf">if</span> (<span class="fu">is.null</span>(device))</span>
<span id="cb10-85"><a href="#cb10-85" tabindex="-1"></a>      <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb10-86"><a href="#cb10-86" tabindex="-1"></a>   ind1 <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">diff</span>(device<span class="sc">$</span>time)<span class="sc">&gt;</span>dt)</span>
<span id="cb10-87"><a href="#cb10-87" tabindex="-1"></a>   begin <span class="ot">&lt;-</span> <span class="fu">c</span>(t0,device<span class="sc">$</span>time[ind1],<span class="fu">max</span>(device<span class="sc">$</span>time)<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb10-88"><a href="#cb10-88" tabindex="-1"></a>   end <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(device<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>,device<span class="sc">$</span>time[ind1<span class="sc">+</span><span class="dv">1</span>],<span class="fu">as.POSIXct</span>(<span class="fu">Sys.Date</span>()<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb10-89"><a href="#cb10-89" tabindex="-1"></a>   ret <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">from=</span><span class="fu">c</span>(<span class="cn">NA</span>,ind1,<span class="cn">NA</span>),<span class="at">to=</span><span class="fu">c</span>(<span class="cn">NA</span>,ind1<span class="sc">+</span><span class="dv">1</span>,<span class="cn">NA</span>)</span>
<span id="cb10-90"><a href="#cb10-90" tabindex="-1"></a>                    ,<span class="at">device=</span><span class="fu">head</span>(device<span class="sc">$</span>device,<span class="dv">1</span>)</span>
<span id="cb10-91"><a href="#cb10-91" tabindex="-1"></a>                    ,<span class="at">begin=</span>begin</span>
<span id="cb10-92"><a href="#cb10-92" tabindex="-1"></a>                    ,<span class="at">end=</span>end</span>
<span id="cb10-93"><a href="#cb10-93" tabindex="-1"></a>                    ,<span class="at">length=</span><span class="cn">NA</span></span>
<span id="cb10-94"><a href="#cb10-94" tabindex="-1"></a>                    ,<span class="at">fill=</span><span class="cn">TRUE</span></span>
<span id="cb10-95"><a href="#cb10-95" tabindex="-1"></a>                    )</span>
<span id="cb10-96"><a href="#cb10-96" tabindex="-1"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="fu">nrow</span>(ret)) <span class="sc">|&gt;</span> <span class="fu">sample</span>()) {</span>
<span id="cb10-97"><a href="#cb10-97" tabindex="-1"></a>      ind <span class="ot">&lt;-</span> <span class="fu">c</span>(ret<span class="sc">$</span>from[i],ret<span class="sc">$</span>to[i])</span>
<span id="cb10-98"><a href="#cb10-98" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">anyNA</span>(ind))</span>
<span id="cb10-99"><a href="#cb10-99" tabindex="-1"></a>         <span class="cf">next</span></span>
<span id="cb10-100"><a href="#cb10-100" tabindex="-1"></a>      ret<span class="sc">$</span>length[i] <span class="ot">&lt;-</span> ursa<span class="sc">::</span><span class="fu">trackline</span>(device[ind,]) <span class="sc">|&gt;</span> ursa<span class="sc">::</span><span class="fu">spatial_length</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>()</span>
<span id="cb10-101"><a href="#cb10-101" tabindex="-1"></a>   }</span>
<span id="cb10-102"><a href="#cb10-102" tabindex="-1"></a>   ret<span class="sc">$</span>dt <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(ret<span class="sc">$</span>end<span class="sc">-</span>ret<span class="sc">$</span>begin,<span class="at">units=</span><span class="st">&quot;hours&quot;</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">1</span>)</span>
<span id="cb10-103"><a href="#cb10-103" tabindex="-1"></a>   ret<span class="sc">$</span>fill[ret<span class="sc">$</span>length<span class="sc">&lt;</span>dl] <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb10-104"><a href="#cb10-104" tabindex="-1"></a>   ret</span>
<span id="cb10-105"><a href="#cb10-105" tabindex="-1"></a>}</span>
<span id="cb10-106"><a href="#cb10-106" tabindex="-1"></a><span class="st">&#39;suppl&#39;</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(main,suppl,<span class="at">vehicle=</span><span class="cn">FALSE</span>) {</span>
<span id="cb10-107"><a href="#cb10-107" tabindex="-1"></a>   more <span class="ot">&lt;-</span> <span class="fu">getTrack</span>(suppl,<span class="at">inside=</span><span class="fu">inside</span>(main),<span class="at">vehicle=</span>vehicle,<span class="at">ltraj=</span><span class="sc">!</span><span class="cn">TRUE</span>)</span>
<span id="cb10-108"><a href="#cb10-108" tabindex="-1"></a>   main <span class="ot">&lt;-</span> ursa<span class="sc">::</span><span class="fu">spatial_bind</span>(main,more)</span>
<span id="cb10-109"><a href="#cb10-109" tabindex="-1"></a>   main <span class="ot">&lt;-</span> main[<span class="fu">order</span>(main<span class="sc">$</span>time),]</span>
<span id="cb10-110"><a href="#cb10-110" tabindex="-1"></a>   main</span>
<span id="cb10-111"><a href="#cb10-111" tabindex="-1"></a>}</span>
<span id="cb10-112"><a href="#cb10-112" tabindex="-1"></a>priority <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">oregon=</span><span class="fu">c</span>(<span class="st">&quot;Oregon&quot;</span>,<span class="st">&quot;Zhenya&quot;</span>))</span>
<span id="cb10-113"><a href="#cb10-113" tabindex="-1"></a>pname <span class="ot">&lt;-</span> <span class="fu">names</span>(priority)</span>
<span id="cb10-114"><a href="#cb10-114" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(priority)) {</span>
<span id="cb10-115"><a href="#cb10-115" tabindex="-1"></a>   <span class="fu">message</span>(pname[i],<span class="st">&quot;:&quot;</span>)</span>
<span id="cb10-116"><a href="#cb10-116" tabindex="-1"></a>   vehicle <span class="ot">&lt;-</span> pname[i] <span class="sc">%in%</span> <span class="st">&quot;general&quot;</span></span>
<span id="cb10-117"><a href="#cb10-117" tabindex="-1"></a>   main <span class="ot">&lt;-</span> <span class="fu">getTrack</span>()</span>
<span id="cb10-118"><a href="#cb10-118" tabindex="-1"></a>   <span class="cf">for</span> (device <span class="cf">in</span> priority[[i]]) {</span>
<span id="cb10-119"><a href="#cb10-119" tabindex="-1"></a>      <span class="fu">message</span>(<span class="st">&quot;   &quot;</span>,device,<span class="st">&quot;:&quot;</span>)</span>
<span id="cb10-120"><a href="#cb10-120" tabindex="-1"></a>      main <span class="ot">&lt;-</span> <span class="fu">suppl</span>(main,device,<span class="at">vehicle=</span>vehicle)</span>
<span id="cb10-121"><a href="#cb10-121" tabindex="-1"></a>   }</span>
<span id="cb10-122"><a href="#cb10-122" tabindex="-1"></a>   <span class="fu">print</span>(<span class="fu">getTrack</span>(main,<span class="at">ltraj=</span><span class="cn">TRUE</span>))</span>
<span id="cb10-123"><a href="#cb10-123" tabindex="-1"></a>   main <span class="ot">&lt;-</span> main[,<span class="fu">c</span>(<span class="st">&quot;id&quot;</span>,<span class="st">&quot;time&quot;</span>,<span class="st">&quot;ele&quot;</span>,<span class="st">&quot;device&quot;</span>)]</span>
<span id="cb10-124"><a href="#cb10-124" tabindex="-1"></a>   trkpt <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;./output&quot;</span>,<span class="fu">paste0</span>(<span class="st">&quot;track-&quot;</span>,pname[i],<span class="st">&quot;.geojson&quot;</span>))</span>
<span id="cb10-125"><a href="#cb10-125" tabindex="-1"></a>   ursa<span class="sc">::</span><span class="fu">spatial_write</span>(main,trkpt)</span>
<span id="cb10-126"><a href="#cb10-126" tabindex="-1"></a>   <span class="fu">print</span>(<span class="fu">file.info</span>(trkpt)[,<span class="st">&quot;size&quot;</span>,<span class="at">drop=</span><span class="cn">FALSE</span>])</span>
<span id="cb10-127"><a href="#cb10-127" tabindex="-1"></a>   tr <span class="ot">&lt;-</span> ursa<span class="sc">::</span><span class="fu">trackline</span>(main,<span class="at">by=</span>main<span class="sc">$</span>id,<span class="at">connect=</span><span class="st">&quot;united&quot;</span>)</span>
<span id="cb10-128"><a href="#cb10-128" tabindex="-1"></a>   trkln <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="fu">dirname</span>(trkpt),<span class="fu">gsub</span>(<span class="st">&quot;^track&quot;</span>,<span class="st">&quot;trackline&quot;</span>,<span class="fu">basename</span>(trkpt)))</span>
<span id="cb10-129"><a href="#cb10-129" tabindex="-1"></a>   ursa<span class="sc">::</span><span class="fu">spatial_write</span>(tr,trkln)</span>
<span id="cb10-130"><a href="#cb10-130" tabindex="-1"></a>   <span class="fu">print</span>(<span class="fu">file.info</span>(trkln)[,<span class="st">&quot;size&quot;</span>,<span class="at">drop=</span><span class="cn">FALSE</span>])</span>
<span id="cb10-131"><a href="#cb10-131" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>
*********** List of class ltraj ***********

Type of the traject: Type II (time recorded)
* Time zone unspecified: dates printed in user time zone *
Irregular traject. Variable time lag between two locs

Characteristics of the bursts:
     id   burst nb.reloc NAs          date.begin            date.end
1 merge merge.1     1863   0 2023-07-17 15:52:54 2023-07-18 09:13:54
2 merge merge.2       83   0 2023-07-18 13:13:47 2023-07-18 13:52:48
3 merge merge.3      447   0 2023-07-18 14:39:20 2023-07-18 17:01:13


 infolocs provided. The following variables are available:
[1] &quot;pkey&quot;
                                size
./output/track-oregon.geojson 411357
                                   size
./output/trackline-oregon.geojson 52240</code></pre>
</div>
<div id="в-qgis" class="section level3 unlisted unnumbered">
<h3 class="unlisted unnumbered">в QGIS</h3>
<p>Поискать подходящий среди плагинов</p>
<p class="centered-image"><img src="assets/lesson12/PluginsGPSimporter.jpg" width="792" height="592" contain /></p>
<p>Например, Batch GPS Importer</p>
<p class="centered-image"><img src="assets/lesson12/BatchGPSimporter.jpg" width="630" height="592" contain /></p>
</div>
</div>
<div id="визуализация" class="section level2">
<h2>Визуализация</h2>
<div id="в-r-1" class="section level3 unlisted unnumbered">
<h3 class="unlisted unnumbered">в R</h3>
<div class="font97">
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>ursa<span class="sc">::</span><span class="fu">glance</span>(<span class="st">&quot;./output/track-oregon.geojson&quot;</span>,<span class="at">field=</span><span class="st">&quot;device&quot;</span>,<span class="at">plot.lwd=</span><span class="fl">0.001</span>)</span></code></pre></div>
<p class="centered-image"><img src="assets/lesson12/ursa01_unnamed-chunk-30.png" width="521" /></p>
</div>
<div class="font97">
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>ursa<span class="sc">::</span><span class="fu">glance</span>(<span class="st">&quot;./output/trackline-oregon.geojson&quot;</span>)</span></code></pre></div>
<p class="centered-image"><img src="assets/lesson12/ursa03_unnamed-chunk-31.png" width="497" /></p>
</div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">require</span>(ursa)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">print</span>(trkpt <span class="ot">&lt;-</span> <span class="fu">spatial_read</span>(<span class="st">&quot;./input/track-general.geojson&quot;</span>))</span></code></pre></div>
<pre><code>Simple feature collection with 30395 features and 4 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: -1821458 ymin: -2215496 xmax: 119951.6 ymax: -954666
Projected CRS: PROJCRS[&quot;unknown&quot;,
    BASEGEOGCRS[&quot;unknown&quot;,
        DATUM[&quot;World Geodetic System 1984&quot;,
            ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
                LENGTHUNIT[&quot;metre&quot;,1]],
            ID[&quot;EPSG&quot;,6326]],
        PRIMEM[&quot;Greenwich&quot;,0,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8901]]],
    CONVERSION[&quot;unknown&quot;,
        METHOD[&quot;Polar Stereographic (variant B)&quot;,
            ID[&quot;EPSG&quot;,9829]],
        PARAMETER[&quot;Latitude of standard parallel&quot;,73.0118,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8832]],
        PARAMETER[&quot;Longitude of origin&quot;,79.2854,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8833]],
        PARAMETER[&quot;False easting&quot;,0,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8806]],
        PARAMETER[&quot;False northing&quot;,0,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8807]]],
    CS[Cartesian,2],
        AXIS[&quot;(E)&quot;,south,
            MERIDIAN[90,
                ANGLEUNIT[&quot;degree&quot;,0.0174532925199433,
                    ID[&quot;EPSG&quot;,9122]]],
            ORDER[1],
            LENGTHUNIT[&quot;metre&quot;,1,
                ID[&quot;EPSG&quot;,9001]]],
        AXIS[&quot;(N)&quot;,south,
            MERIDIAN[180,
                ANGLEUNIT[&quot;degree&quot;,0.0174532925199433,
                    ID[&quot;EPSG&quot;,9122]]],
            ORDER[2],
            LENGTHUNIT[&quot;metre&quot;,1,
                ID[&quot;EPSG&quot;,9001]]]]
First 10 features:
      id                time   ele device                  geometry
1  merge 2023-07-04 07:33:55 -6.75 zhenya POINT (-1771075 -2204679)
2  merge 2023-07-04 07:34:55 -6.27 zhenya POINT (-1771055 -2204634)
3  merge 2023-07-04 07:35:55 -6.41 zhenya POINT (-1771011 -2204556)
4  merge 2023-07-04 07:36:55 -6.22 zhenya POINT (-1770954 -2204470)
5  merge 2023-07-04 07:37:55 -6.12 zhenya POINT (-1770939 -2204446)
6  merge 2023-07-04 07:38:55 -6.62 zhenya POINT (-1770978 -2204480)
7  merge 2023-07-04 07:39:55 -6.96 zhenya POINT (-1771069 -2204512)
8  merge 2023-07-04 07:40:55 -6.93 zhenya POINT (-1771156 -2204518)
9  merge 2023-07-04 07:41:55 -7.51 zhenya POINT (-1771202 -2204509)
10 merge 2023-07-04 07:42:55 -7.51 zhenya POINT (-1771190 -2204494)</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">print</span>(trkln <span class="ot">&lt;-</span> <span class="fu">trackline</span>(trkpt))</span></code></pre></div>
<pre><code>Geometry set for 1 feature 
Geometry type: LINESTRING
Dimension:     XY
Bounding box:  xmin: -1821458 ymin: -2215496 xmax: 119951.6 ymax: -954666
Projected CRS: +proj=stere +lat_0=90 +lat_ts=73.0118 +lon_0=79.2854 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">glance</span>(trkln,<span class="at">style=</span><span class="st">&quot;2gis&quot;</span>)</span></code></pre></div>
<p class="centered-image"><img src="assets/lesson12/ursa05_unnamed-chunk-33.png" width="214" height="620" contain /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>trkdaily <span class="ot">&lt;-</span> <span class="fu">trackline</span>(trkpt,<span class="at">by=</span><span class="fu">list</span>(<span class="st">&#39;Дата&#39;</span><span class="ot">=</span><span class="fu">as.Date</span>(trkpt<span class="sc">$</span>time)))</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>ct <span class="ot">&lt;-</span> <span class="fu">colorize</span>(trkdaily<span class="sc">$</span><span class="st">&#39;Дата&#39;</span>,<span class="at">pal.bright=</span><span class="dv">127</span>,<span class="at">pal.rotate=</span><span class="st">&quot;circle&quot;</span>) <span class="sc">|&gt;</span> <span class="fu">ursa_colortable</span>()</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="fu">glance</span>(trkdaily[<span class="st">&quot;Дата&quot;</span>],<span class="at">col=</span>ct,<span class="at">resetGrid=</span><span class="cn">TRUE</span>,<span class="at">blank=</span><span class="st">&quot;aliceblue&quot;</span>,<span class="at">coast.fill=</span><span class="st">&quot;lightyellow&quot;</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>      ,<span class="at">basemap.order=</span><span class="st">&quot;before&quot;</span>,<span class="at">pointsize=</span><span class="dv">12</span>)</span></code></pre></div>
<p class="centered-image"><img src="assets/lesson12/ursa07_unnamed-chunk-34.png" width="715" height="535" contain /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>mapview<span class="sc">::</span><span class="fu">mapview</span>(trkln)</span></code></pre></div>
<div class="framed">
<iframe src="assets/lesson12/widget_unnamed-chunk-36_9c4ee5bb48fe81fe5f5cd8b8bf8614cb.html" width="646.08" height="400px" data-external="1" class="ursa-widgetize">
</iframe>
</div>
</div>
<div id="в-qgis-1" class="section level3 unlisted unnumbered">
<h3 class="unlisted unnumbered">в QGIS</h3>
<p class="centered-image"><img src="assets/lesson12/track-QGIS.jpg" width="686" height="670" contain /></p>
<div class="youturn">
<h1 class="toc-ignore unnumbered unlisted">
You turn
</h1>
<ul>
<li><p>Загрузить треки</p></li>
<li><p>Настроить стили для отображения</p>
<ul>
<li><p>Раскраска</p></li>
<li><p>Подписи</p></li>
</ul></li>
</ul>
</div>
</div>
</div>
</div>
<div id="находки" class="section level1">
<h1>Находки</h1>
<h2 class="toc-ignore unnumbered unlisted">
GPS-метка
</h2>
<p>Содержит информацию о названии метки, её времени и координатах. Как правило, это трехзначное число: 002, 012, 312.</p>
<h2 class="toc-ignore unnumbered unlisted">
Номер фотографии
</h2>
<p>В учётный лист или полевой дневник заносятся четыре последних цифры. Каждые 10 тыс. снимков эти цифры могут повториться. В <a href="#findings">таблице находок</a> указывается дата, чтобы исключить неоднозначность по 4 последним цифрам.</p>
<p>По дате и четырём последним цифрам находится имя файла снимка. Из этого имени извлекается информаиц</p>
<h2 class="toc-ignore unnumbered unlisted">
Записанное время
</h2>
<p>Иногда может быть приблизительное, особенно если находка сделана участниками экспедиции или членами экипажа.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">Sys.setenv</span>(<span class="at">TZ=</span><span class="st">&quot;UTC&quot;</span>)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;./input/marmam.xlsx&quot;</span>,<span class="at">sheet=</span><span class="st">&quot;mammals&quot;</span>)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">is.na</span>(a[[<span class="st">&quot;Повтор&quot;</span>]])</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>a <span class="ot">&lt;-</span> a[ind,]</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>d3 <span class="ot">&lt;-</span> a[[<span class="st">&quot;Дата&quot;</span>]] <span class="sc">|&gt;</span> <span class="fu">as.Date</span>()</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>a[[<span class="st">&quot;Дата&quot;</span>]] <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">fill</span>(<span class="fu">data.frame</span>(<span class="at">d3=</span>d3),<span class="st">&quot;d3&quot;</span>,<span class="at">.direction=</span><span class="st">&quot;down&quot;</span>)[[<span class="dv">1</span>]]</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>a<span class="sc">$</span>time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>a<span class="sc">$</span>time[] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>a<span class="sc">$</span>lon <span class="ot">&lt;-</span> <span class="cn">NA_real_</span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>a<span class="sc">$</span>lat <span class="ot">&lt;-</span> <span class="cn">NA_real_</span></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>trkFname <span class="ot">&lt;-</span> <span class="st">&quot;./input/Oregon/Track_2023-07-18 082447.gpx&quot;</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a><span class="fu">print</span>(sf<span class="sc">::</span><span class="fu">st_layers</span>(trkFname))</span></code></pre></div>
<pre><code>Driver: GPX 
Available layers:
    layer_name     geometry_type features fields crs_name
1    waypoints             Point        0     23   WGS 84
2       routes       Line String        0     12   WGS 84
3       tracks Multi Line String        1     13   WGS 84
4 route_points             Point        0     25   WGS 84
5 track_points             Point     1268     26   WGS 84</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>trk <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_read</span>(trkFname,<span class="at">layer=</span><span class="st">&quot;track_points&quot;</span>,<span class="at">quiet=</span><span class="cn">TRUE</span>)[<span class="fu">c</span>(<span class="st">&quot;time&quot;</span>,<span class="st">&quot;ele&quot;</span>)]</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="fu">print</span>(trk)</span></code></pre></div>
<pre><code>Simple feature collection with 1268 features and 2 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 76.62792 ymin: 71.86019 xmax: 82.72364 ymax: 73.51395
Geodetic CRS:  WGS 84
First 10 features:
                  time   ele                  geometry
1  2023-07-17 16:04:28  7.79 POINT (82.72364 71.86383)
2  2023-07-17 16:04:29  7.80 POINT (82.72352 71.86384)
3  2023-07-17 16:05:47  7.80 POINT (82.72199 71.86266)
4  2023-07-17 16:06:03  7.80  POINT (82.72175 71.8625)
5  2023-07-17 16:09:13  7.80 POINT (82.72044 71.86077)
6  2023-07-17 16:09:20  7.80   POINT (82.7201 71.8606)
7  2023-07-17 16:09:24  7.80 POINT (82.71994 71.86048)
8  2023-07-17 16:09:27 10.95 POINT (82.71983 71.86039)
9  2023-07-17 16:09:29 14.02 POINT (82.71975 71.86033)
10 2023-07-17 16:09:31 14.82 POINT (82.71968 71.86028)</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>wptFname <span class="ot">&lt;-</span> <span class="st">&quot;./input/Oregon/Waypoints_18-JUL-23.gpx&quot;</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="fu">print</span>(sf<span class="sc">::</span><span class="fu">st_layers</span>(wptFname))</span></code></pre></div>
<pre><code>Driver: GPX 
Available layers:
    layer_name     geometry_type features fields crs_name
1    waypoints             Point        9     23   WGS 84
2       routes       Line String        0     12   WGS 84
3       tracks Multi Line String        0     12   WGS 84
4 route_points             Point        0     25   WGS 84
5 track_points             Point        0     26   WGS 84</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>wpt <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_read</span>(wptFname,<span class="at">layer=</span><span class="st">&quot;waypoints&quot;</span>,<span class="at">quiet=</span><span class="cn">TRUE</span>)[,<span class="fu">c</span>(<span class="st">&quot;time&quot;</span>,<span class="st">&quot;name&quot;</span>,<span class="st">&quot;ele&quot;</span>,<span class="st">&quot;sym&quot;</span>)]</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>wpt<span class="sc">$</span>name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;О&quot;</span>,wpt<span class="sc">$</span>name)</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a><span class="fu">print</span>(wpt)</span></code></pre></div>
<pre><code>Simple feature collection with 9 features and 4 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 76.00353 ymin: 72.66492 xmax: 78.77027 ymax: 73.54822
Geodetic CRS:  WGS 84
                 time name      ele           sym                  geometry
1 2023-07-18 01:14:32 О228 30.52069 Animal Tracks POINT (78.77027 72.66492)
2 2023-07-18 01:50:02 О229 21.19933 Animal Tracks POINT (78.54281 72.72084)
3 2023-07-18 02:32:56 О230 14.74249 Animal Tracks POINT (78.31423 72.74485)
4 2023-07-18 02:59:26 О231 12.97899 Animal Tracks POINT (78.23512 72.81431)
5 2023-07-18 04:44:35 О232 15.16237 Animal Tracks POINT (78.04303 73.11846)
6 2023-07-18 05:01:37 О233 13.45486 Animal Tracks POINT (77.97593 73.16531)
7 2023-07-18 05:17:40 О234 13.96805 Animal Tracks POINT (77.90786 73.20753)
8 2023-07-18 14:39:45 О235 15.53560 Animal Tracks  POINT (76.00353 73.5481)
9 2023-07-18 15:15:36 О236 16.46867 Animal Tracks POINT (76.33078 73.54822)</code></pre>
<div id="время" class="section level2">
<h2>Время</h2>
<div id="по-gps" class="section level3">
<h3>по GPS</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="st">&#39;wptTime&#39;</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(a,wpt) {</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>   patt <span class="ot">&lt;-</span> <span class="st">&quot;.*([A-ZА-Я]</span><span class="sc">\\</span><span class="st">d{3}).*&quot;</span></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>   pt <span class="ot">&lt;-</span> a[[<span class="st">&quot;Точка трека&quot;</span>]]</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>   ind <span class="ot">&lt;-</span> <span class="fu">grep</span>(patt,pt)</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>   pt[ind] <span class="ot">&lt;-</span> <span class="fu">gsub</span>(patt,<span class="st">&quot;</span><span class="sc">\\</span><span class="st">1&quot;</span>,pt[ind])</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>   ind2 <span class="ot">&lt;-</span> <span class="fu">match</span>(wpt<span class="sc">$</span>name,pt[ind])</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>   ind2pt <span class="ot">&lt;-</span> ind[<span class="fu">na.omit</span>(ind2)]</span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>  <span class="co"># print(ind2pt)</span></span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>   ind2w <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(ind2))</span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a>  <span class="co"># print(wpt[ind2w,])</span></span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a>  <span class="co"># a[ind2pt,c(&quot;lon&quot;,&quot;lat&quot;)] &lt;- ursa::spatial_coordinates(wpt[ind2w,])</span></span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a>   a[[<span class="st">&quot;time&quot;</span>]][ind2pt] <span class="ot">&lt;-</span> wpt[[<span class="st">&quot;time&quot;</span>]][ind2w]</span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a>   <span class="fu">print</span>(a[ind2pt,<span class="fu">c</span>(<span class="st">&quot;Время UTC&quot;</span>,<span class="st">&quot;time&quot;</span>,<span class="st">&quot;Точка трека&quot;</span>,<span class="st">&quot;Вид&quot;</span>)])</span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a>   a</span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a>}</span>
<span id="cb29-16"><a href="#cb29-16" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">wptTime</span>(a,wpt)</span></code></pre></div>
<pre><code># A tibble: 7 × 4
  `Время UTC` time                `Точка трека` Вид            
  &lt;chr&gt;       &lt;dttm&gt;              &lt;chr&gt;         &lt;chr&gt;          
1 01:14       2023-07-18 01:14:32 О228          Тюлень sp      
2 &lt;NA&gt;        2023-07-18 01:50:02 О229          Тюлень sp      
3 02:59       2023-07-18 02:59:26 О231          Тюлень sp      
4 &lt;NA&gt;        2023-07-18 04:44:35 О232          Белуха         
5 05:01       2023-07-18 05:01:37 О233          Белуха         
6 &lt;NA&gt;        2023-07-18 05:17:40 О234          Кольчатая нерпа
7 15:15       2023-07-18 15:15:36 О236 3877     Кольчатая нерпа</code></pre>
</div>
<div id="по-фотографии" class="section level3">
<h3>по фотографии</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="st">&#39;photoTime&#39;</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(a,photoDir) {</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>   list1 <span class="ot">&lt;-</span> <span class="fu">dir</span>(<span class="at">path=</span><span class="fu">file.path</span>(<span class="st">&quot;./input&quot;</span>,photoDir)</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>               ,<span class="at">pattern=</span><span class="st">&quot;</span><span class="sc">\\</span><span class="st">d{4}</span><span class="sc">\\</span><span class="st">.jpg$&quot;</span>,<span class="at">full.names=</span><span class="cn">TRUE</span>)</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>   list2 <span class="ot">&lt;-</span> <span class="fu">basename</span>(list1)</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>   photo <span class="ot">&lt;-</span> a[[<span class="st">&quot;Точка трека&quot;</span>]]</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>   ind <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">D*</span><span class="sc">\\</span><span class="st">d{4}</span><span class="sc">\\</span><span class="st">D*&quot;</span>,photo)</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>   ph <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;[А-Я]</span><span class="sc">\\</span><span class="st">d{3}</span><span class="sc">\\</span><span class="st">D*&quot;</span>,<span class="st">&quot;&quot;</span>,photo[ind])</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>   ph <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">s+&quot;</span>,<span class="st">&quot;&quot;</span>,ph)</span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>   ph <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;^</span><span class="sc">\\</span><span class="st">D|</span><span class="sc">\\</span><span class="st">D$&quot;</span>,<span class="st">&quot;&quot;</span>,ph)</span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a>   ph <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(ph,<span class="at">split=</span><span class="st">&quot;(</span><span class="sc">\\</span><span class="st">s+|,</span><span class="sc">\\</span><span class="st">s*)&quot;</span>)</span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>   ph <span class="ot">&lt;-</span> <span class="fu">lapply</span>(ph,\(x) {</span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a>      y <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(x,<span class="at">split=</span><span class="st">&quot;</span><span class="sc">\\</span><span class="st">s*-</span><span class="sc">\\</span><span class="st">s*&quot;</span>)[[<span class="dv">1</span>]]</span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">length</span>(y)<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a>         <span class="fu">return</span>(y)</span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a>      y <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(y)</span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a>      y <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%04d&quot;</span>,<span class="fu">sort</span>(<span class="fu">seq</span>(y[<span class="dv">1</span>],y[<span class="dv">2</span>])))</span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a>   })</span>
<span id="cb31-18"><a href="#cb31-18" tabindex="-1"></a>   d3 <span class="ot">&lt;-</span> a[[<span class="st">&quot;Дата&quot;</span>]][ind]</span>
<span id="cb31-19"><a href="#cb31-19" tabindex="-1"></a>   found <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>,<span class="fu">length</span>(d3))</span>
<span id="cb31-20"><a href="#cb31-20" tabindex="-1"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(d3) <span class="sc">|&gt;</span> <span class="fu">sample</span>()) {</span>
<span id="cb31-21"><a href="#cb31-21" tabindex="-1"></a>      <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(a[[<span class="st">&quot;time&quot;</span>]][ind][i]))</span>
<span id="cb31-22"><a href="#cb31-22" tabindex="-1"></a>         <span class="cf">next</span></span>
<span id="cb31-23"><a href="#cb31-23" tabindex="-1"></a>      patt <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">format</span>(d3[i],<span class="st">&quot;%Y%m%d&quot;</span>),<span class="st">&quot;-</span><span class="sc">\\</span><span class="st">d{6}-&quot;</span>,ph[[i]],<span class="st">&quot;</span><span class="sc">\\</span><span class="st">.jpg&quot;</span>)</span>
<span id="cb31-24"><a href="#cb31-24" tabindex="-1"></a>      ind2 <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(patt,grep,list2))</span>
<span id="cb31-25"><a href="#cb31-25" tabindex="-1"></a>      <span class="cf">if</span> (<span class="sc">!</span><span class="fu">length</span>(ind2))</span>
<span id="cb31-26"><a href="#cb31-26" tabindex="-1"></a>         <span class="cf">next</span></span>
<span id="cb31-27"><a href="#cb31-27" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">length</span>(ind2)<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb31-28"><a href="#cb31-28" tabindex="-1"></a>         ind2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(ind2,<span class="dv">1</span>)</span>
<span id="cb31-29"><a href="#cb31-29" tabindex="-1"></a>      found[[i]] <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(<span class="fu">gsub</span>(<span class="st">&quot;.*(</span><span class="sc">\\</span><span class="st">d{8}-</span><span class="sc">\\</span><span class="st">d{6}).*&quot;</span>,<span class="st">&quot;</span><span class="sc">\\</span><span class="st">1&quot;</span>,list2[ind2])</span>
<span id="cb31-30"><a href="#cb31-30" tabindex="-1"></a>                              ,<span class="at">format=</span><span class="st">&quot;%Y%m%d-%H%M%S&quot;</span>)</span>
<span id="cb31-31"><a href="#cb31-31" tabindex="-1"></a>      a[[<span class="st">&quot;time&quot;</span>]][ind][i] <span class="ot">&lt;-</span> found[[i]]</span>
<span id="cb31-32"><a href="#cb31-32" tabindex="-1"></a>   }</span>
<span id="cb31-33"><a href="#cb31-33" tabindex="-1"></a>   ind2 <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">sapply</span>(found,\(x) <span class="fu">length</span>(x)<span class="sc">&gt;</span><span class="dv">0</span>))</span>
<span id="cb31-34"><a href="#cb31-34" tabindex="-1"></a>   ind3 <span class="ot">&lt;-</span> ind[ind2] </span>
<span id="cb31-35"><a href="#cb31-35" tabindex="-1"></a>   <span class="fu">print</span>(a[ind3,<span class="fu">c</span>(<span class="st">&quot;Дата&quot;</span>,<span class="st">&quot;Точка трека&quot;</span>,<span class="st">&quot;Вид&quot;</span>,<span class="st">&quot;Субстрат&quot;</span>,<span class="st">&quot;time&quot;</span>)])</span>
<span id="cb31-36"><a href="#cb31-36" tabindex="-1"></a>   a</span>
<span id="cb31-37"><a href="#cb31-37" tabindex="-1"></a>}</span>
<span id="cb31-38"><a href="#cb31-38" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">photoTime</span>(a,<span class="st">&quot;2023-07-18&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 3 × 5
  Дата       `Точка трека` Вид             Субстрат time               
  &lt;date&gt;     &lt;chr&gt;         &lt;chr&gt;           &lt;chr&gt;    &lt;dttm&gt;             
1 2023-07-18 2409-2411     Тюлень sp       льдина   2023-07-18 01:26:39
2 2023-07-18 2432          Лахтак          льдина   2023-07-18 01:31:21
3 2023-07-18 2433          Кольчатая нерпа разводья 2023-07-18 01:40:54</code></pre>
</div>
<div id="напрямую" class="section level3">
<h3>напрямую</h3>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="st">&#39;manualTime&#39;</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(a) {</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>   t3 <span class="ot">&lt;-</span> a[[<span class="st">&quot;Точка трека&quot;</span>]]</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>   ind <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">grepl</span>(<span class="st">&quot;^</span><span class="sc">\\</span><span class="st">d{1,2}</span><span class="sc">\\</span><span class="st">:</span><span class="sc">\\</span><span class="st">d{2}(</span><span class="sc">\\</span><span class="st">:</span><span class="sc">\\</span><span class="st">d{2})*$&quot;</span>,t3))</span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>   <span class="cf">if</span> (<span class="fu">length</span>(ind2 <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;^</span><span class="sc">\\</span><span class="st">d{1,2}</span><span class="sc">\\</span><span class="st">:</span><span class="sc">\\</span><span class="st">d{2}$&quot;</span>,t3[ind])))</span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a>      t3[ind][ind2] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(t3[ind][ind2],<span class="st">&quot;:30&quot;</span>)</span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a>   ind3 <span class="ot">&lt;-</span> <span class="fu">is.na</span>(a<span class="sc">$</span>time[ind])</span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>   a<span class="sc">$</span>time[ind[ind3]] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">format</span>(a[[<span class="st">&quot;Дата&quot;</span>]][ind[ind3]],<span class="st">&quot;%Y-%m-%d&quot;</span>),t3[ind[ind3]])</span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a>   ind4 <span class="ot">&lt;-</span> <span class="fu">which</span>(a<span class="sc">$</span>time[ind]<span class="sc">&gt;=</span><span class="fu">head</span>(trk<span class="sc">$</span>time,<span class="dv">1</span>) <span class="sc">&amp;</span> a<span class="sc">$</span>time[ind]<span class="sc">&lt;=</span><span class="fu">tail</span>(trk<span class="sc">$</span>time,<span class="dv">1</span>))</span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a>   <span class="fu">print</span>(a[ind[ind4],<span class="fu">c</span>(<span class="st">&quot;Дата&quot;</span>,<span class="st">&quot;Точка трека&quot;</span>,<span class="st">&quot;Вид&quot;</span>,<span class="st">&quot;time&quot;</span>,<span class="st">&quot;lon&quot;</span>,<span class="st">&quot;lat&quot;</span>)])</span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a>   a</span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a>}</span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">manualTime</span>(a)</span></code></pre></div>
<pre><code># A tibble: 9 × 6
  Дата       `Точка трека` Вид       time                  lon   lat
  &lt;date&gt;     &lt;chr&gt;         &lt;chr&gt;     &lt;dttm&gt;              &lt;dbl&gt; &lt;dbl&gt;
1 2023-07-18 01:08:29      Тюлень sp 2023-07-18 01:08:29    NA    NA
2 2023-07-18 01:20         Тюлень sp 2023-07-18 01:20:30    NA    NA
3 2023-07-18 01:54         Тюлень sp 2023-07-18 01:54:30    NA    NA
4 2023-07-18 02:18         Тюлень sp 2023-07-18 02:18:30    NA    NA
5 2023-07-18 02:18         Тюлень sp 2023-07-18 02:18:30    NA    NA
6 2023-07-18 02:19         Тюлень sp 2023-07-18 02:19:30    NA    NA
7 2023-07-18 02:19         Тюлень sp 2023-07-18 02:19:30    NA    NA
8 2023-07-18 03:19         Тюлень sp 2023-07-18 03:19:30    NA    NA
9 2023-07-18 04:03         Тюлень sp 2023-07-18 04:03:30    NA    NA</code></pre>
</div>
</div>
<div id="координаты" class="section level2">
<h2>Координаты</h2>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> a[<span class="sc">!</span><span class="fu">is.na</span>(a<span class="sc">$</span>time),]</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> a[a<span class="sc">$</span>time<span class="sc">&gt;=</span><span class="fu">head</span>(trk<span class="sc">$</span>time,<span class="dv">1</span>) <span class="sc">&amp;</span> a<span class="sc">$</span>time<span class="sc">&lt;=</span><span class="fu">tail</span>(trk<span class="sc">$</span>time,<span class="dv">1</span>),]</span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a><span class="fu">print</span>(a[,<span class="fu">c</span>(<span class="st">&quot;Точка трека&quot;</span>,<span class="st">&quot;Вид&quot;</span>,<span class="st">&quot;time&quot;</span>,<span class="st">&quot;lon&quot;</span>,<span class="st">&quot;lat&quot;</span>)])</span></code></pre></div>
<pre><code># A tibble: 18 × 5
   `Точка трека` Вид             time                  lon   lat
   &lt;chr&gt;         &lt;chr&gt;           &lt;dttm&gt;              &lt;dbl&gt; &lt;dbl&gt;
 1 01:08:29      Тюлень sp       2023-07-18 01:08:29    NA    NA
 2 О228          Тюлень sp       2023-07-18 01:14:32    NA    NA
 3 01:20         Тюлень sp       2023-07-18 01:20:30    NA    NA
 4 2409-2411     Тюлень sp       2023-07-18 01:26:39    NA    NA
 5 2432          Лахтак          2023-07-18 01:31:21    NA    NA
 6 2433          Кольчатая нерпа 2023-07-18 01:40:54    NA    NA
 7 О229          Тюлень sp       2023-07-18 01:50:02    NA    NA
 8 01:54         Тюлень sp       2023-07-18 01:54:30    NA    NA
 9 02:18         Тюлень sp       2023-07-18 02:18:30    NA    NA
10 02:18         Тюлень sp       2023-07-18 02:18:30    NA    NA
11 02:19         Тюлень sp       2023-07-18 02:19:30    NA    NA
12 02:19         Тюлень sp       2023-07-18 02:19:30    NA    NA
13 О231          Тюлень sp       2023-07-18 02:59:26    NA    NA
14 03:19         Тюлень sp       2023-07-18 03:19:30    NA    NA
15 04:03         Тюлень sp       2023-07-18 04:03:30    NA    NA
16 О232          Белуха          2023-07-18 04:44:35    NA    NA
17 О233          Белуха          2023-07-18 05:01:37    NA    NA
18 О234          Кольчатая нерпа 2023-07-18 05:17:40    NA    NA</code></pre>
<div id="из-gps-метки" class="section level3">
<h3>из GPS метки</h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="st">&#39;getCoordsFromPoint&#39;</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(a,gpx) {</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>   ind <span class="ot">&lt;-</span> <span class="fu">match</span>(a<span class="sc">$</span>time,gpx<span class="sc">$</span>time)</span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>   <span class="cf">if</span> (<span class="fu">all</span>(<span class="fu">is.na</span>(ind)))</span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>      <span class="fu">return</span>(a)</span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>   ind1 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(ind)</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a>   ind2 <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(ind))</span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a>   ind2 <span class="ot">&lt;-</span> ind2[<span class="fu">is.na</span>(a<span class="sc">$</span>lon[ind2]) <span class="sc">|</span> <span class="fu">is.na</span>(a<span class="sc">$</span>lat[ind2])]</span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a>   xy <span class="ot">&lt;-</span> ursa<span class="sc">::</span><span class="fu">spatial_coordinates</span>(gpx)[ind1,]</span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a>   a<span class="sc">$</span>lon[ind2] <span class="ot">&lt;-</span> xy[,<span class="dv">1</span>]</span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a>   a<span class="sc">$</span>lat[ind2] <span class="ot">&lt;-</span> xy[,<span class="dv">2</span>]</span>
<span id="cb37-11"><a href="#cb37-11" tabindex="-1"></a>   a</span>
<span id="cb37-12"><a href="#cb37-12" tabindex="-1"></a>}</span>
<span id="cb37-13"><a href="#cb37-13" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">getCoordsFromPoint</span>(a,wpt)</span>
<span id="cb37-14"><a href="#cb37-14" tabindex="-1"></a><span class="fu">print</span>(a[,<span class="fu">c</span>(<span class="st">&quot;Точка трека&quot;</span>,<span class="st">&quot;Вид&quot;</span>,<span class="st">&quot;time&quot;</span>,<span class="st">&quot;lon&quot;</span>,<span class="st">&quot;lat&quot;</span>)])</span></code></pre></div>
<pre><code># A tibble: 18 × 5
   `Точка трека` Вид             time                  lon   lat
   &lt;chr&gt;         &lt;chr&gt;           &lt;dttm&gt;              &lt;dbl&gt; &lt;dbl&gt;
 1 01:08:29      Тюлень sp       2023-07-18 01:08:29  NA    NA  
 2 О228          Тюлень sp       2023-07-18 01:14:32  78.8  72.7
 3 01:20         Тюлень sp       2023-07-18 01:20:30  NA    NA  
 4 2409-2411     Тюлень sp       2023-07-18 01:26:39  NA    NA  
 5 2432          Лахтак          2023-07-18 01:31:21  NA    NA  
 6 2433          Кольчатая нерпа 2023-07-18 01:40:54  NA    NA  
 7 О229          Тюлень sp       2023-07-18 01:50:02  78.5  72.7
 8 01:54         Тюлень sp       2023-07-18 01:54:30  NA    NA  
 9 02:18         Тюлень sp       2023-07-18 02:18:30  NA    NA  
10 02:18         Тюлень sp       2023-07-18 02:18:30  NA    NA  
11 02:19         Тюлень sp       2023-07-18 02:19:30  NA    NA  
12 02:19         Тюлень sp       2023-07-18 02:19:30  NA    NA  
13 О231          Тюлень sp       2023-07-18 02:59:26  78.2  72.8
14 03:19         Тюлень sp       2023-07-18 03:19:30  NA    NA  
15 04:03         Тюлень sp       2023-07-18 04:03:30  NA    NA  
16 О232          Белуха          2023-07-18 04:44:35  78.0  73.1
17 О233          Белуха          2023-07-18 05:01:37  78.0  73.2
18 О234          Кольчатая нерпа 2023-07-18 05:17:40  77.9  73.2</code></pre>
</div>
<div id="из-путевого-трека" class="section level3">
<h3>из путевого трека</h3>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="st">&#39;getCoordsBetweenPoints&#39;</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(a,gpx) {</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>   <span class="cf">if</span> (<span class="sc">!</span><span class="fu">length</span>(ind <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">is.na</span>(a<span class="sc">$</span>lon) <span class="sc">|</span> <span class="fu">is.na</span>(a<span class="sc">$</span>lat))))</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>      <span class="fu">return</span>(a)</span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>   <span class="cf">for</span> (i <span class="cf">in</span> ind <span class="sc">|&gt;</span> <span class="fu">sample</span>()) {</span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>      ind4 <span class="ot">&lt;-</span> <span class="fu">which</span>(trk<span class="sc">$</span>time<span class="sc">-</span>a<span class="sc">$</span>time[i]<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">1</span>)</span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a>      trk2 <span class="ot">&lt;-</span> trk[ind4<span class="sc">+</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>),]</span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>      trk2 <span class="ot">&lt;-</span> ursa<span class="sc">:::</span><span class="fu">spatialize</span>(trk2,<span class="at">style=</span><span class="st">&quot;stere&quot;</span>)</span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>      sc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(a<span class="sc">$</span>time[i]<span class="sc">-</span>trk2<span class="sc">$</span>time[<span class="dv">1</span>],<span class="at">units=</span><span class="st">&quot;secs&quot;</span>)<span class="sc">/</span></span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a>            <span class="fu">as.numeric</span>(trk2<span class="sc">$</span>time[<span class="dv">2</span>]<span class="sc">-</span>trk2<span class="sc">$</span>time[<span class="dv">1</span>],<span class="at">units=</span><span class="st">&quot;secs&quot;</span>)</span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a>      xy2 <span class="ot">&lt;-</span> ursa<span class="sc">::</span><span class="fu">spatial_coordinates</span>(trk2)</span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a>      xy <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">lon=</span>xy2[<span class="dv">1</span>,<span class="dv">1</span>]<span class="sc">+</span>sc<span class="sc">*</span>(xy2[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">-</span>xy2[<span class="dv">1</span>,<span class="dv">1</span>])</span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a>                 ,<span class="at">lat=</span>xy2[<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">+</span>sc<span class="sc">*</span>(xy2[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">-</span>xy2[<span class="dv">1</span>,<span class="dv">2</span>]))</span>
<span id="cb39-13"><a href="#cb39-13" tabindex="-1"></a>      xy <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(xy,<span class="at">coords=</span><span class="fu">c</span>(<span class="st">&quot;lon&quot;</span>,<span class="st">&quot;lat&quot;</span>),<span class="at">crs=</span>sf<span class="sc">::</span><span class="fu">st_crs</span>(trk2))</span>
<span id="cb39-14"><a href="#cb39-14" tabindex="-1"></a>      xy <span class="ot">&lt;-</span> ursa<span class="sc">::</span><span class="fu">spatial_coordinates</span>(sf<span class="sc">::</span><span class="fu">st_transform</span>(xy,<span class="dv">4326</span>))</span>
<span id="cb39-15"><a href="#cb39-15" tabindex="-1"></a>      a<span class="sc">$</span>lon[i] <span class="ot">&lt;-</span> xy[,<span class="dv">1</span>]</span>
<span id="cb39-16"><a href="#cb39-16" tabindex="-1"></a>      a<span class="sc">$</span>lat[i] <span class="ot">&lt;-</span> xy[,<span class="dv">2</span>]</span>
<span id="cb39-17"><a href="#cb39-17" tabindex="-1"></a>   }</span>
<span id="cb39-18"><a href="#cb39-18" tabindex="-1"></a>   a</span>
<span id="cb39-19"><a href="#cb39-19" tabindex="-1"></a>}</span>
<span id="cb39-20"><a href="#cb39-20" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">getCoordsBetweenPoints</span>(a,trk)</span>
<span id="cb39-21"><a href="#cb39-21" tabindex="-1"></a><span class="fu">print</span>(a[,<span class="fu">c</span>(<span class="st">&quot;Точка трека&quot;</span>,<span class="st">&quot;Вид&quot;</span>,<span class="st">&quot;time&quot;</span>,<span class="st">&quot;lon&quot;</span>,<span class="st">&quot;lat&quot;</span>)])</span></code></pre></div>
<pre><code># A tibble: 18 × 5
   `Точка трека` Вид             time                  lon   lat
   &lt;chr&gt;         &lt;chr&gt;           &lt;dttm&gt;              &lt;dbl&gt; &lt;dbl&gt;
 1 01:08:29      Тюлень sp       2023-07-18 01:08:29  78.8  72.7
 2 О228          Тюлень sp       2023-07-18 01:14:32  78.8  72.7
 3 01:20         Тюлень sp       2023-07-18 01:20:30  78.7  72.7
 4 2409-2411     Тюлень sp       2023-07-18 01:26:39  78.7  72.7
 5 2432          Лахтак          2023-07-18 01:31:21  78.7  72.7
 6 2433          Кольчатая нерпа 2023-07-18 01:40:54  78.6  72.7
 7 О229          Тюлень sp       2023-07-18 01:50:02  78.5  72.7
 8 01:54         Тюлень sp       2023-07-18 01:54:30  78.5  72.7
 9 02:18         Тюлень sp       2023-07-18 02:18:30  78.4  72.7
10 02:18         Тюлень sp       2023-07-18 02:18:30  78.4  72.7
11 02:19         Тюлень sp       2023-07-18 02:19:30  78.4  72.7
12 02:19         Тюлень sp       2023-07-18 02:19:30  78.4  72.7
13 О231          Тюлень sp       2023-07-18 02:59:26  78.2  72.8
14 03:19         Тюлень sp       2023-07-18 03:19:30  78.2  72.9
15 04:03         Тюлень sp       2023-07-18 04:03:30  78.2  73.0
16 О232          Белуха          2023-07-18 04:44:35  78.0  73.1
17 О233          Белуха          2023-07-18 05:01:37  78.0  73.2
18 О234          Кольчатая нерпа 2023-07-18 05:17:40  77.9  73.2</code></pre>
</div>
</div>
<div id="пеленгация" class="section level2">
<h2>Пеленгация</h2>
<div class="clarify">
<p>Столбцы «дальность» и «пеленг» в таблице находок.</p>
<ul>
<li><p>Если судно в походе, то фиксируется направление в часах от носа судна</p></li>
<li><p>Если судно на рейде или совершает манёвры, то фиксируется сторона света (в градусах компаса)</p></li>
</ul>
</div>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="st">&#39;getbearing&#39;</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(device,time,distance,bearing) {</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>   bearing1 <span class="ot">&lt;-</span> bearing</span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>   bearing2 <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>   <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(bearing)) {</span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>      pattHHMM <span class="ot">&lt;-</span> <span class="st">&quot;(</span><span class="sc">\\</span><span class="st">d{1,2})</span><span class="sc">\\</span><span class="st">:(</span><span class="sc">\\</span><span class="st">d{2})&quot;</span></span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">grepl</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">d+(T|Т)$&quot;</span>,bearing)) {</span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a>         bearing2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">D&quot;</span>,<span class="st">&quot;&quot;</span>,bearing))</span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a>      }</span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a>      <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">grepl</span>(pattHHMM,bearing)) {</span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a>         hh <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(pattHHMM,<span class="st">&quot;</span><span class="sc">\\</span><span class="st">1&quot;</span>,bearing))</span>
<span id="cb41-11"><a href="#cb41-11" tabindex="-1"></a>         mm <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(pattHHMM,<span class="st">&quot;</span><span class="sc">\\</span><span class="st">2&quot;</span>,bearing))</span>
<span id="cb41-12"><a href="#cb41-12" tabindex="-1"></a>         bearing <span class="ot">&lt;-</span> <span class="dv">30</span><span class="sc">*</span>(hh<span class="sc">+</span>mm<span class="sc">/</span><span class="dv">60</span>)</span>
<span id="cb41-13"><a href="#cb41-13" tabindex="-1"></a>      }</span>
<span id="cb41-14"><a href="#cb41-14" tabindex="-1"></a>      <span class="cf">else</span> {</span>
<span id="cb41-15"><a href="#cb41-15" tabindex="-1"></a>         bearing <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">s*ч$&quot;</span>,<span class="st">&quot;&quot;</span>,bearing))</span>
<span id="cb41-16"><a href="#cb41-16" tabindex="-1"></a>         <span class="cf">if</span> ((bearing<span class="sc">&gt;=</span><span class="dv">0</span>)<span class="sc">&amp;&amp;</span>(bearing<span class="sc">&lt;=</span><span class="dv">24</span>))</span>
<span id="cb41-17"><a href="#cb41-17" tabindex="-1"></a>            bearing <span class="ot">&lt;-</span> bearing<span class="sc">*</span><span class="dv">30</span></span>
<span id="cb41-18"><a href="#cb41-18" tabindex="-1"></a>      }</span>
<span id="cb41-19"><a href="#cb41-19" tabindex="-1"></a>   }</span>
<span id="cb41-20"><a href="#cb41-20" tabindex="-1"></a>   <span class="cf">else</span></span>
<span id="cb41-21"><a href="#cb41-21" tabindex="-1"></a>      bearing <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb41-22"><a href="#cb41-22" tabindex="-1"></a>   <span class="cf">if</span> (<span class="fu">is.na</span>(distance))</span>
<span id="cb41-23"><a href="#cb41-23" tabindex="-1"></a>      distance <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb41-24"><a href="#cb41-24" tabindex="-1"></a>   g <span class="ot">&lt;-</span> device</span>
<span id="cb41-25"><a href="#cb41-25" tabindex="-1"></a>   ind <span class="ot">&lt;-</span> <span class="fu">match</span>(time,g<span class="sc">$</span>time)</span>
<span id="cb41-26"><a href="#cb41-26" tabindex="-1"></a>   <span class="cf">if</span> (<span class="fu">is.na</span>(ind)) {</span>
<span id="cb41-27"><a href="#cb41-27" tabindex="-1"></a>      ind <span class="ot">&lt;-</span> <span class="fu">which</span>(g<span class="sc">$</span>time<span class="sc">&gt;</span>time)[<span class="dv">1</span>]</span>
<span id="cb41-28"><a href="#cb41-28" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">is.na</span>(ind))</span>
<span id="cb41-29"><a href="#cb41-29" tabindex="-1"></a>         <span class="fu">stop</span>(<span class="st">&quot;out of temporal range?&quot;</span>)</span>
<span id="cb41-30"><a href="#cb41-30" tabindex="-1"></a>   }</span>
<span id="cb41-31"><a href="#cb41-31" tabindex="-1"></a>   g3 <span class="ot">&lt;-</span> ursa<span class="sc">:::</span><span class="fu">spatialize</span>(g[ind<span class="sc">+</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>),<span class="st">&quot;time&quot;</span>],<span class="at">resetGrid=</span><span class="cn">TRUE</span>,<span class="at">style=</span><span class="st">&quot;stere&quot;</span>)</span>
<span id="cb41-32"><a href="#cb41-32" tabindex="-1"></a>   xy <span class="ot">&lt;-</span> ursa<span class="sc">::</span><span class="fu">spatial_coordinates</span>(g3)</span>
<span id="cb41-33"><a href="#cb41-33" tabindex="-1"></a>   pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(xy,<span class="at">scale=</span><span class="cn">FALSE</span>)</span>
<span id="cb41-34"><a href="#cb41-34" tabindex="-1"></a>   direction <span class="ot">&lt;-</span> <span class="fu">unname</span>(pca<span class="sc">$</span>rotation[,<span class="dv">1</span>])</span>
<span id="cb41-35"><a href="#cb41-35" tabindex="-1"></a>   <span class="cf">if</span> (direction[<span class="dv">1</span>]<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb41-36"><a href="#cb41-36" tabindex="-1"></a>      theta <span class="ot">&lt;-</span> pi<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sign</span>(direction[<span class="dv">2</span>])</span>
<span id="cb41-37"><a href="#cb41-37" tabindex="-1"></a>   <span class="cf">else</span></span>
<span id="cb41-38"><a href="#cb41-38" tabindex="-1"></a>      theta <span class="ot">&lt;-</span> <span class="fu">atan</span>(direction[<span class="dv">2</span>]<span class="sc">/</span>direction[<span class="dv">1</span>])</span>
<span id="cb41-39"><a href="#cb41-39" tabindex="-1"></a>  <span class="co"># print(theta*180/pi)</span></span>
<span id="cb41-40"><a href="#cb41-40" tabindex="-1"></a>   <span class="cf">if</span> (direction[<span class="dv">1</span>]<span class="sc">&lt;</span><span class="dv">0</span>) {</span>
<span id="cb41-41"><a href="#cb41-41" tabindex="-1"></a>      theta <span class="ot">&lt;-</span> pi<span class="sc">+</span>theta</span>
<span id="cb41-42"><a href="#cb41-42" tabindex="-1"></a>   }</span>
<span id="cb41-43"><a href="#cb41-43" tabindex="-1"></a>   theta <span class="ot">&lt;-</span> pi<span class="sc">/</span><span class="dv">2</span><span class="sc">-</span>theta</span>
<span id="cb41-44"><a href="#cb41-44" tabindex="-1"></a>   x <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(g3<span class="sc">$</span>time)</span>
<span id="cb41-45"><a href="#cb41-45" tabindex="-1"></a>   y <span class="ot">&lt;-</span> <span class="fu">unname</span>(<span class="fu">predict</span>(pca)[,<span class="dv">1</span>])</span>
<span id="cb41-46"><a href="#cb41-46" tabindex="-1"></a>   n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb41-47"><a href="#cb41-47" tabindex="-1"></a>   slope <span class="ot">&lt;-</span> <span class="fl">3.6</span><span class="sc">*</span>(<span class="fu">mean</span>(x<span class="sc">*</span>y)<span class="sc">-</span><span class="fu">mean</span>(x)<span class="sc">*</span><span class="fu">mean</span>(y))<span class="sc">/</span><span class="fu">var</span>(x)<span class="sc">*</span>n<span class="sc">/</span>(n<span class="dv">-1</span>)</span>
<span id="cb41-48"><a href="#cb41-48" tabindex="-1"></a>   <span class="cf">if</span> (slope<span class="sc">&lt;</span><span class="dv">0</span>) {</span>
<span id="cb41-49"><a href="#cb41-49" tabindex="-1"></a>      theta <span class="ot">&lt;-</span> theta<span class="sc">-</span>pi</span>
<span id="cb41-50"><a href="#cb41-50" tabindex="-1"></a>      slope <span class="ot">&lt;-</span> <span class="sc">-</span>slope</span>
<span id="cb41-51"><a href="#cb41-51" tabindex="-1"></a>   }</span>
<span id="cb41-52"><a href="#cb41-52" tabindex="-1"></a>   g2 <span class="ot">&lt;-</span> g[ind<span class="sc">+</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>),]</span>
<span id="cb41-53"><a href="#cb41-53" tabindex="-1"></a>   tr <span class="ot">&lt;-</span> ursa<span class="sc">::</span><span class="fu">trackline</span>(g2)</span>
<span id="cb41-54"><a href="#cb41-54" tabindex="-1"></a>   trlen <span class="ot">&lt;-</span> ursa<span class="sc">::</span><span class="fu">spatial_length</span>(tr)</span>
<span id="cb41-55"><a href="#cb41-55" tabindex="-1"></a>   trdur <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(g2<span class="sc">$</span>time[<span class="dv">2</span>],g2<span class="sc">$</span>time[<span class="dv">1</span>]),<span class="st">&quot;secs&quot;</span>)</span>
<span id="cb41-56"><a href="#cb41-56" tabindex="-1"></a>   trspd <span class="ot">&lt;-</span> trlen<span class="sc">/</span>trdur<span class="sc">*</span><span class="fl">3.6</span></span>
<span id="cb41-57"><a href="#cb41-57" tabindex="-1"></a>   tr <span class="ot">&lt;-</span> ursa<span class="sc">::</span><span class="fu">spatial_coordinates</span>(sf<span class="sc">::</span><span class="fu">st_segmentize</span>(tr,trlen<span class="sc">/</span><span class="dv">1000</span>))[[<span class="dv">1</span>]]</span>
<span id="cb41-58"><a href="#cb41-58" tabindex="-1"></a>   t3 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(g2<span class="sc">$</span>time)</span>
<span id="cb41-59"><a href="#cb41-59" tabindex="-1"></a>   scale <span class="ot">&lt;-</span> (<span class="fu">as.numeric</span>(time)<span class="sc">-</span>t3[<span class="dv">1</span>])<span class="sc">/</span>(t3[<span class="dv">2</span>]<span class="sc">-</span>t3[<span class="dv">1</span>])</span>
<span id="cb41-60"><a href="#cb41-60" tabindex="-1"></a>   ind <span class="ot">&lt;-</span> <span class="fu">round</span>((<span class="fu">nrow</span>(tr)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span>scale<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb41-61"><a href="#cb41-61" tabindex="-1"></a>   crd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(tr[ind,]))</span>
<span id="cb41-62"><a href="#cb41-62" tabindex="-1"></a>   heading <span class="ot">&lt;-</span> lwgeom<span class="sc">::</span><span class="fu">st_geod_azimuth</span>(g2)</span>
<span id="cb41-63"><a href="#cb41-63" tabindex="-1"></a>   <span class="fu">units</span>(heading) <span class="ot">&lt;-</span> <span class="st">&quot;degrees&quot;</span></span>
<span id="cb41-64"><a href="#cb41-64" tabindex="-1"></a>   <span class="cf">if</span> (<span class="fu">is.na</span>(bearing2))</span>
<span id="cb41-65"><a href="#cb41-65" tabindex="-1"></a>      bearing2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(heading)<span class="sc">+</span>bearing</span>
<span id="cb41-66"><a href="#cb41-66" tabindex="-1"></a>   ep <span class="ot">&lt;-</span> geosphere<span class="sc">::</span><span class="fu">destPoint</span>(crd,<span class="at">b=</span>bearing2,<span class="at">d=</span>distance)</span>
<span id="cb41-67"><a href="#cb41-67" tabindex="-1"></a>   strip <span class="ot">&lt;-</span> <span class="fu">sin</span>(<span class="fu">as.numeric</span>(bearing)<span class="sc">*</span>pi<span class="sc">/</span><span class="dv">180</span>)<span class="sc">*</span><span class="fu">as.numeric</span>(distance)</span>
<span id="cb41-68"><a href="#cb41-68" tabindex="-1"></a>   strip[<span class="fu">abs</span>(strip)<span class="sc">&gt;</span><span class="dv">5000</span>] <span class="ot">&lt;-</span> <span class="fu">round</span>(strip[<span class="fu">abs</span>(strip)<span class="sc">&gt;</span><span class="dv">5000</span>],<span class="sc">-</span><span class="dv">3</span>)</span>
<span id="cb41-69"><a href="#cb41-69" tabindex="-1"></a>   strip[<span class="fu">abs</span>(strip)<span class="sc">&gt;</span><span class="dv">2000</span>] <span class="ot">&lt;-</span> <span class="fu">round</span>(strip[<span class="fu">abs</span>(strip)<span class="sc">&gt;</span><span class="dv">2000</span>],<span class="sc">-</span><span class="dv">2</span>)</span>
<span id="cb41-70"><a href="#cb41-70" tabindex="-1"></a>   strip[<span class="fu">abs</span>(strip)<span class="sc">&gt;=</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">round</span>(strip[<span class="fu">abs</span>(strip)<span class="sc">&gt;=</span><span class="dv">0</span>],<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb41-71"><a href="#cb41-71" tabindex="-1"></a>   ret <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">time=</span>time,<span class="at">observer_lon=</span>crd[,<span class="dv">1</span>],<span class="at">observer_lat=</span>crd[,<span class="dv">2</span>]</span>
<span id="cb41-72"><a href="#cb41-72" tabindex="-1"></a>                    ,<span class="at">target_lon=</span>ep[,<span class="dv">1</span>],<span class="at">target_lat=</span>ep[,<span class="dv">2</span>]</span>
<span id="cb41-73"><a href="#cb41-73" tabindex="-1"></a>                    ,<span class="at">in_strip=</span>strip</span>
<span id="cb41-74"><a href="#cb41-74" tabindex="-1"></a>                    ,<span class="at">speed=</span>slope,<span class="at">heading=</span>theta<span class="sc">*</span><span class="dv">180</span><span class="sc">/</span>pi</span>
<span id="cb41-75"><a href="#cb41-75" tabindex="-1"></a>                    ,<span class="at">check.names=</span><span class="cn">FALSE</span></span>
<span id="cb41-76"><a href="#cb41-76" tabindex="-1"></a>                    )</span>
<span id="cb41-77"><a href="#cb41-77" tabindex="-1"></a>   <span class="fu">rownames</span>(ret) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb41-78"><a href="#cb41-78" tabindex="-1"></a>   ret<span class="sc">$</span>time <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb41-79"><a href="#cb41-79" tabindex="-1"></a>   ret</span>
<span id="cb41-80"><a href="#cb41-80" tabindex="-1"></a>}</span>
<span id="cb41-81"><a href="#cb41-81" tabindex="-1"></a><span class="st">&#39;observationState&#39;</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(a,trk) {</span>
<span id="cb41-82"><a href="#cb41-82" tabindex="-1"></a>   colBearing <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;(пеленг|азимут)&quot;</span>,<span class="fu">colnames</span>(a),<span class="at">ignore.case=</span><span class="cn">TRUE</span>,<span class="at">value=</span><span class="cn">TRUE</span>)</span>
<span id="cb41-83"><a href="#cb41-83" tabindex="-1"></a>   colDistance <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;дистанц|(расст.*набл)&quot;</span>,<span class="fu">colnames</span>(a),<span class="at">ignore.case=</span><span class="cn">TRUE</span>,<span class="at">value=</span><span class="cn">TRUE</span>)</span>
<span id="cb41-84"><a href="#cb41-84" tabindex="-1"></a>   <span class="fu">lapply</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(a)),\(i) {</span>
<span id="cb41-85"><a href="#cb41-85" tabindex="-1"></a>      <span class="fu">getbearing</span>(<span class="at">device=</span>trk,<span class="at">time=</span>a<span class="sc">$</span>time[i]</span>
<span id="cb41-86"><a href="#cb41-86" tabindex="-1"></a>                ,<span class="at">distance=</span>a[[colDistance]][i],<span class="at">bearing=</span>a[[colBearing]][i])</span>
<span id="cb41-87"><a href="#cb41-87" tabindex="-1"></a>   }) <span class="sc">|&gt;</span> <span class="fu">do.call</span>(rbind,<span class="at">args=</span>_)</span>
<span id="cb41-88"><a href="#cb41-88" tabindex="-1"></a>}</span>
<span id="cb41-89"><a href="#cb41-89" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">observationState</span>(a,trk)</span>
<span id="cb41-90"><a href="#cb41-90" tabindex="-1"></a><span class="co"># b &lt;- cbind(a[,c(&quot;Вид&quot;,&quot;time&quot;)],b)</span></span>
<span id="cb41-91"><a href="#cb41-91" tabindex="-1"></a><span class="fu">print</span>(b,<span class="at">digits=</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>   observer_lon observer_lat target_lon target_lat in_strip  speed heading
1         78.80        72.65      78.82      72.66     1000 17.222 -61.081
2         78.77        72.66      78.77      72.66      -40 16.261 -27.594
3         78.73        72.68      78.73      72.68        0 17.628 -53.865
4         78.69        72.68      78.66      72.69     -500 18.152 -48.644
5         78.66        72.69      78.65      72.69     -400 18.198 -45.523
6         78.59        72.71      78.58      72.71     -600 17.478 -54.910
7         78.54        72.72      78.54      72.72        0  6.144 -39.802
8         78.54        72.72      78.53      72.73     -250  3.118 -12.339
9         78.43        72.72      78.44      72.73      500 16.933 -56.538
10        78.43        72.72      78.44      72.73     1000 16.933 -56.538
11        78.42        72.72      78.43      72.73      700 17.833 -56.366
12        78.42        72.72      78.44      72.73      900 17.833 -56.366
13        78.24        72.81      78.23      72.81      -40 19.976 -11.744
14        78.19        72.87      78.23      72.88     1500 19.603 -19.823
15        78.17        73.00      78.15      73.00     -400 20.581   1.429
16        78.04        73.12      78.03      73.12     -200 19.846 -16.762
17        77.98        73.17      77.97      73.17        0 19.670 -17.711
18        77.91        73.21      77.91      73.21       90 19.920 -54.157</code></pre>
</div>
<div id="hiddentoc-crd" class="section level2 blackout">
<h2 class="blackout">План «Б»</h2>
<p>Для каждой находки (с фото или без) ставить метку GPS</p>
<ul>
<li><p>С ГИС</p>
<ul>
<li><p>Отобразить трек (track, track_points)</p></li>
<li><p>Вывести метки находок (waypoints)</p></li>
<li><p>Воспользоваться инструментом получения координат при клике на waypoints.</p></li>
</ul></li>
<li><p>Без ГИС</p>
<ul>
<li>Открыть <a href="#gpx">GPX</a> в текстовом редакторе и соотносить название метки с её координатами.</li>
</ul></li>
</ul>
<p>Но без ГИС не получится создать файл, который мог бы быть открыт кем-то другим в ГИС.</p>
</div>
<div id="экспорт-для-гис" class="section level2">
<h2>Экспорт для ГИС</h2>
<p>Создание точечного слоя</p>
<div id="r" class="section level3 unlisted unnumbered">
<h3 class="unlisted unnumbered">R</h3>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(a,<span class="at">coords=</span><span class="fu">c</span>(<span class="st">&quot;lon&quot;</span>,<span class="st">&quot;lat&quot;</span>),<span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a><span class="fu">print</span>(a[,<span class="fu">c</span>(<span class="st">&quot;Вид&quot;</span>,<span class="st">&quot;Кол-во&quot;</span>,<span class="st">&quot;Субстрат&quot;</span>)])</span></code></pre></div>
<pre><code>Simple feature collection with 18 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 77.90786 ymin: 72.65398 xmax: 78.80145 ymax: 73.20753
Geodetic CRS:  WGS 84
# A tibble: 18 × 4
   Вид             `Кол-во` Субстрат            geometry
   &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;            &lt;POINT [°]&gt;
 1 Тюлень sp              1 разводья (78.80145 72.65398)
 2 Тюлень sp              1 разводья (78.77027 72.66492)
 3 Тюлень sp              1 разводья (78.73301 72.67523)
 4 Тюлень sp              4 льдина   (78.68872 72.68498)
 5 Лахтак                 4 льдина   (78.65728 72.69365)
 6 Кольчатая нерпа        1 разводья (78.58754 72.70971)
 7 Тюлень sp              1 разводья (78.54281 72.72084)
 8 Тюлень sp              1 разводья (78.53791 72.72264)
 9 Тюлень sp              5 льдина   (78.42713 72.72192)
10 Тюлень sp             19 льдина   (78.42713 72.72192)
11 Тюлень sp              1 разводья (78.42004 72.72338)
12 Тюлень sp              1 разводья (78.42004 72.72338)
13 Тюлень sp              1 вода     (78.23512 72.81431)
14 Тюлень sp             59 льдина     (78.19121 72.872)
15 Тюлень sp              1 разводья (78.16659 73.00207)
16 Белуха                 1 вода     (78.04303 73.11846)
17 Белуха                 1 вода     (77.97593 73.16531)
18 Кольчатая нерпа        1 разводья (77.90786 73.20753)</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>dst <span class="ot">&lt;-</span> <span class="st">&quot;./output/mammals_subset.geojson&quot;</span></span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a>ursa<span class="sc">::</span><span class="fu">spatial_write</span>(a,dst)</span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">file.info</span>(dst)[,<span class="st">&quot;size&quot;</span>,<span class="at">drop=</span><span class="cn">FALSE</span>])</span></code></pre></div>
<pre><code>                                 size
./output/mammals_subset.geojson 13849</code></pre>
</div>
<div id="qgis" class="section level3 unlisted unnumbered">
<h3 class="unlisted unnumbered">QGIS</h3>
<ul>
<li><p>Сохранить лист Экселя в формате CSV.</p></li>
<li><p><a href="#menulayer">Layer » Add Layer » Add Vector Layer</a></p></li>
</ul>
<p>Указать названия столбцов, содержащих координаты.</p>
<p class="centered-image"><img src="assets/lesson12/importCSV.jpg" width="575" height="528" contain /></p>
</div>
</div>
<div id="визуализация-1" class="section level2">
<h2>Визуализация</h2>
<div id="r-1" class="section level3 unlisted unnumbered">
<h3 class="unlisted unnumbered">R</h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="fu">session_grid</span>(<span class="cn">NULL</span>)</span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a>trkpt <span class="ot">&lt;-</span> ursa<span class="sc">:::</span><span class="fu">spatialize</span>(<span class="st">&quot;./input/track-general.geojson&quot;</span>,<span class="at">style=</span><span class="st">&quot;laea&quot;</span>,<span class="at">lon0=</span><span class="dv">60</span>)</span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a><span class="fu">session_grid</span>(<span class="at">expand=</span><span class="fl">1.1</span>)</span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a>loc <span class="ot">&lt;-</span> ursa<span class="sc">:::</span><span class="fu">spatialize</span>(<span class="st">&quot;./input/marmam.geojson&quot;</span>)</span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a><span class="fu">compose_open</span>()</span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a><span class="fu">panel_new</span>(<span class="st">&quot;white&quot;</span>)</span>
<span id="cb47-7"><a href="#cb47-7" tabindex="-1"></a><span class="fu">panel_plot</span>(<span class="fu">trackline</span>(trkpt),<span class="at">lwd=</span><span class="dv">3</span>,<span class="at">col=</span><span class="st">&quot;grey30&quot;</span>,<span class="at">alpha=</span><span class="fl">0.3</span>)</span>
<span id="cb47-8"><a href="#cb47-8" tabindex="-1"></a><span class="fu">panel_decor</span>(<span class="at">coast.fill=</span><span class="st">&quot;#00000010&quot;</span>,<span class="at">margin=</span><span class="fu">c</span>(F,T,T,F),<span class="at">lang=</span><span class="st">&quot;ru&quot;</span>)</span>
<span id="cb47-9"><a href="#cb47-9" tabindex="-1"></a>ursa<span class="sc">:::</span><span class="fu">panel_cluster</span>(loc[<span class="st">&quot;Вид&quot;</span>],<span class="at">legend=</span><span class="st">&quot;topleft&quot;</span>,<span class="at">bg=</span><span class="st">&quot;#FFFFFFAF&quot;</span>)</span>
<span id="cb47-10"><a href="#cb47-10" tabindex="-1"></a><span class="fu">panel_annotation</span>(<span class="at">lon=</span><span class="dv">40</span>,<span class="at">lat=</span><span class="dv">72</span>,<span class="at">label=</span><span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">&quot;БАРЕНЦЕВО МОРЕ&quot;</span>))</span>
<span id="cb47-11"><a href="#cb47-11" tabindex="-1"></a>                ,<span class="at">fg=</span><span class="st">&quot;white&quot;</span>,<span class="at">bg=</span><span class="st">&quot;grey70&quot;</span>,<span class="at">cex=</span><span class="fl">1.1</span>)</span>
<span id="cb47-12"><a href="#cb47-12" tabindex="-1"></a><span class="fu">panel_annotation</span>(<span class="at">lon=</span><span class="dv">80</span>,<span class="at">lat=</span><span class="dv">78</span>,<span class="at">label=</span><span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">&quot;КАРСКОЕ МОРЕ&quot;</span>))</span>
<span id="cb47-13"><a href="#cb47-13" tabindex="-1"></a>                ,<span class="at">fg=</span><span class="st">&quot;white&quot;</span>,<span class="at">bg=</span><span class="st">&quot;grey70&quot;</span>,<span class="at">cex=</span><span class="fl">1.1</span>)</span>
<span id="cb47-14"><a href="#cb47-14" tabindex="-1"></a><span class="fu">compose_close</span>()</span></code></pre></div>
<p class="centered-image"><img src="assets/lesson12/findings.png" width="332" height="670" contain /></p>
</div>
<div id="qgis-1" class="section level3 unlisted unnumbered">
<h3 class="unlisted unnumbered">QGIS</h3>
<p class="centered-image"><img src="assets/lesson12/findings-QGIS.jpg" width="1007" height="670" contain /></p>
<div class="youturn">
<h1 class="toc-ignore unnumbered unlisted">
You turn
</h1>
<ul>
<li><p>Загрузить находки</p></li>
<li><p>Настроить стили для отображения</p></li>
</ul>
</div>
</div>
</div>
</div>
<div id="окружающая-среда" class="section level1">
<h1>Окружающая среда</h1>
<p>Как правило, это растры: батиметрия, морской лёд.</p>
<div id="визуализация-2" class="section level2">
<h2>Визуализация</h2>
<div id="r-2" class="section level3 unlisted unnumbered">
<h3 class="unlisted unnumbered">R</h3>
<p>Обычно используется пакет <strong><code>terra</code></strong>.</p>
<p>Ниже пример с использованием пакета <strong><code>ursa</code></strong>.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">ursa_read</span>(<span class="st">&quot;input/gebco_2024_n82.0_s64.0_w30.0_e90.0.tif&quot;</span>)</span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">colorize</span>(a,<span class="at">breakvalue=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">500</span>,<span class="sc">-</span><span class="dv">200</span>,<span class="sc">-</span><span class="dv">50</span>,<span class="sc">-</span><span class="dv">20</span>),<span class="at">pal=</span><span class="st">&quot;Blues&quot;</span>,<span class="at">inv=</span><span class="cn">TRUE</span>)</span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a><span class="fu">display</span>(p,<span class="at">coast.fill=</span><span class="st">&quot;beige&quot;</span>,<span class="at">pointsize=</span><span class="dv">16</span>,<span class="at">lang=</span><span class="st">&quot;ru&quot;</span>,<span class="at">units=</span><span class="st">&quot;Метры&quot;</span>)</span></code></pre></div>
<p class="centered-image"><img src="assets/lesson12/ursa09_unnamed-chunk-52.png" width="702" aspect /></p>
</div>
<div id="qgis-2" class="section level3 unlisted unnumbered">
<h3 class="unlisted unnumbered">QGIS</h3>
<p class="centered-image"><img src="assets/lesson12/RasterAddLayer.jpg" width="1008" height="670" contain /></p>
<p class="centered-image"><img src="assets/lesson12/RasterColorization.jpg" width="864" height="670" contain /></p>
<p class="centered-image"><img src="assets/lesson12/RasterOutput.jpg" width="1002" height="670" contain /></p>
<div class="youturn">
<h1 class="toc-ignore unnumbered unlisted">
You turn
</h1>
<ul>
<li>Загрузить файл с батиметрией и раскрасить лишь грубины</li>
</ul>
</div>
</div>
</div>
</div>
<div id="анализ" class="section level1">
<h1>Анализ</h1>
<h2 class="toc-ignore unnumbered unlisted">
Изучаемая территория
</h2>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">session_grid</span>(<span class="cn">NULL</span>)</span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> ursa<span class="sc">:::</span><span class="fu">spatialize</span>(<span class="st">&quot;./input/track-general.geojson&quot;</span>,<span class="at">style=</span><span class="st">&quot;stere&quot;</span>,<span class="at">lon0=</span><span class="dv">60</span>)</span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">regrid</span>(<span class="fu">spatial_grid</span>(a),<span class="at">res=</span><span class="dv">2000</span>,<span class="at">border=</span><span class="dv">100</span>)</span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a><span class="fu">print</span>(g1)</span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a><span class="fu">session_grid</span>(g1)</span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a>ref <span class="ot">&lt;-</span> <span class="fu">ursa</span>(<span class="dv">0</span><span class="dt">L</span>)</span>
<span id="cb49-7"><a href="#cb49-7" tabindex="-1"></a><span class="fu">ursa_write</span>(ref,<span class="st">&quot;./output/studyarea.tif&quot;</span>)</span>
<span id="cb49-8"><a href="#cb49-8" tabindex="-1"></a><span class="fu">display</span>(ref,<span class="at">legend=</span><span class="cn">NULL</span>)</span></code></pre></div>
<div class="pulling">
<div class="pull-left-60">
<pre><code>List of 9
 $ columns: int 1096
 $ rows   : int 1021
 $ resx   : num 2000
 $ resy   : num 2000
 $ minx   : num -1222000
 $ maxx   : num 970000
 $ miny   : num -2860000
 $ maxy   : num -818000
 $ crs    : chr &quot;stere lon_0=60 lat_0=90 lat_ts=72 &#39;WGS 84&#39;&quot;
 - attr(*, &quot;class&quot;)= chr &quot;.ursaGrid&quot;</code></pre>
</div>
<div class="pull-right-40">
<p class="centered-image"><img src="assets/lesson12/ursa10_unnamed-chunk-58.png" width="90" aspect /></p>
</div>
</div>
<div id="dist2coast" class="section level2">
<h2>Расстояние до берега</h2>
<p>Используем сухопутные полигоны из <a href="#osmdata">OSM данных</a>.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a>src <span class="ot">&lt;-</span> <span class="st">&quot;https://osmdata.openstreetmap.de/download/simplified-land-polygons-complete-3857.zip&quot;</span></span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a>osmdata <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;./output&quot;</span>,<span class="fu">basename</span>(src))</span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(osmdata))</span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a>   <span class="fu">download.file</span>(src,osmdata,<span class="at">mode=</span><span class="st">&quot;wb&quot;</span>)</span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a>list1 <span class="ot">&lt;-</span> <span class="fu">unzip</span>(osmdata,<span class="at">exdir=</span><span class="fu">tempdir</span>(),<span class="at">junkpaths=</span><span class="cn">TRUE</span>)</span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a><span class="fu">session_grid</span>(<span class="cn">NULL</span>)</span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a>land <span class="ot">&lt;-</span> <span class="fu">spatial_read</span>(list1[<span class="fu">grep</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">.shp$&quot;</span>,<span class="fu">basename</span>(list1))])</span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a><span class="fu">file.remove</span>(list1) <span class="sc">|&gt;</span> <span class="fu">invisible</span>()</span>
<span id="cb51-9"><a href="#cb51-9" tabindex="-1"></a>cntr <span class="ot">&lt;-</span> <span class="fu">spatial_centroid</span>(land) <span class="sc">|&gt;</span> <span class="fu">spatial_coordinates</span>()</span>
<span id="cb51-10"><a href="#cb51-10" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">which.min</span>(cntr[,<span class="dv">2</span>])</span>
<span id="cb51-11"><a href="#cb51-11" tabindex="-1"></a>land <span class="ot">&lt;-</span> land[<span class="sc">-</span>ind,]</span></code></pre></div>
<div id="по-всему-региону" class="section level3">
<h3>по всему региону</h3>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a>ref <span class="ot">&lt;-</span> <span class="fu">ursa_read</span>(<span class="st">&quot;./output/studyarea.tif&quot;</span>)</span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a>ref <span class="ot">&lt;-</span> <span class="fu">regrid</span>(ref,<span class="at">mul=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>)</span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a>extended <span class="ot">&lt;-</span> <span class="fu">spatial_buffer</span>(ursa<span class="sc">:::</span><span class="fu">spatialize</span>(<span class="fu">ursa_bbox</span>(ref)),<span class="dv">500</span><span class="sc">*</span><span class="fl">1e3</span>)</span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a>coast <span class="ot">&lt;-</span> <span class="fu">spatial_intersection</span>(<span class="fu">spatial_geometry</span>(land),extended)</span>
<span id="cb52-5"><a href="#cb52-5" tabindex="-1"></a>coast <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_simplify</span>(coast,<span class="fu">ursa</span>(ref,<span class="st">&quot;cellsize&quot;</span>),<span class="at">preserveTopology=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb52-6"><a href="#cb52-6" tabindex="-1"></a>         sf<span class="sc">::</span><span class="fu">st_cast</span>(<span class="st">&quot;MULTIPOLYGON&quot;</span>)</span>
<span id="cb52-7"><a href="#cb52-7" tabindex="-1"></a><span class="co"># здесь `sf::st_simplify` использована для упрощения, на практике используйте `sf::st_segmentize`</span></span>
<span id="cb52-8"><a href="#cb52-8" tabindex="-1"></a><span class="fu">session_grid</span>(ref)</span>
<span id="cb52-9"><a href="#cb52-9" tabindex="-1"></a>dist2coast <span class="ot">&lt;-</span> ursa<span class="sc">:::</span><span class="fu">.dist2</span>(ref,coast)[<span class="st">&quot;dist&quot;</span>]<span class="sc">*</span><span class="fl">1e-3</span></span>
<span id="cb52-10"><a href="#cb52-10" tabindex="-1"></a><span class="fu">ursa_write</span>(dist2coast,<span class="st">&quot;./output/dist2coast.tif&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="fu">display</span>(dist2coast,<span class="at">blank=</span><span class="st">&quot;white&quot;</span>,<span class="at">pointsize=</span><span class="dv">12</span>,<span class="at">coast.fill=</span><span class="st">&quot;#00000010&quot;</span>)</span></code></pre></div>
<p class="centered-image"><img src="assets/lesson12/ursa11_unnamed-chunk-64.png" width="480" height="620" contain /></p>
</div>
<div id="для-находок" class="section level3">
<h3>для находок</h3>
<div class="font100">
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a>loc <span class="ot">&lt;-</span> ursa<span class="sc">:::</span><span class="fu">spatialize</span>(<span class="st">&quot;./input/marmam.geojson&quot;</span>,<span class="at">resetGrid=</span><span class="cn">TRUE</span>)[<span class="fu">c</span>(<span class="st">&quot;time&quot;</span>,<span class="st">&quot;Вид&quot;</span>)]</span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">spatial_buffer</span>(ursa<span class="sc">:::</span><span class="fu">spatialize</span>(<span class="fu">spatial_bbox</span>(loc)),<span class="dv">100</span><span class="sc">*</span><span class="fl">1e3</span>)</span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a>b <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_segmentize</span>(b,<span class="dv">100</span>)</span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a>coast <span class="ot">&lt;-</span> <span class="fu">spatial_intersection</span>(b,<span class="fu">spatial_geometry</span>(land))</span>
<span id="cb54-5"><a href="#cb54-5" tabindex="-1"></a>coast <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_segmentize</span>(coast,<span class="dv">100</span>)</span>
<span id="cb54-6"><a href="#cb54-6" tabindex="-1"></a>coast <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_cast</span>(coast,<span class="st">&quot;POINT&quot;</span>)</span>
<span id="cb54-7"><a href="#cb54-7" tabindex="-1"></a>dist2coast <span class="ot">&lt;-</span> ursa<span class="sc">:::</span><span class="fu">.dist2</span>(loc,coast)</span>
<span id="cb54-8"><a href="#cb54-8" tabindex="-1"></a>cl <span class="ot">&lt;-</span> coast[dist2coast<span class="sc">$</span>ind,]</span>
<span id="cb54-9"><a href="#cb54-9" tabindex="-1"></a>loc<span class="sc">$</span>coast <span class="ot">&lt;-</span> dist2coast<span class="sc">$</span>dist</span>
<span id="cb54-10"><a href="#cb54-10" tabindex="-1"></a>seg <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">spatial_coordinates</span>(loc),<span class="fu">spatial_coordinates</span>(cl))</span>
<span id="cb54-11"><a href="#cb54-11" tabindex="-1"></a>seg <span class="ot">&lt;-</span> <span class="fu">apply</span>(seg,<span class="dv">1</span>,\(x) sf<span class="sc">::</span><span class="fu">st_linestring</span>(<span class="fu">matrix</span>(x,<span class="at">ncol=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>)),<span class="at">simplify=</span><span class="cn">FALSE</span>)</span>
<span id="cb54-12"><a href="#cb54-12" tabindex="-1"></a>seg <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_sfc</span>(seg,<span class="at">crs=</span>sf<span class="sc">::</span><span class="fu">st_crs</span>(loc))</span>
<span id="cb54-13"><a href="#cb54-13" tabindex="-1"></a><span class="fu">spatial_data</span>(seg) <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">dist=</span><span class="fu">round</span>(loc<span class="sc">$</span>coast<span class="sc">*</span><span class="fl">1e-3</span>,<span class="dv">1</span>))</span></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="fu">spatial_data</span>(loc)[<span class="fu">sort</span>(<span class="fu">sample</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(loc)),<span class="dv">7</span>)),]</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">time</th>
<th align="left">Вид</th>
<th align="right">coast</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">7</td>
<td align="left">2023-07-06 21:28:46</td>
<td align="left">Белуха</td>
<td align="right">21808.0368</td>
</tr>
<tr class="even">
<td align="left">180</td>
<td align="left">2023-07-18 05:01:37</td>
<td align="left">Белуха</td>
<td align="right">26357.4197</td>
</tr>
<tr class="odd">
<td align="left">248</td>
<td align="left">2023-07-23 00:57:13</td>
<td align="left">Морж</td>
<td align="right">242.7687</td>
</tr>
<tr class="even">
<td align="left">254</td>
<td align="left">2023-07-23 06:22:25</td>
<td align="left">Тюлень sp</td>
<td align="right">6503.7809</td>
</tr>
<tr class="odd">
<td align="left">255</td>
<td align="left">2023-07-23 06:22:25</td>
<td align="left">Тюлень sp</td>
<td align="right">6503.7809</td>
</tr>
<tr class="even">
<td align="left">265</td>
<td align="left">2023-07-23 07:10:16</td>
<td align="left">Тюлень sp</td>
<td align="right">4343.4725</td>
</tr>
<tr class="odd">
<td align="left">269</td>
<td align="left">2023-07-23 07:17:32</td>
<td align="left">Тюлень sp</td>
<td align="right">5211.2924</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> mapview<span class="sc">::</span><span class="fu">mapview</span>(<span class="fu">spatial_geometry</span>(loc),<span class="at">cex=</span><span class="dv">3</span>,<span class="at">col.regions=</span><span class="st">&quot;red&quot;</span>,<span class="at">layer.name=</span><span class="st">&quot;finding&quot;</span>)<span class="sc">+</span></span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a>     mapview<span class="sc">::</span><span class="fu">mapview</span>(<span class="fu">spatial_geometry</span>(cl),<span class="at">cex=</span><span class="dv">2</span>,<span class="at">col.regions=</span><span class="st">&quot;blue&quot;</span>,<span class="at">layer.name=</span><span class="st">&quot;coast&quot;</span>)<span class="sc">+</span></span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a>     mapview<span class="sc">::</span><span class="fu">mapview</span>(seg,<span class="at">popup=</span><span class="st">&quot;dist&quot;</span>,<span class="at">layer.name=</span><span class="st">&quot;segment&quot;</span>)</span></code></pre></div>
</div>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a>m</span></code></pre></div>
<div class="framed">
<iframe src="assets/lesson12/widget_dist2coast.html" width="646.08" height="400px" data-external="1" class="ursa-widgetize">
</iframe>
</div>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="fu">require</span>(tmap)</span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;view&quot;</span>)</span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(loc)<span class="sc">+</span><span class="fu">tm_dots</span>(<span class="st">&quot;coast&quot;</span>,<span class="at">alpha=</span><span class="fl">0.5</span>,<span class="at">group=</span><span class="st">&quot;Находка&quot;</span>)<span class="sc">+</span></span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a>     <span class="fu">tm_shape</span>(cl)<span class="sc">+</span><span class="fu">tm_dots</span>(<span class="at">alpha=</span><span class="fl">0.2</span>,<span class="at">group=</span><span class="st">&quot;До берега&quot;</span>)<span class="sc">+</span></span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a>     <span class="fu">tm_shape</span>(seg)<span class="sc">+</span><span class="fu">tm_lines</span>(<span class="st">&quot;dist&quot;</span>,<span class="at">alpha=</span><span class="fl">0.5</span>,<span class="at">group=</span><span class="st">&quot;Между ними&quot;</span>)</span></code></pre></div>
<div class="framed">
<iframe src="assets/lesson12/widget_tmap-view.html" width="646.08" height="400px" data-external="1" class="ursa-widgetize">
</iframe>
</div>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a><span class="fu">data</span>(World)</span>
<span id="cb59-3"><a href="#cb59-3" tabindex="-1"></a>m<span class="sc">+</span><span class="fu">tm_scale_bar</span>()<span class="sc">+</span><span class="fu">tm_graticules</span>(<span class="at">alpha=</span><span class="fl">0.2</span>)<span class="sc">+</span><span class="fu">tm_shape</span>(World)<span class="sc">+</span><span class="fu">tm_borders</span>()<span class="sc">+</span></span>
<span id="cb59-4"><a href="#cb59-4" tabindex="-1"></a>   <span class="fu">tm_shape</span>(terra<span class="sc">::</span><span class="fu">rast</span>(<span class="st">&quot;./output/dist2coast.tif&quot;</span>))<span class="sc">+</span><span class="fu">tm_raster</span>(<span class="at">alpha=</span><span class="fl">0.3</span>)</span></code></pre></div>
<p class="centered-image"><img src="assets/lesson12/tmap-plot-1.svg" width="646.08" height="535" /></p>
</div>
</div>
</div>



<!-- code folding -->



</body>
</html>
